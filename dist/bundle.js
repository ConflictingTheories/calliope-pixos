/*! For license information please see bundle.js.LICENSE.txt */
(()=>{var t={5061:(t,e,n)=>{"use strict";n.r(e),n.d(e,{default:()=>r});const r={init:function(t,e,n){console.log("loading - animate"),this.length=t,this.untilFrame=e,this.finish=n},tick:function(t){if(this.loaded){this.facing&&this.facing!=this.sprite.facing&&this.sprite.setFacing(this.facing);var e=this.startTime+this.length,n=(t-this.startTime)/this.length;t>=e&&(n=1,this.finish&&this.finish(!0));var r=Math.floor(n*this.untilFrame);return r!=this.sprite.animFrame&&this.sprite.setFrame(r),t>=e}}}},1183:(t,e,n)=>{"use strict";n.r(e),n.d(e,{default:()=>l});var r=n(8348),o=n(4180);function i(t,e,n){return i=s()?Reflect.construct:function(t,e,n){var r=[null];r.push.apply(r,e);var o=new(Function.bind.apply(t,r));return n&&c(o,n.prototype),o},i.apply(null,arguments)}function s(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}function c(t,e){return c=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},c(t,e)}function a(t){return function(t){if(Array.isArray(t))return u(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(t){if("string"==typeof t)return u(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?u(t,e):void 0}}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function u(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function f(t,e,n,r,o,i,s){try{var c=t[i](s),a=c.value}catch(t){return void n(t)}c.done?e(a):Promise.resolve(a).then(r,o)}const l={init:(p=regeneratorRuntime.mark((function t(e,n,s,c,u){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return console.log("loading - change zone"),t.next=3,this.sprite.zone.world.loadZone(e);case 3:return this.fromZone=t.sent,t.next=6,this.sprite.zone.world.loadZone(s);case 6:this.toZone=t.sent,this.from=i(r.OW,a(n)),this.to=i(r.OW,a(c)),this.facing=o.N.fromOffset([Math.round(c.x-n.x),Math.round(c.y-n.y)]),this.length=u;case 11:case"end":return t.stop()}}),t,this)})),h=function(){var t=this,e=arguments;return new Promise((function(n,r){var o=p.apply(t,e);function i(t){f(o,n,r,i,s,"next",t)}function s(t){f(o,n,r,i,s,"throw",t)}i(void 0)}))},function(t,e,n,r,o){return h.apply(this,arguments)}),tick:function(t){if(this.toZone.loaded&&this.fromZone.loaded){this.facing&&this.facing!=this.sprite.facing&&(this.sprite.facing=this.facing,this.sprite.setFrame(0));var e=this.startTime+this.length,n=(t-this.startTime)/this.length;t>=e?((0,r.t8)(this.to,this.sprite.pos),n=1):(0,r.t7)(this.from,this.to,n,this.sprite.pos);var o=Math.floor(4*n);o!=this.sprite.animFrame&&this.sprite.setFrame(o),this.sprite.zone.isInZone(this.sprite.pos.x,this.sprite.pos.y)||(this.fromZone.removeSprite(this.sprite.id),this.sprite.zone.world.runAfterTick(function(){this.toZone.addSprite(this.sprite),console.log("sprite '"+this.sprite.id+"' changed zone from '"+this.fromZone.id+"' to '"+this.toZone.id+"'")}.bind(this)));var i=this.sprite.pos.x+this.sprite.hotspotOffset.x,s=this.sprite.pos.y+this.sprite.hotspotOffset.y;return this.switchRenderZone||this.fromZone.isInZone(i,s)||(this.switchRenderZone=!0),this.sprite.pos.z=(this.switchRenderZone?this.toZone:this.fromZone).getHeight(i,s),t>=e}}};var p,h},5317:(t,e,n)=>{"use strict";n.r(e),n.d(e,{default:()=>r});const r={init:function(t){var e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};console.log("loading - chat"),this.engine=this.sprite.engine,this.text="",this.prompt=t,this.scrolling=e,this.line=0,this.options=n,this.completed=!1,this.lastKey=(new Date).getTime()},tick:function(t){var e;if(this.loaded)return this.options&&this.options.autoclose&&(this.endTime=this.endTime?this.endTime:null!==(e=this.options.endTime)&&void 0!==e?e:(new Date).getTime()+1e4,t>this.endTime&&(this.completed=!0)),this.checkInput(t),this.textbox=this.engine.scrollText(this.prompt+this.text,this.scrolling,this.options),this.completed},checkInput:function(t){if(t>this.lastKey+100){var e=!1;switch(this.engine.keyboard.lastPressedCode()){case"Escape":this.completed=!0,e=!0;break;case"Backspace":var n=this.text.split("");n.pop(),this.text=n.join(""),this.lastKey=t,e=!0;break;case"Enter":this.engine.setGreeting(this.text),this.sprite.speech.clearHud(),this.speechbox=this.sprite.speech.scrollText(this.text),this.sprite.speech.loadImage(),this.completed=!0,e=!0}if(!e){var r=this.engine.keyboard.lastPressedKey();r&&(this.lastKey=t,this.text+=""+r)}}}}},2282:(t,e,n)=>{"use strict";n.r(e),n.d(e,{default:()=>r});const r={init:function(t){var e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};console.log("loading - dialogue"),this.engine=this.sprite.engine,this.text=t,this.displayText="string"==typeof t?t:this.text.shift(),this.scrolling=e,this.options=n,this.completed=!1,this.lastText=!1,this.lastKey=(new Date).getTime(),this.loaded=!0},tick:function(t){var e;if(this.loaded)return this.options&&this.options.autoclose&&(this.endTime=this.endTime?this.endTime:null!==(e=this.options.endTime)&&void 0!==e?e:(new Date).getTime()+1e4,t>this.endTime&&(this.completed=!0)),this.checkInput(t),this.sprite.speak(this.displayText),this.completed&&this.options.onClose&&(this.sprite.speech.clearHud(),this.options.onClose()),this.completed},checkInput:function(t){if(t>this.lastKey+100)switch(this.engine.keyboard.lastPressedCode()){case"Escape":console.log("closing dialogue"),this.sprite.speak(!1),this.completed=!0;break;case"Enter":"string"==typeof this.text||0===this.text.length?this.completed=!0:(this.completed=!1,this.displayText=this.text.shift(),this.sprite.speak(this.displayText))}}}},2813:(t,e,n)=>{"use strict";n.r(e),n.d(e,{default:()=>r});const r={init:function(t){console.log("loading - face"),this.facing=t},tick:function(t){return this.facing&&this.facing!=this.sprite.facing&&this.sprite.setFacing(this.facing),!0}}},1162:(t,e,n)=>{"use strict";n.r(e),n.d(e,{default:()=>r});const r={init:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};console.log("loading - greeting"),this.engine=this.sprite.engine,this.greeting=t,this.options=e,this.completed=!1},tick:function(t){if(this.loaded)return this.engine.setGreeting(this.text),!0}}},5544:(t,e,n)=>{"use strict";n.r(e),n.d(e,{default:()=>f});var r=n(8348),o=n(4180);function i(t,e,n){return i=s()?Reflect.construct:function(t,e,n){var r=[null];r.push.apply(r,e);var o=new(Function.bind.apply(t,r));return n&&c(o,n.prototype),o},i.apply(null,arguments)}function s(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}function c(t,e){return c=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},c(t,e)}function a(t){return function(t){if(Array.isArray(t))return u(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(t){if("string"==typeof t)return u(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?u(t,e):void 0}}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function u(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}const f={init:function(t,e,n){var s=this;console.log("loading - interact",arguments),this.world=n,this.from=i(r.OW,a(t)),this.facing=e,this.offset=o.N.toOffset(e),this.lastKey=(new Date).getTime(),this.completed=!1,this.to=[t[0]+this.offset[0],t[1]+this.offset[1]],this.zone=n.zoneContaining.apply(n,a(this.to)),this.spriteList=this.zone.spriteList.filter((function(t){return t.pos.x===s.to[0]&&t.pos.y===s.to[1]})),this.finish=this.finish.bind(this),this.interact()},interact:function(){var t=this;0===this.spriteList.length&&(this.completed=!0),this.spriteList.forEach((function(e){var n=e.faceDir(o.N.reverse(t.facing));return n&&e.addAction(n),e.interact?t.zone.spriteDict[e.id].interact(t.sprite,t.finish):null}))},finish:function(t){t&&(this.completed=!0)},tick:function(t){if(this.loaded)return this.checkInput(t),this.completed},checkInput:function(t){if(t>this.lastKey+this.length)return"q"===this.sprite.engine.keyboard.lastPressed("q")&&(console.log("stopping interaction"),this.completed=!0),this.lastKey=(new Date).getTime(),null}}},2897:(t,e,n)=>{"use strict";n.r(e),n.d(e,{default:()=>f});var r=n(8348),o=n(4180);function i(t,e,n){return i=s()?Reflect.construct:function(t,e,n){var r=[null];r.push.apply(r,e);var o=new(Function.bind.apply(t,r));return n&&c(o,n.prototype),o},i.apply(null,arguments)}function s(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}function c(t,e){return c=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},c(t,e)}function a(t){return function(t){if(Array.isArray(t))return u(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(t){if("string"==typeof t)return u(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?u(t,e):void 0}}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function u(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}const f={init:function(t,e,n,s){var c=this;console.log("loading - move"),this.zone=s,this.from=i(r.OW,a(t)),this.to=i(r.OW,a(e)),this.facing=o.N.fromOffset([Math.round(e.x-t.x),Math.round(e.y-t.y)]),this.length=n,console.log(this.zone),this.spriteList=this.zone.spriteList.filter((function(t){return t.pos.x===c.to.x&&t.pos.y===c.to.y}))},tick:function(t){if(this.loaded){this.facing&&this.facing!=this.sprite.facing&&this.sprite.setFacing(this.facing);var e=this.startTime+this.length,n=(t-this.startTime)/this.length;t>=e?((0,r.t8)(this.to,this.sprite.pos),n=1,this.onStep()):(0,r.t7)(this.from,this.to,n,this.sprite.pos);var o=Math.floor(4*n);o!=this.sprite.animFrame&&this.sprite.setFrame(o);var i=this.sprite.pos.x+this.sprite.hotspotOffset.x,s=this.sprite.pos.y+this.sprite.hotspotOffset.y;return this.sprite.pos.z=this.sprite.zone.getHeight(i,s),t>=e}},onStep:function(){var t=this;console.log("on steppping",this.spriteList),0===this.spriteList.length&&(this.completed=!0),this.spriteList.forEach((function(e){return console.log(e),e.onStep?t.zone.spriteDict[e.id].onStep(t.sprite):null}))}}},2704:(t,e,n)=>{"use strict";n.r(e),n.d(e,{default:()=>h});var r=n(8348),o=n(9337),i=n(4180);function s(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var r,o,i=[],s=!0,c=!1;try{for(n=n.call(t);!(s=(r=n.next()).done)&&(i.push(r.value),!e||i.length!==e);s=!0);}catch(t){c=!0,o=t}finally{try{s||null==n.return||n.return()}finally{if(c)throw o}}return i}}(t,e)||l(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function c(t,e,n){return c=a()?Reflect.construct:function(t,e,n){var r=[null];r.push.apply(r,e);var o=new(Function.bind.apply(t,r));return n&&u(o,n.prototype),o},c.apply(null,arguments)}function a(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}function u(t,e){return u=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},u(t,e)}function f(t){return function(t){if(Array.isArray(t))return p(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||l(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function l(t,e){if(t){if("string"==typeof t)return p(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?p(t,e):void 0}}function p(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}const h={init:function(t,e,n,i){console.log("loading - patrol",arguments),this.zone=i,this.from=c(r.OW,f(t)),this.to=c(r.OW,f(e)),this.lastKey=(new Date).getTime(),this.completed=!1,this.direction=1,this.audio=new o.mT("/pixos/audio/seed.mp3");var a=this.sprite.zone.world.pathFind(t,e),u=s(a,2);this.hasMoves=u[0],this.moveList=u[1],this.hasMoves||(this.completed=!0),this.moveIndex=1,this.moveLength=n,this.zone.audio&&this.zone.audio.pauseAudio(),this.audio.playAudio()},tick:function(t){if(this.loaded){if(this.checkInput(t),t>this.startTime+this.moveLength){var e=this.moveList[this.moveIndex];if(this.moveList.length>2){var n=0==this.moveIndex?this.moveList[this.moveIndex+1]:this.moveIndex+1>=this.moveList.length?this.moveList[this.moveList.length-1]:this.moveList[this.moveIndex-1],r=i.N.fromOffset([Math.round(e[0]-n[0]),Math.round(e[1]-n[1])]);if(this.sprite.zone.isInZone(e[0],e[1]))this.currentAction=new o.aW(this.sprite.engine,"move",[n,e,this.moveLength,this.zone],this.sprite);else{var s=this.sprite.zone.world.zoneContaining(e[0],e[1]);s&&s.loaded&&s.isWalkable(e[0],e[1],i.N.reverse(r))?this.currentAction=new o.aW(this.sprite.engine,"changezone",[this.sprite.zone.id,this.sprite.pos.toArray(),s.id,e,this.moveLength],this.sprite):this.currentAction=this.sprite.faceDir(r)}this.currentAction&&(this.currentAction.facing=r,this.sprite.addAction(this.currentAction))}this.moveIndex+this.direction>=this.moveList.length&&(this.direction*=-1,this.completed=!0,this.zone.audio&&this.zone.audio.playAudio(),this.audio.pauseAudio()),this.moveIndex+=this.direction,this.startTime=t}return this.completed}},checkInput:function(t){if(t>this.lastKey+this.moveLength)return"q"===this.sprite.engine.keyboard.lastPressed("q")&&(console.log("stopping patrol"),this.audio.pauseAudio(),this.completed=!0),this.lastKey=(new Date).getTime(),null}}},5744:(t,e,n)=>{"use strict";function r(t,e,n,r,o,i,s){try{var c=t[i](s),a=c.value}catch(t){return void n(t)}c.done?e(a):Promise.resolve(a).then(r,o)}n.r(e),n.d(e,{default:()=>o});const o={init:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;console.log("loading - script",arguments),this.zone=e,this.world=e.world,this.lastKey=(new Date).getTime(),this.completed=!1,this.onCompleted=function(){return console.log("script finished")},n&&(this.onCompleted=n),this.triggerId=t,this.triggerScript()},triggerScript:function(){var t=this;this.triggerId||(this.completed=!0),Promise.all(this.zone.scripts.filter((function(e){return e.id===t.triggerId})).map(function(){var e,n=(e=regeneratorRuntime.mark((function e(n){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n.trigger.call(t.zone);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})),function(){var t=this,n=arguments;return new Promise((function(o,i){var s=e.apply(t,n);function c(t){r(s,o,i,c,a,"next",t)}function a(t){r(s,o,i,c,a,"throw",t)}c(void 0)}))});return function(t){return n.apply(this,arguments)}}())).then((function(){t.completed=!0}))},tick:function(t){if(this.loaded)return this.completed&&this.onCompleted(),this.completed}}},6180:(t,e,n)=>{"use strict";n.d(e,{Z:()=>y});var r=n(8348),o=n(4180),i=n(9337);function s(t){return s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},s(t)}function c(t,e,n){return c=p()?Reflect.construct:function(t,e,n){var r=[null];r.push.apply(r,e);var o=new(Function.bind.apply(t,r));return n&&u(o,n.prototype),o},c.apply(null,arguments)}function a(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function u(t,e){return u=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},u(t,e)}function f(t,e){if(e&&("object"===s(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return l(t)}function l(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function p(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}function h(t){return h=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},h(t)}var y=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");Object.defineProperty(t,"prototype",{value:Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),writable:!1}),e&&u(t,e)}(b,t);var e,n,s,y,d=(e=b,n=p(),function(){var t,r=h(e);if(n){var o=h(this).constructor;t=Reflect.construct(r,arguments,o)}else t=r.apply(this,arguments);return f(this,t)});function b(t){var e;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,b),(e=d.call(this,t)).handleWalk=e.handleWalk.bind(l(e)),e}return s=b,(y=[{key:"init",value:function(){console.log("- avatar hook",this.id,this.pos)}},{key:"tick",value:function(t){if(!this.actionList.length){var e=this.checkInput();e&&this.addAction(e)}this.bindCamera&&(0,r.t8)(this.pos,this.engine.cameraPosition)}},{key:"checkInput",value:function(){switch(this.engine.keyboard.lastPressedCode()){case"b":this.bindCamera=!0;break;case"c":this.bindCamera=!1;break;case"z":this.zone.world.removeZone("room"),this.zone.world.loadZone("dungeon-top"),this.zone.world.loadZone("dungeon-bottom");break;case"y":this.zone.world.removeZone("dungeon-top"),this.zone.world.removeZone("dungeon-bottom"),this.zone.world.loadZone("room");break;case"k":case"Enter":return new i.aW(this.engine,"interact",[this.pos.toArray(),this.facing,this.zone.world],this);case"h":return new i.aW(this.engine,"dialogue",["Welcome! You pressed help! Press Escape to close",!1,{autoclose:!0}],this);case"m":case" ":return new i.aW(this.engine,"chat",[">:",!0,{autoclose:!1}],this);case"q":case"Escape":this.speech.clearHud()}return this.handleWalk(this.engine.keyboard.lastPressedKey())}},{key:"handleWalk",value:function(t){var e,n=o.N.None;switch(t){case"w":n=o.N.Up;break;case"s":n=o.N.Down;break;case"a":n=o.N.Left;break;case"d":n=o.N.Right;break;case"p":return new i.aW(this.engine,"patrol",[this.pos.toArray(),new r.OW(8,13,this.pos.z).toArray(),600,this.zone],this);case"r":return new i.aW(this.engine,"patrol",[this.pos.toArray(),new r.OW(8,13,this.pos.z).toArray(),200,this.zone],this);default:return null}if(e=this.engine.keyboard.shift?200:600,this.facing!==n)return this.faceDir(n);var s=this.pos,a=o.N.toOffset(n),u=c(r.OW,[Math.round(s.x+a[0]),Math.round(s.y+a[1]),0]);if(!this.zone.isInZone(u.x,u.y)){var f=this.zone.world.zoneContaining(u.x,u.y);return f&&f.loaded&&f.isWalkable(u.x,u.y,o.N.reverse(n))?new i.aW(this.engine,"changezone",[this.zone.id,this.pos.toArray(),f.id,u.toArray(),e],this):this.faceDir(n)}return this.zone.isWalkable(u.x,u.y,o.N.reverse(n))?new i.aW(this.engine,"move",[this.pos.toArray(),u.toArray(),e,this.zone],this):this.faceDir(n)}}])&&a(s.prototype,y),Object.defineProperty(s,"prototype",{writable:!1}),b}(n(5870).Z)},7408:(t,e,n)=>{"use strict";function r(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}n.d(e,{Z:()=>o});var o=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.actions=[]}var e,n;return e=t,n=[{key:"add",value:function(t){this.actions.push(t)}},{key:"run",value:function(){var t=arguments;this.actions=this.actions.filter((function(e){return e(t)}))}}],n&&r(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),t}()},5870:(t,e,n)=>{"use strict";n.d(e,{Z:()=>p});var r=n(8348),o=n(4180),i=n(7408),s=n(9337),c=n(9175);function a(t,e,n){return a=u()?Reflect.construct:function(t,e,n){var r=[null];r.push.apply(r,e);var o=new(Function.bind.apply(t,r));return n&&f(o,n.prototype),o},a.apply(null,arguments)}function u(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}function f(t,e){return f=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},f(t,e)}function l(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var p=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.engine=e,this.templateLoaded=!1,this.drawOffset=new r.OW(0,0,0),this.hotspotOffset=new r.OW(0,0,0),this.animFrame=0,this.pos=new r.OW(0,0,0),this.facing=o.N.Right,this.actionDict={},this.actionList=[],this.speech={},this.portrait=null,this.onLoadActions=new i.Z,this.getTexCoords=this.getTexCoords.bind(this),this.inventory=[],this.onTilesetOrTextureLoaded=this.onTilesetOrTextureLoaded.bind(this),this.blocking=!0,this.override=!1}var e,n;return e=t,n=[{key:"update",value:function(t){Object.assign(this,t)}},{key:"runWhenLoaded",value:function(t){this.loaded?t():this.onLoadActions.add(t)}},{key:"onLoad",value:function(t){this.loaded||(this.src&&this.sheetSize&&this.tileSize&&this.frames?(console.log("zoning ----\x3e>"),this.zone=t.zone,t.id&&(this.id=t.id),t.pos&&(0,r.t8)(t.pos,this.pos),t.facing&&0!==t.facing&&(this.facing=t.facing),t.zones&&null!==t.zones&&(this.zones=t.zones),console.log("facing",o.N.spriteSequence(this.facing)),this.texture=this.engine.loadTexture(this.src),console.log("texture ----\x3e>"),this.texture.runWhenLoaded(this.onTilesetOrTextureLoaded.bind(this)),this.vertexTexBuf=this.engine.createBuffer(this.getTexCoords(),this.engine.gl.DYNAMIC_DRAW,2),this.enableSpeech&&(this.speech=this.engine.loadSpeech(this.id,this.engine.mipmap),console.log("speech ----\x3e>"),this.speech.runWhenLoaded(this.onTilesetOrTextureLoaded.bind(this)),this.speechTexBuf=this.engine.createBuffer(this.getSpeechBubbleTexture(),this.engine.gl.DYNAMIC_DRAW,2)),this.portraitSrc&&(this.portrait=this.engine.loadTexture(this.portraitSrc),console.log("portrait ----\x3e>"),this.portrait.runWhenLoaded(this.onTilesetOrTextureLoaded.bind(this))),this.zone.tileset.runWhenDefinitionLoaded(this.onTilesetDefinitionLoaded.bind(this))):console.error("Invalid sprite definition"))}},{key:"onTilesetDefinitionLoaded",value:function(){var t=this.zone.tileset.tileSize,e=[this.tileSize[0]/t,this.tileSize[1]/t],n=[[0,0,0],[e[0],0,0],[e[0],0,e[1]],[0,0,e[1]]],r=[[n[2],n[3],n[0]],[n[2],n[0],n[1]]].flat(3);this.vertexPosBuf=this.engine.createBuffer(r,this.engine.gl.STATIC_DRAW,3),this.enableSpeech&&(this.speechVerBuf=this.engine.createBuffer(this.getSpeechBubbleVertices(),this.engine.gl.STATIC_DRAW,3)),this.zone.tileset.runWhenLoaded(this.onTilesetOrTextureLoaded.bind(this))}},{key:"onTilesetOrTextureLoaded",value:function(){!this||this.loaded||!this.zone.tileset.loaded||!this.texture.loaded||this.enableSpeech&&this.speech&&!this.speech.loaded||this.portrait&&!this.portrait.loaded||(this.init(),this.enableSpeech&&(this.speech.clearHud(),this.speech.writeText(this.id),this.speech.loadImage()),this.loaded=!0,this.onLoadActions.run(),console.log("Initialized sprite '"+this.id+"' in zone '"+this.zone.id+"'"))}},{key:"getTexCoords",value:function(){var t;"chest"==this.id&&console.log("texture frames",this.facing,o.N.spriteSequence(this.facing));var e=null!==(t=this.frames[o.N.spriteSequence(this.facing)])&&void 0!==t?t:this.frames.up,n=this.frames[o.N.spriteSequence(this.facing)].length,r=e[this.animFrame%n],i=this.sheetSize,s=this.tileSize,c=[(r[0]+s[0])/i[0],r[1]/i[1]],a=[r[0]/i[0],(r[1]+s[1])/i[1]],u=[c,[a[0],c[1]],a,[c[0],a[1]]];return[[u[0],u[1],u[2]],[u[0],u[2],u[3]]].flat(3)}},{key:"getSpeechBubbleTexture",value:function(){return[[1,1],[0,1],[0,0],[1,1],[0,0],[1,0]].flat(3)}},{key:"getSpeechBubbleVertices",value:function(){return[a(r.OW,[2,0,4]).toArray(),a(r.OW,[0,0,4]).toArray(),a(r.OW,[0,0,2]).toArray(),a(r.OW,[2,0,4]).toArray(),a(r.OW,[0,0,2]).toArray(),a(r.OW,[2,0,2]).toArray()].flat(3)}},{key:"draw",value:function(){this.loaded&&(this.engine.mvPushMatrix(),(0,c.Iu)(this.engine.uViewMat,this.engine.uViewMat,this.drawOffset.toArray()),(0,c.Iu)(this.engine.uViewMat,this.engine.uViewMat,this.pos.toArray()),(0,c.U1)(this.engine.uViewMat,this.engine.uViewMat,this.engine.degToRad(this.engine.cameraAngle),[1,0,0]),this.engine.bindBuffer(this.vertexPosBuf,this.engine.shaderProgram.vertexPositionAttribute),this.engine.bindBuffer(this.vertexTexBuf,this.engine.shaderProgram.textureCoordAttribute),this.texture.attach(),this.engine.shaderProgram.setMatrixUniforms(),this.engine.gl.depthFunc(this.engine.gl.ALWAYS),this.engine.gl.drawArrays(this.engine.gl.TRIANGLES,0,this.vertexPosBuf.numItems),this.engine.gl.depthFunc(this.engine.gl.LESS),this.engine.mvPopMatrix(),this.enableSpeech&&(this.engine.mvPushMatrix(),(0,c.Iu)(this.engine.uViewMat,this.engine.uViewMat,this.drawOffset.toArray()),(0,c.Iu)(this.engine.uViewMat,this.engine.uViewMat,this.pos.toArray()),(0,c.U1)(this.engine.uViewMat,this.engine.uViewMat,this.engine.degToRad(this.engine.cameraAngle),[1,0,0]),this.engine.bindBuffer(this.speechVerBuf,this.engine.shaderProgram.vertexPositionAttribute),this.engine.bindBuffer(this.speechTexBuf,this.engine.shaderProgram.textureCoordAttribute),this.speech.attach(),this.engine.shaderProgram.setMatrixUniforms(),this.engine.gl.depthFunc(this.engine.gl.ALWAYS),this.engine.gl.drawArrays(this.engine.gl.TRIANGLES,0,this.vertexPosBuf.numItems),this.engine.gl.depthFunc(this.engine.gl.LESS),this.engine.mvPopMatrix()))}},{key:"setFrame",value:function(t){this.animFrame=t,this.engine.updateBuffer(this.vertexTexBuf,this.getTexCoords())}},{key:"setFacing",value:function(t){console.log("setting face to "+o.N.spriteSequence(t)),t&&(this.facing=t),this.setFrame(this.animFrame)}},{key:"addAction",value:function(t){console.log("adding action to sprite",t.id),this.actionDict[t.id]&&this.removeAction(t.id),this.actionDict[t.id]=t,this.actionList.push(t)}},{key:"removeAction",value:function(t){console.log("removing action"),this.actionList=this.actionList.filter((function(e){return e.id!==t})),delete this.actionDict[t]}},{key:"removeAllActions",value:function(){this.actionList=[],this.actionDict={}}},{key:"tickOuter",value:function(t){var e=this;if(this.loaded){this.actionList.sort((function(t,e){var n=t.startTime-e.startTime;return n?t.id>e.id?1:-1:n}));var n=[];this.actionList.forEach((function(e){!e.loaded||e.startTime>t||e.tick(t)&&(n.push(e),e.onComplete())})),n.forEach((function(t){return e.removeAction(t.id)})),this.tick&&this.tick(t)}}},{key:"init",value:function(){console.log("- sprite hook",this.id,this.pos)}},{key:"speak",value:function(t){var e,n,r=arguments.length>1&&void 0!==arguments[1]&&arguments[1];t?(this.textbox=this.engine.scrollText(this.id+":> "+t,!0,{portrait:null!==(e=this.portrait)&&void 0!==e&&e}),r&&this.speech&&(this.speech.scrollText(t,!1,{portrait:null!==(n=this.portrait)&&void 0!==n&&n}),this.speech.loadImage())):this.speech.clearHud()}},{key:"interact",value:function(t,e){return this.state,e&&e(!0),null}},{key:"faceDir",value:function(t){return this.facing==t||t===o.N.None?null:new s.aW(this.engine,"face",[t],this)}},{key:"setGreeting",value:function(t){return this.speech.clearHud(),this.speech.writeText(t),this.speech.loadImage(),new s.aW(this.engine,"greeting",[t,{autoclose:!0}],this)}}],n&&l(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),t}()},7772:(t,e,n)=>{"use strict";n.d(e,{Z:()=>u});var r=n(9337);function o(t){return o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},o(t)}function i(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function s(t,e){return s=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},s(t,e)}function c(t,e){if(e&&("object"===o(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function a(t){return a=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},a(t)}var u=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");Object.defineProperty(t,"prototype",{value:Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),writable:!1}),e&&s(t,e)}(l,t);var e,n,o,u,f=(o=l,u=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,e=a(o);if(u){var n=a(this).constructor;t=Reflect.construct(e,arguments,n)}else t=e.apply(this,arguments);return c(this,t)});function l(t){var e;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,l),(e=f.call(this,t)).bindCamera=!1,e.enableSpeech=!0,e.state="intro",e}return e=l,(n=[{key:"interact",value:function(t,e){var n=null;switch(this.state){case"intro":this.state="loop",n=new r.aW(this.engine,"dialogue",["Buying stuff eh?!",!1,{autoclose:!0,onClose:function(){return e(!0)}}],this),void 0!==window.ethereum&&console.log("MetaMask is installed!");break;case"loop":this.state="loop2",n=new r.aW(this.engine,"dialogue",["I heard about a strange legend once.",!1,{autoclose:!0,onClose:function(){return e(!0)}}],this);break;case"loop2":this.state="loop",n=new r.aW(this.engine,"dialogue",["Sorry, I don't remember the story at the moment",!1,{autoclose:!0,onClose:function(){return e(!0)}}],this)}return console.log(n),n&&this.addAction(n),e&&e(!1),n}}])&&i(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),l}(n(5870).Z)},6595:(t,e,n)=>{"use strict";n.d(e,{Z:()=>l}),n(6185);var r=n(5870),o=n(9337);function i(t){return i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},i(t)}function s(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function c(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function a(t,e){return a=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},a(t,e)}function u(t,e){if(e&&("object"===i(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function f(t){return f=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},f(t)}var l=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");Object.defineProperty(t,"prototype",{value:Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),writable:!1}),e&&a(t,e)}(p,t);var e,n,r,i,l=(r=p,i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,e=f(r);if(i){var n=f(this).constructor;t=Reflect.construct(e,arguments,n)}else t=e.apply(this,arguments);return u(this,t)});function p(t){var e;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,p),(e=l.call(this,t)).bindCamera=!1,e.enableSpeech=!0,e.state="closed",e.inventory=[],e}return e=p,(n=[{key:"interact",value:function(t,e){var n=this,r=null;switch(this.startTime=Date.now(),this.state){case"closed":this.state="open",r=new o.aW(this.engine,"animate",[600,3,function(){var r,o;t.inventory&&(r=t.inventory).push.apply(r,function(t){if(Array.isArray(t))return s(t)}(o=n.inventory)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(o)||function(t,e){if(t){if("string"==typeof t)return s(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?s(t,e):void 0}}(o)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),e(!0)}],this);break;case"open":this.state="open",r=new o.aW(this.engine,"dialogue",["Empty.",!1,{autoclose:!0,onClose:function(){return e(!0)}}],this)}return r&&this.addAction(r),e&&e(!1),r}}])&&c(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),p}(r.Z)},4180:(t,e,n)=>{"use strict";n.d(e,{T:()=>r,N:()=>o});var r={DOWN:1,UP:2,MOVE:3},o={None:0,Right:1,Up:2,Left:4,Down:8,All:15,fromOffset:function(t){return t[0]>0?o.Right:t[0]<0?o.Left:t[1]>0?o.Down:t[1]<0?o.Up:0},toOffset:function(t){switch(t){case o.Right:return[1,0];case o.Up:return[0,-1];case o.Left:return[-1,0];case o.Down:return[0,1]}return[0,0]},reverse:function(t){switch(t){case o.Right:return o.Left;case o.Up:return o.Down;case o.Left:return o.Right;case o.Down:return o.Up}return o.None},rotate:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];switch(t){case o.Right:return e?o.Top:o.Down;case o.Up:return e?o.Left:o.Right;case o.Left:return e?o.Down:o.Top;case o.Down:return e?o.Right:o.Left}return o.None},spriteSequence:function(t){switch(t){case o.Right:return"right";case o.Up:return"up";case o.Left:return"left";case o.Down:return"down"}return"down"}}},9337:(t,e,n)=>{"use strict";n.d(e,{aW:()=>b,mT:()=>v,jf:()=>d,e5:()=>y});var r=n(6185),o=(n(5870),n(7408));function i(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var s=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.engine=e,this.src=null,this.sheetSize=[0,0],this.tileSize=0,this.tiles={},this.loaded=!1,this.onLoadActions=new o.Z,this.onDefinitionLoadActions=new o.Z,this.onTextureLoaded=this.onTextureLoaded.bind(this)}var e,n;return e=t,(n=[{key:"runWhenLoaded",value:function(t){this.loaded?t():this.onLoadActions.add(t)}},{key:"runWhenDefinitionLoaded",value:function(t){this.definitionLoaded?t():this.onDefinitionLoadActions.add(t)}},{key:"onJsonLoaded",value:function(t){var e=this;Object.keys(t).map((function(n){e[n]=t[n]})),this.definitionLoaded=!0,this.onDefinitionLoadActions.run(),this.texture=this.engine.loadTexture(this.src),this.texture.runWhenLoaded(this.onTextureLoaded),this.bgColor&&this.engine.gl.clearColor(this.bgColor[0]/255,this.bgColor[1]/255,this.bgColor[2]/255,1)}},{key:"onTextureLoaded",value:function(){console.log("Initialized tileset '"+this.name+"'"),this.loaded=!0,this.onLoadActions.run()}},{key:"getTileVertices",value:function(t,e){return this.geometry[t].vertices.map((function(t){return t.map((function(t){return[t[0]+e[0],t[1]+e[1],t[2]+e[2]]}))})).flat(3)}},{key:"getTileTexCoords",value:function(t,e){var n=this.textures[e],r=[this.tileSize/this.sheetSize[0],this.tileSize/this.sheetSize[1]];return this.geometry[t].surfaces.map((function(t){return t.map((function(t){return[(t[0]+n[0])*r[0],(t[1]+n[1])*r[1]]}))})).flat(3)}},{key:"getWalkability",value:function(t){return this.geometry[t].type}},{key:"getTileWalkPoly",value:function(t){return this.geometry[t].walkPoly}}])&&i(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),t}();function c(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var a=function(){function t(e,n,r){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.type=e,this.sprite=n,this.callback=r,this.time=(new Date).getTime(),this.id=n.id+"-"+e+"-"+this.time}var e,n;return e=t,(n=[{key:"configure",value:function(t,e,n,r,o){this.sprite=e,this.id=n,this.type=t,this.startTime=r,this.creationArgs=o}},{key:"onLoad",value:function(t){this.init.apply(this,t),this.loaded=!0}},{key:"serialize",value:function(){return{id:this.id,time:this.startTime,zone:this.sprite.zone.id,sprite:this.sprite.id,type:this.type,args:this.creationArgs}}},{key:"onComplete",value:function(){return this.callback?this.callback():null}}])&&c(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),t}();function u(t,e,n,r,o,i,s){try{var c=t[i](s),a=c.value}catch(t){return void n(t)}c.done?e(a):Promise.resolve(a).then(r,o)}function f(t){return function(){var e=this,n=arguments;return new Promise((function(r,o){var i=t.apply(e,n);function s(t){u(i,r,o,s,c,"next",t)}function c(t){u(i,r,o,s,c,"throw",t)}s(void 0)}))}}function l(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function p(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function h(t,e,n){return e&&p(t.prototype,e),n&&p(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}var y=function(){function t(e){l(this,t),this.engine=e,this.tilesets={}}var e,o;return h(t,[{key:"loadRemote",value:(o=f(regeneratorRuntime.mark((function t(e){var n,o,i;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!(n=this.tilesets[e])){t.next=3;break}return t.abrupt("return",n);case 3:return this.tilesets[e]=n=new s(this.engine),n.name=e,t.next=7,fetch(r.Z.tilesetRequestUrl(e));case 7:if(!(o=t.sent).ok){t.next=21;break}return t.prev=9,t.next=12,o.json();case 12:return i=t.sent,t.next=15,n.onJsonLoaded(i);case 15:t.next=21;break;case 17:t.prev=17,t.t0=t.catch(9),console.error("Error parsing tileset '"+n.name+"' definition"),console.error(t.t0);case 21:return t.abrupt("return",this.tilesets[e]);case 22:case"end":return t.stop()}}),t,this,[[9,17]])}))),function(t){return o.apply(this,arguments)})},{key:"load",value:(e=f(regeneratorRuntime.mark((function t(e){var r,o,i;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!(r=this.tilesets[e])){t.next=3;break}return t.abrupt("return",r);case 3:return o=new s(this.engine),this.tilesets[e]=o,i=n(7935)("./"+e+"/tileset.jsx").default,o.onJsonLoaded(i),t.abrupt("return",o);case 8:case"end":return t.stop()}}),t,this)}))),function(t){return e.apply(this,arguments)})}]),t}(),d=function(){function t(e){l(this,t),this.engine=e,this.definitions=[],this.instances={}}var e;return h(t,[{key:"load",value:(e=f(regeneratorRuntime.mark((function t(e){var r,o,i,s,c=arguments;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=c[1],o=c[2],this.instances[e]||(this.instances[e]=[]),i=n(7467)("./"+e+".jsx").default,console.log(i,e),(s=new i(this.engine)).templateLoaded=!0,this.instances[e].forEach((function(t){t.afterLoad&&t.afterLoad(t.instance)})),o&&o(s),r&&(console.log("after load"),s.templateLoaded?r(s):this.instances[e].push({instance:s,afterLoad:r})),t.abrupt("return",s);case 11:case"end":return t.stop()}}),t,this)}))),function(t){return e.apply(this,arguments)})}]),t}(),b=function(){function t(e,n,r,o,i){l(this,t),this.engine=e,this.type=n,this.args=r,this.sprite=o,this.callback=i,this.instances={},this.definitions=[];var s=(new Date).getTime(),c=o.id+"-"+n+"-"+s;return this.load(n,(function(t){t.onLoad(r)}),(function(t){t.configure(n,o,c,s,r)}))}return h(t,[{key:"load",value:function(t){var e=arguments[1],r=arguments[2];this.instances[t]||(this.instances[t]=[]);var o=new a(this.type,this.sprite,this.callback);return Object.assign(o,n(3333)("./"+t+".jsx").default),o.templateLoaded=!0,this.instances[t].forEach((function(t){t.afterLoad&&t.afterLoad(t.instance)})),r&&r(o),e&&(o.templateLoaded?e(o):this.instances[t].push({instance:o,afterLoad:e})),o}}]),t}(),v=function(){function t(e){var n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];l(this,t),this.src=e,this.audio=new Audio(e),n&&this.audio.addEventListener("ended",(function(){this.currentTime=0,this.play()}),!1),this.audio.load()}return h(t,[{key:"playAudio",value:function(){var t=this.audio.play();void 0!==t&&t.then((function(t){})).catch((function(t){console.info(t)}))}},{key:"pauseAudio",value:function(){var t=this.audio.pause();void 0!==t&&t.then((function(t){})).catch((function(t){console.info(t)}))}}]),t}()},9175:(t,e,n)=>{"use strict";function r(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var r,o,i=[],s=!0,c=!1;try{for(n=n.call(t);!(s=(r=n.next()).done)&&(i.push(r.value),!e||i.length!==e);s=!0);}catch(t){c=!0,o=t}finally{try{s||null==n.return||n.return()}finally{if(c)throw o}}return i}}(t,e)||function(t,e){if(t){if("string"==typeof t)return o(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?o(t,e):void 0}}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function o(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}n.d(e,{Ue:()=>i,G3:()=>s,Iu:()=>c,U1:()=>a,t8:()=>u});var i=function(){var t=new Float32Array(16);return t[0]=1,t[5]=1,t[10]=1,t[15]=1,t},s=function(t,e,n,r){var o=new Float32Array(16),i=1/Math.tan(t/2);if(o[0]=i/e,o[1]=0,o[2]=0,o[3]=0,o[4]=0,o[5]=i,o[6]=0,o[7]=0,o[8]=0,o[9]=0,o[10]=-1,o[11]=-1,o[12]=0,o[13]=0,o[14]=-2*n,o[15]=0,null!=r&&r!==1/0&&r!==n){var s=1/(n-r);o[10]=(r+n)*s,o[14]=2*r*n*s}return o},c=function(t,e,n){var o=t,i=r(n,3),s=i[0],c=i[1],a=i[2],u=r(e,12),f=u[0],l=u[1],p=u[2],h=u[3],y=u[4],d=u[5],b=u[6],v=u[7],m=u[8],O=u[9],g=u[10],w=u[11];return t!==e&&(o[0]=f,o[1]=l,o[2]=p,o[3]=h,o[4]=y,o[5]=d,o[6]=b,o[7]=v,o[8]=m,o[9]=O,o[10]=g,o[11]=w),o[12]=f*s+y*c+m*a+e[12],o[13]=l*s+d*c+O*a+e[13],o[14]=p*s+b*c+g*a+e[14],o[15]=h*s+v*c+w*a+e[15],o},a=function(t,e,n,o){var i=t,s=r(o,3),c=s[0],a=s[1],u=s[2],f=Math.hypot(c,a,u);if(f<1e-6)throw new Error("Matrix4*4 rotate has wrong axis");c*=f=1/f,a*=f,u*=f;var l=Math.sin(n),p=Math.cos(n),h=1-p,y=r(e,12),d=y[0],b=y[1],v=y[2],m=y[3],O=y[4],g=y[5],w=y[6],L=y[7],R=y[8],A=y[9],T=y[10],_=y[11],P=c*c*h+p,E=a*c*h+u*l,Z=u*c*h-a*l,x=c*a*h-u*l,S=a*a*h+p,W=u*a*h+c*l,j=c*u*h+a*l,M=a*u*h-c*l,k=u*u*h+p;return i[0]=d*P+O*E+R*Z,i[1]=b*P+g*E+A*Z,i[2]=v*P+w*E+T*Z,i[3]=m*P+L*E+_*Z,i[4]=d*x+O*S+R*W,i[5]=b*x+g*S+A*W,i[6]=v*x+w*S+T*W,i[7]=m*x+L*S+_*W,i[8]=d*j+O*M+R*k,i[9]=b*j+g*M+A*k,i[10]=v*j+w*M+T*k,i[11]=m*j+L*M+_*k,e!==t&&(i[12]=e[12],i[13]=e[13],i[14]=e[14],i[15]=e[15]),i};function u(t,e){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e}},8348:(t,e,n)=>{"use strict";function r(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}n.d(e,{OW:()=>o,t8:()=>i,tk:()=>s,t7:()=>c});var o=function(){function t(e,n,r){(function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")})(this,t),this.x=e,this.y=n,this.z=r}return e=t,(n=[{key:"add",value:function(e){return new t(this.x+e.x,this.y+e.y,this.z+e.z)}},{key:"sub",value:function(e){return new t(this.x-e.x,this.y-e.y,this.z-e.z)}},{key:"mul",value:function(e){return new t(this.x*e,this.y*e,this.z*e)}},{key:"length",value:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}},{key:"distance",value:function(t){return this.sub(t).length()}},{key:"normal",value:function(){if(0===this.x&&0===this.y&&0===this.z)return new t(0,0,0);var e=this.length();return new t(this.x/e,this.y/e,this.z/e)}},{key:"dot",value:function(t){return this.x*t.x+this.y*t.y+this.z*t.z}},{key:"toArray",value:function(){return[this.x,this.y,this.z]}},{key:"toString",value:function(){return"( ".concat(this.x,", ").concat(this.y,", ").concat(this.z," )")}},{key:"negate",value:function(){return new t(-1*this.x,-1*this.y,-1*this.z)}}])&&r(e.prototype,n),o&&r(e,o),Object.defineProperty(e,"prototype",{writable:!1}),t;var e,n,o}();function i(t,e){e.x=t.x,e.y=t.y,e.z=t.z}function s(t,e){return e||(e=new o(-t.x,-t.y,-t.z)),e.x=-t.x,e.y=-t.y,e.z=-t.z,e}function c(t,e,n,r){return r||(r=t),r.x=t.x+n*(e.x-t.x),r.y=t.y+n*(e.y-t.y),r.z=t.z+n*(e.z-t.z),r}},6185:(t,e,n)=>{"use strict";n.d(e,{Z:()=>r});const r={tilesetRequestUrl:function(t){return"/pixos/tilesets/"+t+"/tileset.jsx"},zoneRequestUrl:function(t){return"/pixos/maps/"+t+"/map.jsx"},artResourceUrl:function(t){return"/pixos/art/"+t}}},948:(t,e,n)=>{"use strict";n.r(e),n.d(e,{default:()=>u});var r=n(8348),o=n(4180),i=n(1262);function s(t,e,n){return s=c()?Reflect.construct:function(t,e,n){var r=[null];r.push.apply(r,e);var o=new(Function.bind.apply(t,r));return n&&a(o,n.prototype),o},s.apply(null,arguments)}function c(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}function a(t,e){return a=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},a(t,e)}const u={bounds:[0,10,17,19],tileset:"sewer",audioSrc:"/pixos/audio/blue-fields.mp3",cells:[i.Z.SLW_CORNER,i.Z.SLW_COLUMN,i.Z.FLOOR,i.Z.FLOOR,i.Z.LW_LPIT,i.Z.WATER,i.Z.WATER,i.Z.WATER,i.Z.V_WALKWAY,i.Z.WATER,i.Z.WATER,i.Z.WATER,i.Z.RW_RPIT,i.Z.FLOOR,i.Z.FLOOR,i.Z.SRW_COLUMN,i.Z.SRW_CORNER].concat([i.Z.EMPTY,i.Z.SLW_CORNER,i.Z.S_WALL,i.Z.S_WALL,i.Z.S_WALL,i.Z.SLW_WATER_COLUMN,i.Z.WATER,i.Z.WATER,i.Z.S_STAIR,i.Z.WATER,i.Z.WATER,i.Z.SRW_WATER_COLUMN,i.Z.S_WALL,i.Z.S_WALL,i.Z.S_WALL,i.Z.SRW_CORNER,i.Z.EMPTY],[i.Z.EMPTY,i.Z.EMPTY,i.Z.EMPTY,i.Z.EMPTY,i.Z.EMPTY,i.Z.L_WALL,i.Z.SW_SPIT,i.Z.SW_SPIT,i.Z.S_STAIRWALL,i.Z.SW_SPIT,i.Z.SW_SPIT,i.Z.R_WALL,i.Z.EMPTY,i.Z.EMPTY,i.Z.EMPTY,i.Z.EMPTY,i.Z.EMPTY],[i.Z.EMPTY,i.Z.EMPTY,i.Z.EMPTY,i.Z.EMPTY,i.Z.EMPTY,i.Z.L_WALL,i.Z.FLOOR,i.Z.FLOOR,i.Z.FLOOR,i.Z.FLOOR,i.Z.FLOOR,i.Z.R_WALL,i.Z.EMPTY,i.Z.EMPTY,i.Z.EMPTY,i.Z.EMPTY,i.Z.EMPTY],[i.Z.EMPTY,i.Z.EMPTY,i.Z.EMPTY,i.Z.EMPTY,i.Z.EMPTY,i.Z.L_WALL,i.Z.FLOOR,i.Z.FLOOR,i.Z.FLOOR,i.Z.FLOOR,i.Z.FLOOR,i.Z.R_WALL,i.Z.EMPTY,i.Z.EMPTY,i.Z.EMPTY,i.Z.EMPTY,i.Z.EMPTY],[i.Z.EMPTY,i.Z.EMPTY,i.Z.EMPTY,i.Z.EMPTY,i.Z.EMPTY,i.Z.SLW_CORNER,i.Z.SLW_COLUMN,i.Z.FLOOR,i.Z.FLOOR,i.Z.FLOOR,i.Z.SRW_COLUMN,i.Z.SRW_CORNER,i.Z.EMPTY,i.Z.EMPTY,i.Z.EMPTY,i.Z.EMPTY,i.Z.EMPTY],[i.Z.EMPTY,i.Z.EMPTY,i.Z.EMPTY,i.Z.EMPTY,i.Z.EMPTY,i.Z.EMPTY,i.Z.SLW_CORNER,i.Z.S_WALL,i.Z.S_WALL,i.Z.S_WALL,i.Z.SRW_CORNER,i.Z.EMPTY,i.Z.EMPTY,i.Z.EMPTY,i.Z.EMPTY,i.Z.EMPTY,i.Z.EMPTY],[i.Z.EMPTY,i.Z.EMPTY,i.Z.EMPTY,i.Z.EMPTY,i.Z.EMPTY,i.Z.EMPTY,i.Z.EMPTY,i.Z.EMPTY,i.Z.EMPTY,i.Z.EMPTY,i.Z.EMPTY,i.Z.EMPTY,i.Z.EMPTY,i.Z.EMPTY,i.Z.EMPTY,i.Z.EMPTY,i.Z.EMPTY],[i.Z.EMPTY,i.Z.EMPTY,i.Z.EMPTY,i.Z.EMPTY,i.Z.EMPTY,i.Z.EMPTY,i.Z.EMPTY,i.Z.EMPTY,i.Z.EMPTY,i.Z.EMPTY,i.Z.EMPTY,i.Z.EMPTY,i.Z.EMPTY,i.Z.EMPTY,i.Z.EMPTY,i.Z.EMPTY,i.Z.EMPTY]),sprites:[{id:"water",type:"npc/water-knight",pos:s(r.OW,[8,13,0]),facing:o.N.Up},{id:"spurt8",type:"effects/waterspurt",pos:s(r.OW,[7,10,-1.5]),facing:o.N.Up},{id:"spurt9",type:"effects/waterspurt",pos:s(r.OW,[10,10,-1.5]),facing:o.N.Up}],scripts:[{id:"load-scene",trigger:function(){console.log("Triggered")}}],scenes:[]}},4805:(t,e,n)=>{"use strict";n.r(e),n.d(e,{default:()=>u});var r=n(8348),o=n(4180),i=n(1262);function s(t,e,n){return s=c()?Reflect.construct:function(t,e,n){var r=[null];r.push.apply(r,e);var o=new(Function.bind.apply(t,r));return n&&a(o,n.prototype),o},s.apply(null,arguments)}function c(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}function a(t,e){return a=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},a(t,e)}const u={bounds:[0,0,17,10],tileset:"sewer",cells:[i.Z.EMPTY,i.Z.EMPTY,i.Z.EMPTY,i.Z.EMPTY,i.Z.EMPTY,i.Z.EMPTY,i.Z.NLW_CORNER,i.Z.N_WALL,i.Z.N_WALL,i.Z.N_WALL,i.Z.NRW_CORNER,i.Z.EMPTY,i.Z.EMPTY,i.Z.EMPTY,i.Z.EMPTY,i.Z.EMPTY,i.Z.EMPTY].concat([i.Z.EMPTY,i.Z.EMPTY,i.Z.EMPTY,i.Z.EMPTY,i.Z.EMPTY,i.Z.NLW_CORNER,i.Z.NLW_COLUMN,i.Z.FLOOR,i.Z.FLOOR,i.Z.FLOOR,i.Z.NRW_COLUMN,i.Z.NRW_CORNER,i.Z.EMPTY,i.Z.EMPTY,i.Z.EMPTY,i.Z.EMPTY,i.Z.EMPTY],[i.Z.EMPTY,i.Z.EMPTY,i.Z.EMPTY,i.Z.EMPTY,i.Z.EMPTY,i.Z.L_WALL,i.Z.FLOOR,i.Z.FLOOR,i.Z.FLOOR,i.Z.FLOOR,i.Z.FLOOR,i.Z.R_WALL,i.Z.EMPTY,i.Z.EMPTY,i.Z.EMPTY,i.Z.EMPTY,i.Z.EMPTY],[i.Z.EMPTY,i.Z.EMPTY,i.Z.EMPTY,i.Z.EMPTY,i.Z.EMPTY,i.Z.L_WALL,i.Z.FLOOR,i.Z.FLOOR,i.Z.FLOOR,i.Z.FLOOR,i.Z.FLOOR,i.Z.R_WALL,i.Z.EMPTY,i.Z.EMPTY,i.Z.EMPTY,i.Z.EMPTY,i.Z.EMPTY],[i.Z.EMPTY,i.Z.EMPTY,i.Z.EMPTY,i.Z.EMPTY,i.Z.EMPTY,i.Z.L_WALL,i.Z.NW_NPIT,i.Z.NW_NPIT,i.Z.N_STAIRWALL,i.Z.NW_NPIT,i.Z.NW_NPIT,i.Z.R_WALL,i.Z.EMPTY,i.Z.EMPTY,i.Z.EMPTY,i.Z.EMPTY,i.Z.EMPTY],[i.Z.EMPTY,i.Z.NLW_CORNER,i.Z.N_WALL,i.Z.N_WALL,i.Z.N_WALL,i.Z.NLW_WATER_COLUMN,i.Z.WATER,i.Z.WATER,i.Z.N_STAIR,i.Z.WATER,i.Z.WATER,i.Z.NRW_WATER_COLUMN,i.Z.N_WALL,i.Z.N_WALL,i.Z.N_WALL,i.Z.NRW_CORNER,i.Z.EMPTY],[i.Z.NLW_CORNER,i.Z.NLW_COLUMN,i.Z.FLOOR,i.Z.FLOOR,i.Z.LW_LPIT,i.Z.WATER,i.Z.WATER,i.Z.WATER,i.Z.V_WALKWAY,i.Z.WATER,i.Z.WATER,i.Z.WATER,i.Z.RW_RPIT,i.Z.FLOOR,i.Z.FLOOR,i.Z.NRW_COLUMN,i.Z.NRW_CORNER],[i.Z.L_WALL,i.Z.FLOOR,i.Z.FLOOR,i.Z.FLOOR,i.Z.LW_LPIT,i.Z.WATER,i.Z.WATER,i.Z.WATER,i.Z.V_WALKWAY,i.Z.WATER,i.Z.WATER,i.Z.WATER,i.Z.RW_RPIT,i.Z.FLOOR,i.Z.FLOOR,i.Z.FLOOR,i.Z.R_WALL],[i.Z.L_WALL,i.Z.FLOOR,i.Z.FLOOR,i.Z.FLOOR,i.Z.L_STAIRWALL,i.Z.L_STAIR,i.Z.H_WALKWAY,i.Z.H_WALKWAY,i.Z.C_WALKWAY,i.Z.H_WALKWAY,i.Z.H_WALKWAY,i.Z.R_STAIR,i.Z.R_STAIRWALL,i.Z.FLOOR,i.Z.FLOOR,i.Z.FLOOR,i.Z.R_WALL],[i.Z.L_WALL,i.Z.FLOOR,i.Z.FLOOR,i.Z.FLOOR,i.Z.LW_LPIT,i.Z.WATER,i.Z.WATER,i.Z.WATER,i.Z.V_WALKWAY,i.Z.WATER,i.Z.WATER,i.Z.WATER,i.Z.RW_RPIT,i.Z.FLOOR,i.Z.FLOOR,i.Z.FLOOR,i.Z.R_WALL]),sprites:[{id:"darkness",type:"npc/darkness",pos:s(r.OW,[10,4,0]),facing:o.N.Down},{id:"air",type:"npc/air-knight",pos:s(r.OW,[8,4,0]),facing:o.N.Down},{id:"fire",type:"npc/fire-knight",pos:s(r.OW,[2,9,0]),facing:o.N.Right},{id:"earth",type:"npc/earth-knight",pos:s(r.OW,[14,7,0]),facing:o.N.Left},{id:"door",type:"furniture/door",pos:s(r.OW,[2,5,0]),facing:o.N.Down,zones:["room"]},{id:"spurt1",type:"effects/waterspurt",pos:s(r.OW,[10,7,-1.5]),facing:o.N.Up},{id:"spurt2",type:"effects/waterspurt",pos:s(r.OW,[9,6,-1.5]),facing:o.N.Up},{id:"spurt3",type:"effects/waterspurt",pos:s(r.OW,[10,5,-1.5]),facing:o.N.Up},{id:"spurt4",type:"effects/waterspurt",pos:s(r.OW,[7,6,-1.5]),facing:o.N.Up},{id:"spurt5",type:"effects/waterspurt",pos:s(r.OW,[6,7,-1.5]),facing:o.N.Up},{id:"spurt6",type:"effects/waterspurt",pos:s(r.OW,[6,9,-1.5]),facing:o.N.Up},{id:"spurt7",type:"effects/waterspurt",pos:s(r.OW,[9,9,-1.5]),facing:o.N.Up},{id:"avatar",type:"characters/default",pos:s(r.OW,[2,6,0]),facing:o.N.Down}],scenes:[],scripts:[]}},5686:(t,e,n)=>{"use strict";n.r(e),n.d(e,{default:()=>l});var r=n(8348),o=n(4180),i=n(1262);function s(t,e,n,r,o,i,s){try{var c=t[i](s),a=c.value}catch(t){return void n(t)}c.done?e(a):Promise.resolve(a).then(r,o)}function c(t){return function(){var e=this,n=arguments;return new Promise((function(r,o){var i=t.apply(e,n);function c(t){s(i,r,o,c,a,"next",t)}function a(t){s(i,r,o,c,a,"throw",t)}c(void 0)}))}}function a(t,e,n){return a=u()?Reflect.construct:function(t,e,n){var r=[null];r.push.apply(r,e);var o=new(Function.bind.apply(t,r));return n&&f(o,n.prototype),o},a.apply(null,arguments)}function u(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}function f(t,e){return f=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},f(t,e)}const l={bounds:[0,0,17,19],tileset:"sewer",cells:[i.Z.EMPTY,i.Z.EMPTY,i.Z.EMPTY,i.Z.EMPTY,i.Z.EMPTY,i.Z.EMPTY,i.Z.EMPTY,i.Z.EMPTY,i.Z.EMPTY,i.Z.EMPTY,i.Z.EMPTY,i.Z.EMPTY,i.Z.EMPTY,i.Z.EMPTY,i.Z.EMPTY,i.Z.EMPTY,i.Z.EMPTY].concat([i.Z.EMPTY,i.Z.EMPTY,i.Z.NLW_CORNER,i.Z.N_WALL,i.Z.N_WALL,i.Z.N_WALL,i.Z.N_WALL,i.Z.N_WALL,i.Z.N_WALL,i.Z.N_WALL,i.Z.N_WALL,i.Z.N_WALL,i.Z.N_WALL,i.Z.N_WALL,i.Z.NRW_CORNER,i.Z.EMPTY,i.Z.EMPTY],[i.Z.EMPTY,i.Z.NLW_CORNER,i.Z.NLW_COLUMN,i.Z.FLOOR,i.Z.FLOOR,i.Z.FLOOR,i.Z.FLOOR,i.Z.FLOOR,i.Z.FLOOR,i.Z.FLOOR,i.Z.FLOOR,i.Z.FLOOR,i.Z.FLOOR,i.Z.FLOOR,i.Z.NRW_COLUMN,i.Z.NRW_CORNER,i.Z.EMPTY],[i.Z.EMPTY,i.Z.L_WALL,i.Z.FLOOR,i.Z.FLOOR,i.Z.FLOOR,i.Z.FLOOR,i.Z.FLOOR,i.Z.FLOOR,i.Z.FLOOR,i.Z.FLOOR,i.Z.FLOOR,i.Z.FLOOR,i.Z.FLOOR,i.Z.FLOOR,i.Z.FLOOR,i.Z.R_WALL,i.Z.EMPTY],[i.Z.EMPTY,i.Z.L_WALL,i.Z.FLOOR,i.Z.FLOOR,i.Z.FLOOR,i.Z.FLOOR,i.Z.FLOOR,i.Z.FLOOR,i.Z.FLOOR,i.Z.FLOOR,i.Z.FLOOR,i.Z.FLOOR,i.Z.FLOOR,i.Z.FLOOR,i.Z.FLOOR,i.Z.R_WALL,i.Z.EMPTY],[i.Z.EMPTY,i.Z.L_WALL,i.Z.FLOOR,i.Z.FLOOR,i.Z.FLOOR,i.Z.FLOOR,i.Z.FLOOR,i.Z.FLOOR,i.Z.FLOOR,i.Z.FLOOR,i.Z.FLOOR,i.Z.FLOOR,i.Z.FLOOR,i.Z.FLOOR,i.Z.FLOOR,i.Z.R_WALL,i.Z.EMPTY],[i.Z.EMPTY,i.Z.L_WALL,i.Z.FLOOR,i.Z.FLOOR,i.Z.FLOOR,i.Z.FLOOR,i.Z.FLOOR,i.Z.FLOOR,i.Z.FLOOR,i.Z.FLOOR,i.Z.FLOOR,i.Z.FLOOR,i.Z.FLOOR,i.Z.FLOOR,i.Z.FLOOR,i.Z.R_WALL,i.Z.EMPTY],[i.Z.EMPTY,i.Z.L_WALL,i.Z.FLOOR,i.Z.FLOOR,i.Z.FLOOR,i.Z.FLOOR,i.Z.FLOOR,i.Z.FLOOR,i.Z.FLOOR,i.Z.FLOOR,i.Z.FLOOR,i.Z.FLOOR,i.Z.FLOOR,i.Z.FLOOR,i.Z.FLOOR,i.Z.R_WALL,i.Z.EMPTY],[i.Z.EMPTY,i.Z.L_WALL,i.Z.FLOOR,i.Z.FLOOR,i.Z.FLOOR,i.Z.FLOOR,i.Z.FLOOR,i.Z.FLOOR,i.Z.FLOOR,i.Z.FLOOR,i.Z.FLOOR,i.Z.FLOOR,i.Z.FLOOR,i.Z.FLOOR,i.Z.FLOOR,i.Z.R_WALL,i.Z.EMPTY],[i.Z.EMPTY,i.Z.L_WALL,i.Z.FLOOR,i.Z.FLOOR,i.Z.FLOOR,i.Z.FLOOR,i.Z.FLOOR,i.Z.FLOOR,i.Z.FLOOR,i.Z.FLOOR,i.Z.FLOOR,i.Z.FLOOR,i.Z.FLOOR,i.Z.FLOOR,i.Z.FLOOR,i.Z.R_WALL,i.Z.EMPTY],[i.Z.EMPTY,i.Z.L_WALL,i.Z.FLOOR,i.Z.FLOOR,i.Z.FLOOR,i.Z.FLOOR,i.Z.FLOOR,i.Z.FLOOR,i.Z.FLOOR,i.Z.FLOOR,i.Z.FLOOR,i.Z.FLOOR,i.Z.FLOOR,i.Z.FLOOR,i.Z.FLOOR,i.Z.R_WALL,i.Z.EMPTY],[i.Z.EMPTY,i.Z.L_WALL,i.Z.FLOOR,i.Z.FLOOR,i.Z.FLOOR,i.Z.FLOOR,i.Z.FLOOR,i.Z.FLOOR,i.Z.FLOOR,i.Z.FLOOR,i.Z.FLOOR,i.Z.FLOOR,i.Z.FLOOR,i.Z.FLOOR,i.Z.FLOOR,i.Z.R_WALL,i.Z.EMPTY],[i.Z.EMPTY,i.Z.L_WALL,i.Z.FLOOR,i.Z.FLOOR,i.Z.FLOOR,i.Z.FLOOR,i.Z.FLOOR,i.Z.FLOOR,i.Z.FLOOR,i.Z.FLOOR,i.Z.FLOOR,i.Z.FLOOR,i.Z.FLOOR,i.Z.FLOOR,i.Z.FLOOR,i.Z.R_WALL,i.Z.EMPTY],[i.Z.EMPTY,i.Z.L_WALL,i.Z.FLOOR,i.Z.FLOOR,i.Z.FLOOR,i.Z.FLOOR,i.Z.FLOOR,i.Z.FLOOR,i.Z.FLOOR,i.Z.FLOOR,i.Z.FLOOR,i.Z.FLOOR,i.Z.FLOOR,i.Z.FLOOR,i.Z.FLOOR,i.Z.R_WALL,i.Z.EMPTY],[i.Z.EMPTY,i.Z.L_WALL,i.Z.FLOOR,i.Z.FLOOR,i.Z.FLOOR,i.Z.FLOOR,i.Z.FLOOR,i.Z.FLOOR,i.Z.FLOOR,i.Z.FLOOR,i.Z.FLOOR,i.Z.FLOOR,i.Z.FLOOR,i.Z.FLOOR,i.Z.FLOOR,i.Z.R_WALL,i.Z.EMPTY],[i.Z.EMPTY,i.Z.L_WALL,i.Z.FLOOR,i.Z.FLOOR,i.Z.FLOOR,i.Z.FLOOR,i.Z.FLOOR,i.Z.FLOOR,i.Z.FLOOR,i.Z.FLOOR,i.Z.FLOOR,i.Z.FLOOR,i.Z.FLOOR,i.Z.FLOOR,i.Z.FLOOR,i.Z.R_WALL,i.Z.EMPTY],[i.Z.EMPTY,i.Z.SLW_CORNER,i.Z.SLW_COLUMN,i.Z.FLOOR,i.Z.FLOOR,i.Z.FLOOR,i.Z.FLOOR,i.Z.FLOOR,i.Z.FLOOR,i.Z.FLOOR,i.Z.FLOOR,i.Z.FLOOR,i.Z.FLOOR,i.Z.FLOOR,i.Z.SRW_COLUMN,i.Z.SRW_CORNER,i.Z.EMPTY],[i.Z.EMPTY,i.Z.EMPTY,i.Z.SLW_CORNER,i.Z.S_WALL,i.Z.S_WALL,i.Z.S_WALL,i.Z.S_WALL,i.Z.S_WALL,i.Z.S_WALL,i.Z.S_WALL,i.Z.S_WALL,i.Z.S_WALL,i.Z.S_WALL,i.Z.S_WALL,i.Z.SRW_CORNER,i.Z.EMPTY,i.Z.EMPTY],[i.Z.EMPTY,i.Z.EMPTY,i.Z.EMPTY,i.Z.EMPTY,i.Z.EMPTY,i.Z.EMPTY,i.Z.EMPTY,i.Z.EMPTY,i.Z.EMPTY,i.Z.EMPTY,i.Z.EMPTY,i.Z.EMPTY,i.Z.EMPTY,i.Z.EMPTY,i.Z.EMPTY,i.Z.EMPTY,i.Z.EMPTY]),sprites:[{id:"chest",type:"objects/chests/wood",pos:a(r.OW,[8,14,0]),facing:o.N.Down},{id:"chestmetal",type:"objects/chests/metal",pos:a(r.OW,[9,13,0]),facing:o.N.Right},{id:"chestred",type:"objects/chests/red",pos:a(r.OW,[9,14,0]),facing:o.N.Down},{id:"chestblue",type:"objects/chests/blue",pos:a(r.OW,[7,13,0]),facing:o.N.Left},{id:"door",type:"furniture/door",pos:a(r.OW,[9,1,0]),facing:o.N.Down,zones:["dungeon-top","dungeon-bottom"]},{id:"tree",type:"furniture/tree",pos:a(r.OW,[8,13,0]),facing:o.N.Up},{id:"fireplace",type:"furniture/fireplace",pos:a(r.OW,[11,1,0]),facing:o.N.Up},{id:"fireplace",type:"effects/fireplace",pos:a(r.OW,[11,1,0]),facing:o.N.Up},{id:"darkness",type:"npc/darkness",pos:a(r.OW,[6,2,0]),facing:o.N.Down},{id:"air",type:"npc/air-knight",pos:a(r.OW,[8,2,0]),facing:o.N.Down},{id:"fire",type:"npc/fire-knight",pos:a(r.OW,[2,8,0]),facing:o.N.Right},{id:"earth",type:"npc/earth-knight",pos:a(r.OW,[14,8,0]),facing:o.N.Left},{id:"avatar",type:"characters/default",pos:a(r.OW,[9,2,0]),facing:o.N.Down}],scenes:[{id:"strange-legend",actions:[{sprite:"air",action:"dialogue",args:[["Long ago, in a dungeon far far away","The sewer was backing up, and well...everyone was losing their $%#t","But one had a plan..."],!1,{autoclose:!0}],scope:void 0},{sprite:"air",action:"dialogue",args:[["But what was that plan?..."],!1,{autoclose:!0}],scope:void 0},{trigger:"custom",scope:void 0}]}],scripts:[{id:"load-scene",trigger:(y=c(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.playScene("strange-legend");case 2:case"end":return t.stop()}}),t,this)}))),function(){return y.apply(this,arguments)})},{id:"custom",trigger:(h=c(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.spriteDialogue("earth",["Lets get in there!"]);case 2:case"end":return t.stop()}}),t,this)}))),function(){return h.apply(this,arguments)})},{id:"clear-path",trigger:(p=c(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.moveSprite("darkness",[8,3,0],!0);case 2:case"end":return t.stop()}}),t,this)}))),function(){return p.apply(this,arguments)})}]};var p,h,y},642:(t,e,n)=>{"use strict";n.r(e),n.d(e,{default:()=>u});var r=n(8348),o=n(6185);function i(t){return i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},i(t)}function s(t,e){return s=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},s(t,e)}function c(t,e){if(e&&("object"===i(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function a(t){return a=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},a(t)}var u=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");Object.defineProperty(t,"prototype",{value:Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),writable:!1}),e&&s(t,e)}(f,t);var e,n,i,u=(n=f,i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,e=a(n);if(i){var r=a(this).constructor;t=Reflect.construct(e,arguments,r)}else t=e.apply(this,arguments);return c(this,t)});function f(t){var e;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,f),(e=u.call(this,t)).src=o.Z.artResourceUrl("player.gif"),e.portraitSrc=o.Z.artResourceUrl("hero_portrait.gif"),e.sheetSize=[128,256],e.tileSize=[24,32],e.state="intro",e.frames={up:[[0,0],[24,0],[48,0],[24,0]],right:[[0,32],[24,32],[48,32],[24,32]],down:[[0,64],[24,64],[48,64],[24,64]],left:[[0,96],[24,96],[48,96],[24,96]]},e.drawOffset=new r.OW(-.25,1,.125),e.hotspotOffset=new r.OW(.5,.5,0),e.bindCamera=!0,e.enableSpeech=!0,e}return e=f,Object.defineProperty(e,"prototype",{writable:!1}),e}(n(6180).Z)},7154:(t,e,n)=>{"use strict";n.r(e),n.d(e,{default:()=>u});var r=n(8348),o=n(6185);function i(t){return i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},i(t)}function s(t,e){return s=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},s(t,e)}function c(t,e){if(e&&("object"===i(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function a(t){return a=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},a(t)}var u=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");Object.defineProperty(t,"prototype",{value:Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),writable:!1}),e&&s(t,e)}(f,t);var e,n,i,u=(n=f,i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,e=a(n);if(i){var r=a(this).constructor;t=Reflect.construct(e,arguments,r)}else t=e.apply(this,arguments);return c(this,t)});function f(t){var e;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,f),(e=u.call(this,t)).src=o.Z.artResourceUrl("player.gif"),e.portraitSrc=o.Z.artResourceUrl("hero_portrait.gif"),e.sheetSize=[128,256],e.tileSize=[24,32],e.state="intro",e.frames={up:[[0,0],[24,0],[48,0],[24,0]],right:[[0,32],[24,32],[48,32],[24,32]],down:[[0,64],[24,64],[48,64],[24,64]],left:[[0,96],[24,96],[48,96],[24,96]]},e.drawOffset=new r.OW(-.25,1,.125),e.hotspotOffset=new r.OW(.5,.5,0),e.bindCamera=!0,e.enableSpeech=!0,e}return e=f,Object.defineProperty(e,"prototype",{writable:!1}),e}(n(6180).Z)},597:(t,e,n)=>{"use strict";n.r(e),n.d(e,{default:()=>g});var r=n(8348),o=n(6185),i=n(9175);function s(t){return s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},s(t)}function c(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function a(t,e){return a=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},a(t,e)}function u(t,e){if(e&&("object"===s(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function f(t){return f=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},f(t)}function l(t){return l="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},l(t)}function p(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function h(t,e){return h=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},h(t,e)}function y(t,e){if(e&&("object"===l(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function d(t){return d=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},d(t)}function b(t){return b="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},b(t)}function v(t,e){return v=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},v(t,e)}function m(t,e){if(e&&("object"===b(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function O(t){return O=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},O(t)}var g=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");Object.defineProperty(t,"prototype",{value:Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),writable:!1}),e&&v(t,e)}(i,t);var e,n,r,o=(n=i,r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,e=O(n);if(r){var o=O(this).constructor;t=Reflect.construct(e,arguments,o)}else t=e.apply(this,arguments);return m(this,t)});function i(t){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,i),o.call(this,t)}return e=i,Object.defineProperty(e,"prototype",{writable:!1}),e}(function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");Object.defineProperty(t,"prototype",{value:Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),writable:!1}),e&&h(t,e)}(a,t);var e,n,i,s,c=(i=a,s=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,e=d(i);if(s){var n=d(this).constructor;t=Reflect.construct(e,arguments,n)}else t=e.apply(this,arguments);return y(this,t)});function a(t){var e;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,a),(e=c.call(this,t)).src=o.Z.artResourceUrl("room.gif"),e.sheetSize=[256,256],e.tileSize=[48,32],e.frames={up:[[0,144],[48,144],[0,176],[48,176]]},e.drawOffset=new r.OW(0,1.85,-.02),e.hotspotOffset=new r.OW(.5,.5,0),e.frameTime=150,e}return e=a,(n=[{key:"init",value:function(){this.triggerTime=1e3}}])&&p(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),a}(function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");Object.defineProperty(t,"prototype",{value:Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),writable:!1}),e&&a(t,e)}(l,t);var e,n,r,o,s=(r=l,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,e=f(r);if(o){var n=f(this).constructor;t=Reflect.construct(e,arguments,n)}else t=e.apply(this,arguments);return u(this,t)});function l(t){var e;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,l),(e=s.call(this,t)).enableSpeech=!1,e.lastTime=0,e.accumTime=0,e.triggerTime=400,e.frameTime=250,e}return e=l,(n=[{key:"init",value:function(){this.triggerTime=1e3+Math.floor(5e3*Math.random())}},{key:"tick",value:function(t){0!=this.lastTime?(this.accumTime+=t-this.lastTime,this.accumTime<this.frameTime||0==this.animFrame&&this.accumTime<this.triggerTime||(5==this.animFrame?(this.setFrame(0),this.triggerTime=1e3+Math.floor(4e3*Math.random())):(this.setFrame(this.animFrame+1),this.accumTime=0,this.lastTime=t))):this.lastTime=t}},{key:"draw",value:function(t){this.loaded&&(t.mvPushMatrix(),(0,i.Iu)(this.engine.uViewMat,this.engine.uViewMat,this.drawOffset.toArray()),(0,i.Iu)(this.engine.uViewMat,this.engine.uViewMat,this.pos.toArray()),(0,i.U1)(this.engine.uViewMat,this.engine.uViewMat,this.engine.degToRad(this.engine.cameraAngle),[1,0,0]),t.bindBuffer(this.vertexPosBuf,t.shaderProgram.vertexPositionAttribute),t.bindBuffer(this.vertexTexBuf,t.shaderProgram.textureCoordAttribute),this.texture.attach(),t.gl.depthFunc(t.gl.ALWAYS),t.shaderProgram.setMatrixUniforms(),t.gl.drawArrays(t.gl.TRIANGLES,0,this.vertexPosBuf.numItems),t.gl.depthFunc(t.gl.LESS),t.mvPopMatrix())}}])&&c(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),l}(n(5870).Z)))},5359:(t,e,n)=>{"use strict";n.r(e),n.d(e,{default:()=>g});var r=n(8348),o=n(6185),i=n(9175);function s(t){return s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},s(t)}function c(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function a(t,e){return a=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},a(t,e)}function u(t,e){if(e&&("object"===s(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function f(t){return f=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},f(t)}function l(t){return l="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},l(t)}function p(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function h(t,e){return h=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},h(t,e)}function y(t,e){if(e&&("object"===l(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function d(t){return d=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},d(t)}function b(t){return b="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},b(t)}function v(t,e){return v=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},v(t,e)}function m(t,e){if(e&&("object"===b(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function O(t){return O=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},O(t)}var g=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");Object.defineProperty(t,"prototype",{value:Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),writable:!1}),e&&v(t,e)}(i,t);var e,n,r,o=(n=i,r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,e=O(n);if(r){var o=O(this).constructor;t=Reflect.construct(e,arguments,o)}else t=e.apply(this,arguments);return m(this,t)});function i(t){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,i),o.call(this,t)}return e=i,Object.defineProperty(e,"prototype",{writable:!1}),e}(function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");Object.defineProperty(t,"prototype",{value:Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),writable:!1}),e&&h(t,e)}(a,t);var e,n,i,s,c=(i=a,s=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,e=d(i);if(s){var n=d(this).constructor;t=Reflect.construct(e,arguments,n)}else t=e.apply(this,arguments);return y(this,t)});function a(t){var e;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,a),(e=c.call(this,t)).src=o.Z.artResourceUrl("sewer.gif"),e.sheetSize=[256,256],e.tileSize=[16,16],e.frames={up:[[0,144],[16,144],[32,144],[48,144],[64,144],[80,144]]},e.drawOffset=new r.OW(0,1,.001),e.hotspotOffset=new r.OW(.5,.5,0),e.frameTime=150,e}return e=a,(n=[{key:"init",value:function(){this.triggerTime=1e3+5e3*Math.random()}}])&&p(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),a}(function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");Object.defineProperty(t,"prototype",{value:Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),writable:!1}),e&&a(t,e)}(l,t);var e,n,r,o,s=(r=l,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,e=f(r);if(o){var n=f(this).constructor;t=Reflect.construct(e,arguments,n)}else t=e.apply(this,arguments);return u(this,t)});function l(t){var e;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,l),(e=s.call(this,t)).enableSpeech=!1,e.lastTime=0,e.accumTime=0,e.triggerTime=400,e.frameTime=250,e.blocking=!1,e}return e=l,(n=[{key:"init",value:function(){this.triggerTime=2e3}},{key:"tick",value:function(t){0!=this.lastTime?(this.accumTime+=t-this.lastTime,this.accumTime<this.frameTime||0==this.animFrame&&this.accumTime<this.triggerTime||(4==this.animFrame?(this.setFrame(0),this.triggerTime=2e3+Math.floor(4e3*Math.random())):(this.setFrame(this.animFrame+1),this.accumTime=0,this.lastTime=t))):this.lastTime=t}},{key:"draw",value:function(t){this.loaded&&(t.mvPushMatrix(),(0,i.Iu)(t.uViewMat,t.uViewMat,this.pos.toArray()),(0,i.Iu)(t.uViewMat,t.uViewMat,this.drawOffset.toArray()),(0,i.U1)(t.uViewMat,t.uViewMat,t.degToRad(90),[1,0,0]),t.bindBuffer(this.vertexPosBuf,t.shaderProgram.vertexPositionAttribute),t.bindBuffer(this.vertexTexBuf,t.shaderProgram.textureCoordAttribute),this.texture.attach(),t.shaderProgram.setMatrixUniforms(),t.gl.drawArrays(t.gl.TRIANGLES,0,this.vertexPosBuf.numItems),t.mvPopMatrix())}}])&&c(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),l}(n(5870).Z)))},7085:(t,e,n)=>{"use strict";n.r(e),n.d(e,{default:()=>v});var r=n(8348),o=n(6185),i=n(5870),s=n(9337);function c(t){return c="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},c(t)}function a(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function u(t,e){return u=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},u(t,e)}function f(t,e){if(e&&("object"===c(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function l(t){return l=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},l(t)}var p=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");Object.defineProperty(t,"prototype",{value:Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),writable:!1}),e&&u(t,e)}(h,t);var e,n,i,c,p=(i=h,c=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,e=l(i);if(c){var n=l(this).constructor;t=Reflect.construct(e,arguments,n)}else t=e.apply(this,arguments);return f(this,t)});function h(t){var e;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,h),(e=p.call(this,t)).src=o.Z.artResourceUrl("room.gif"),e.sheetSize=[256,256],e.tileSize=[16,32],e.frames={up:[[48,64],[48,96]],right:[[48,64],[48,96]],left:[[48,64],[48,96]],down:[[48,64],[48,96]]},e.drawOffset=new r.OW(0,1.001,.001),e.hotspotOffset=new r.OW(.5,.5,0),e.state="closed",e}return e=h,n=[{key:"interact",value:function(t,e){console.log("opening door",t);var n=null;switch(this.startTime=Date.now(),this.state){case"closed":this.state="open",this.blocking=!1,this.override=!0,n=new s.aW(this.engine,"animate",[600,3,function(){console.log("OPENED!!!"),e(!0)}],this);break;case"open":this.state="open",n=new s.aW(this.engine,"dialogue",["Its already Open!.",!1,{autoclose:!0,onClose:function(){return e(!0)}}],this)}return n&&this.addAction(n),e&&e(!1),n}},{key:"onStep",value:function(t){console.log("walking out....",t);var e=this.zone.world;return e.removeAllZones(),this.zones&&this.zones.forEach((function(t){return e.loadZone(t)})),null}}],n&&a(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),h}(i.Z);function h(t){return h="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},h(t)}function y(t,e){return y=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},y(t,e)}function d(t,e){if(e&&("object"===h(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function b(t){return b=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},b(t)}var v=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");Object.defineProperty(t,"prototype",{value:Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),writable:!1}),e&&y(t,e)}(i,t);var e,n,r,o=(n=i,r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,e=b(n);if(r){var o=b(this).constructor;t=Reflect.construct(e,arguments,o)}else t=e.apply(this,arguments);return d(this,t)});function i(t){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,i),o.call(this,t)}return e=i,Object.defineProperty(e,"prototype",{writable:!1}),e}(p)},6463:(t,e,n)=>{"use strict";n.r(e),n.d(e,{default:()=>h});var r=n(8348),o=n(6185);function i(t){return i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},i(t)}function s(t,e){return s=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},s(t,e)}function c(t,e){if(e&&("object"===i(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function a(t){return a=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},a(t)}function u(t){return u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},u(t)}function f(t,e){return f=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},f(t,e)}function l(t,e){if(e&&("object"===u(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function p(t){return p=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},p(t)}var h=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");Object.defineProperty(t,"prototype",{value:Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),writable:!1}),e&&f(t,e)}(i,t);var e,n,r,o=(n=i,r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,e=p(n);if(r){var o=p(this).constructor;t=Reflect.construct(e,arguments,o)}else t=e.apply(this,arguments);return l(this,t)});function i(t){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,i),o.call(this,t)}return e=i,Object.defineProperty(e,"prototype",{writable:!1}),e}(function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");Object.defineProperty(t,"prototype",{value:Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),writable:!1}),e&&s(t,e)}(f,t);var e,n,i,u=(n=f,i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,e=a(n);if(i){var r=a(this).constructor;t=Reflect.construct(e,arguments,r)}else t=e.apply(this,arguments);return c(this,t)});function f(t){var e;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,f),(e=u.call(this,t)).src=o.Z.artResourceUrl("room.gif"),e.sheetSize=[256,256],e.tileSize=[48,80],e.frames={up:[[160,80]]},e.drawOffset=new r.OW(0,1.85,.001),e.hotspotOffset=new r.OW(.5,.5,0),e}return e=f,Object.defineProperty(e,"prototype",{writable:!1}),e}(n(5870).Z))},5624:(t,e,n)=>{"use strict";n.r(e),n.d(e,{default:()=>h});var r=n(8348),o=n(6185);function i(t){return i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},i(t)}function s(t,e){return s=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},s(t,e)}function c(t,e){if(e&&("object"===i(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function a(t){return a=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},a(t)}function u(t){return u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},u(t)}function f(t,e){return f=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},f(t,e)}function l(t,e){if(e&&("object"===u(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function p(t){return p=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},p(t)}var h=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");Object.defineProperty(t,"prototype",{value:Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),writable:!1}),e&&f(t,e)}(i,t);var e,n,r,o=(n=i,r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,e=p(n);if(r){var o=p(this).constructor;t=Reflect.construct(e,arguments,o)}else t=e.apply(this,arguments);return l(this,t)});function i(t){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,i),o.call(this,t)}return e=i,Object.defineProperty(e,"prototype",{writable:!1}),e}(function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");Object.defineProperty(t,"prototype",{value:Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),writable:!1}),e&&s(t,e)}(f,t);var e,n,i,u=(n=f,i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,e=a(n);if(i){var r=a(this).constructor;t=Reflect.construct(e,arguments,r)}else t=e.apply(this,arguments);return c(this,t)});function f(t){var e;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,f),(e=u.call(this,t)).src=o.Z.artResourceUrl("trees.png"),e.sheetSize=[512,512],e.tileSize=[96,144],e.frames={up:[[96,160]]},e.drawOffset=new r.OW(-2.5,2.15,-.85),e.hotspotOffset=new r.OW(.5,.5,0),e.blocking=!0,e}return e=f,Object.defineProperty(e,"prototype",{writable:!1}),e}(n(5870).Z))},5378:(t,e,n)=>{"use strict";n.r(e),n.d(e,{default:()=>v});var r=n(9337),o=n(8348),i=n(6185);function s(t){return s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},s(t)}function c(t,e){return c=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},c(t,e)}function a(t,e){if(e&&("object"===s(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function u(t){return u=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},u(t)}function f(t){return f="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},f(t)}function l(t,e,n,r,o,i,s){try{var c=t[i](s),a=c.value}catch(t){return void n(t)}c.done?e(a):Promise.resolve(a).then(r,o)}function p(t){return function(){var e=this,n=arguments;return new Promise((function(r,o){var i=t.apply(e,n);function s(t){l(i,r,o,s,c,"next",t)}function c(t){l(i,r,o,s,c,"throw",t)}s(void 0)}))}}function h(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function y(t,e){return y=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},y(t,e)}function d(t,e){if(e&&("object"===f(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function b(t){return b=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},b(t)}var v=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");Object.defineProperty(t,"prototype",{value:Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),writable:!1}),e&&y(t,e)}(c,t);var e,n,o,i,s=(o=c,i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,e=b(o);if(i){var n=b(this).constructor;t=Reflect.construct(e,arguments,n)}else t=e.apply(this,arguments);return d(this,t)});function c(t){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,c),s.call(this,t)}return e=c,(n=[{key:"interact",value:function(t,e){var n=null;switch(this.state){case"intro":this.state="loop",n=new r.aW(this.engine,"dialogue",["Buying eh?!",!1,{autoclose:!0,onClose:function(){return e(!0)}}],this,p(regeneratorRuntime.mark((function t(){var e,n,r,o;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,ethereum.request({method:"eth_requestAccounts"});case 2:e=t.sent[0],n=JSON.stringify({domain:{chainId:1,name:"Pixos",verifyingContract:"0xCcCCccccCCCCcCCCCCCcCcCccCcCCCcCcccccccC",version:"1"},message:{game:"Example",contents:"Quest Item",from:{sprite:"air-knight",wallet:"0xCD2a3d9F938E13CD947Ec05AbC7FE734Df8DD826"},to:{sprite:"avatar",wallet:e}},primaryType:"Item",types:{EIP712Domain:[{name:"name",type:"string"},{name:"version",type:"string"},{name:"chainId",type:"uint256"},{name:"verifyingContract",type:"address"}],Item:[{name:"game",type:"string"},{name:"contents",type:"string"},{name:"from",type:"Person"},{name:"to",type:"Person"}],Person:[{name:"sprite",type:"string"},{name:"wallet",type:"address"}]}}),o=[r=e,n],web3.currentProvider.sendAsync({method:"eth_signTypedData_v4",params:o,from:r},(function(t,e){if(t)return console.dir(t);if(e.error&&alert(e.error.message),e.error)return console.error("ERROR",e);console.log("TYPED SIGNED:"+JSON.stringify(e.result));var o=sigUtil.recoverTypedSignature_v4({data:JSON.parse(n),sig:e.result});ethUtil.toChecksumAddress(o)===ethUtil.toChecksumAddress(r)?alert("Successfully recovered signer as "+r):alert("Failed to verify signer when comparing "+e+" to "+r)}));case 8:case"end":return t.stop()}}),t)}))));break;case"loop":this.state="loop2",n=new r.aW(this.engine,"dialogue",["I heard about a strange legend once.",!1,{autoclose:!0,onClose:function(){return e(!0)}}],this);break;case"loop2":this.state="loop",n=new r.aW(this.engine,"dialogue",["Sorry, I don't remember the story at the moment",!1,{autoclose:!0,onClose:function(){return e(!0)}}],this)}return console.log(n),n&&this.addAction(n),e&&e(!1),n}}])&&h(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),c}(function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");Object.defineProperty(t,"prototype",{value:Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),writable:!1}),e&&c(t,e)}(f,t);var e,n,r,s=(n=f,r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,e=u(n);if(r){var o=u(this).constructor;t=Reflect.construct(e,arguments,o)}else t=e.apply(this,arguments);return a(this,t)});function f(t){var e;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,f),(e=s.call(this,t)).src=i.Z.artResourceUrl("air-knight.gif"),e.portraitSrc=i.Z.artResourceUrl("air_portrait.gif"),e.sheetSize=[128,256],e.tileSize=[24,32],e.drawOffset=new o.OW(-.25,1,.125),e.hotspotOffset=new o.OW(.5,.5,0),e.frames={up:[[0,0],[24,0],[48,0],[24,0]],right:[[0,32],[24,32],[48,32],[24,32]],down:[[0,64],[24,64],[48,64],[24,64]],left:[[0,96],[24,96],[48,96],[24,96]]},e.bindCamera=!1,e.enableSpeech=!0,e.state="intro",e}return e=f,Object.defineProperty(e,"prototype",{writable:!1}),e}(n(7772).Z))},6613:(t,e,n)=>{"use strict";n.r(e),n.d(e,{default:()=>d});var r=n(9337),o=n(8348),i=n(6185);function s(t){return s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},s(t)}function c(t,e){return c=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},c(t,e)}function a(t,e){if(e&&("object"===s(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function u(t){return u=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},u(t)}function f(t){return f="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},f(t)}function l(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function p(t,e){return p=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},p(t,e)}function h(t,e){if(e&&("object"===f(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function y(t){return y=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},y(t)}var d=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");Object.defineProperty(t,"prototype",{value:Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),writable:!1}),e&&p(t,e)}(c,t);var e,n,o,i,s=(o=c,i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,e=y(o);if(i){var n=y(this).constructor;t=Reflect.construct(e,arguments,n)}else t=e.apply(this,arguments);return h(this,t)});function c(t){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,c),s.call(this,t)}return e=c,(n=[{key:"interact",value:function(t,e){var n=null;switch(this.state){case"intro":this.state="loop",n=new r.aW(this.engine,"dialogue",["Join me....!",!1,{autoclose:!0,onClose:function(){return e(!0)}}],this);break;case"loop":this.state="loop2",n=new r.aW(this.engine,"dialogue",["I need a partner for squash.",!1,{autoclose:!0,onClose:function(){return e(!0)}}],this);break;case"loop2":this.state="loop",n=new r.aW(this.engine,"dialogue",["Seriously - you swing?",!1,{autoclose:!0,onClose:function(){return e(!0)}}],this)}return n&&this.addAction(n),e&&e(!1),n}}])&&l(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),c}(function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");Object.defineProperty(t,"prototype",{value:Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),writable:!1}),e&&c(t,e)}(f,t);var e,n,r,s=(n=f,r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,e=u(n);if(r){var o=u(this).constructor;t=Reflect.construct(e,arguments,o)}else t=e.apply(this,arguments);return a(this,t)});function f(t){var e;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,f),(e=s.call(this,t)).src=i.Z.artResourceUrl("darkness.gif"),e.portraitSrc=i.Z.artResourceUrl("dark_portrait.gif"),e.sheetSize=[128,256],e.tileSize=[24,32],e.drawOffset=new o.OW(-.25,1,.125),e.hotspotOffset=new o.OW(.5,.5,0),e.frames={up:[[0,0],[24,0],[48,0],[24,0]],right:[[0,32],[24,32],[48,32],[24,32]],down:[[0,64],[24,64],[48,64],[24,64]],left:[[0,96],[24,96],[48,96],[24,96]]},e.bindCamera=!1,e.enableSpeech=!0,e.state="intro",e}return e=f,Object.defineProperty(e,"prototype",{writable:!1}),e}(n(7772).Z))},5532:(t,e,n)=>{"use strict";n.r(e),n.d(e,{default:()=>d});var r=n(9337),o=n(8348),i=n(6185);function s(t){return s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},s(t)}function c(t,e){return c=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},c(t,e)}function a(t,e){if(e&&("object"===s(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function u(t){return u=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},u(t)}function f(t){return f="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},f(t)}function l(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function p(t,e){return p=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},p(t,e)}function h(t,e){if(e&&("object"===f(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function y(t){return y=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},y(t)}var d=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");Object.defineProperty(t,"prototype",{value:Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),writable:!1}),e&&p(t,e)}(c,t);var e,n,o,i,s=(o=c,i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,e=y(o);if(i){var n=y(this).constructor;t=Reflect.construct(e,arguments,n)}else t=e.apply(this,arguments);return h(this,t)});function c(t){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,c),s.call(this,t)}return e=c,(n=[{key:"interact",value:function(t,e){var n=null;switch(this.state){case"intro":this.state="loop",n=new r.aW(this.engine,"dialogue",["Welcome!",!1,{autoclose:!0,onClose:function(){return e(!0)}}],this);break;case"loop":this.state="loop2",n=new r.aW(this.engine,"dialogue",["I heard about a strange legend once.",!1,{autoclose:!0,onClose:function(){return e(!0)}}],this);break;case"loop2":this.state="loop",n=new r.aW(this.engine,"dialogue",["Sorry, I don't remember the story at the moment",!1,{autoclose:!0,onClose:function(){return e(!0)}}],this)}return console.log(n),n&&this.addAction(n),e&&e(!1),n}}])&&l(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),c}(function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");Object.defineProperty(t,"prototype",{value:Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),writable:!1}),e&&c(t,e)}(f,t);var e,n,r,s=(n=f,r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,e=u(n);if(r){var o=u(this).constructor;t=Reflect.construct(e,arguments,o)}else t=e.apply(this,arguments);return a(this,t)});function f(t){var e;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,f),(e=s.call(this,t)).src=i.Z.artResourceUrl("earth-knight.gif"),e.portraitSrc=i.Z.artResourceUrl("earth_portrait.gif"),e.sheetSize=[128,256],e.tileSize=[24,32],e.drawOffset=new o.OW(-.25,1,.125),e.hotspotOffset=new o.OW(.5,.5,0),e.frames={up:[[0,0],[24,0],[48,0],[24,0]],right:[[0,32],[24,32],[48,32],[24,32]],down:[[0,64],[24,64],[48,64],[24,64]],left:[[0,96],[24,96],[48,96],[24,96]]},e.bindCamera=!1,e.enableSpeech=!0,e.state="intro",e}return e=f,Object.defineProperty(e,"prototype",{writable:!1}),e}(n(7772).Z))},4267:(t,e,n)=>{"use strict";n.r(e),n.d(e,{default:()=>d});var r=n(9337),o=n(8348),i=n(6185);function s(t){return s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},s(t)}function c(t,e){return c=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},c(t,e)}function a(t,e){if(e&&("object"===s(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function u(t){return u=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},u(t)}function f(t){return f="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},f(t)}function l(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function p(t,e){return p=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},p(t,e)}function h(t,e){if(e&&("object"===f(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function y(t){return y=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},y(t)}var d=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");Object.defineProperty(t,"prototype",{value:Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),writable:!1}),e&&p(t,e)}(c,t);var e,n,o,i,s=(o=c,i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,e=y(o);if(i){var n=y(this).constructor;t=Reflect.construct(e,arguments,n)}else t=e.apply(this,arguments);return h(this,t)});function c(t){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,c),s.call(this,t)}return e=c,(n=[{key:"interact",value:function(t,e){var n=null;switch(this.state){case"intro":this.state="loop",n=new r.aW(this.engine,"dialogue",["Welcome!",!1,{autoclose:!0,onClose:function(){return e(!0)}}],this);break;case"loop":this.state="loop2",n=new r.aW(this.engine,"dialogue",["I heard about a strange legend once.",!1,{autoclose:!0,onClose:function(){return e(!0)}}],this);break;case"loop2":this.state="loop",n=new r.aW(this.engine,"dialogue",["Sorry, I don't remember the story at the moment",!1,{autoclose:!0,onClose:function(){return e(!0)}}],this)}return console.log(n),n&&this.addAction(n),e&&e(!1),n}}])&&l(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),c}(function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");Object.defineProperty(t,"prototype",{value:Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),writable:!1}),e&&c(t,e)}(f,t);var e,n,r,s=(n=f,r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,e=u(n);if(r){var o=u(this).constructor;t=Reflect.construct(e,arguments,o)}else t=e.apply(this,arguments);return a(this,t)});function f(t){var e;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,f),(e=s.call(this,t)).src=i.Z.artResourceUrl("fire-knight.gif"),e.portraitSrc=i.Z.artResourceUrl("fire_portrait.gif"),e.sheetSize=[128,256],e.tileSize=[24,32],e.drawOffset=new o.OW(-.25,1,.125),e.hotspotOffset=new o.OW(.5,.5,0),e.frames={up:[[0,0],[24,0],[48,0],[24,0]],right:[[0,32],[24,32],[48,32],[24,32]],down:[[0,64],[24,64],[48,64],[24,64]],left:[[0,96],[24,96],[48,96],[24,96]]},e.bindCamera=!1,e.enableSpeech=!0,e.state="intro",e}return e=f,Object.defineProperty(e,"prototype",{writable:!1}),e}(n(7772).Z))},3886:(t,e,n)=>{"use strict";n.r(e),n.d(e,{default:()=>d});var r=n(9337),o=n(8348),i=n(6185);function s(t){return s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},s(t)}function c(t,e){return c=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},c(t,e)}function a(t,e){if(e&&("object"===s(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function u(t){return u=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},u(t)}function f(t){return f="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},f(t)}function l(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function p(t,e){return p=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},p(t,e)}function h(t,e){if(e&&("object"===f(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function y(t){return y=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},y(t)}var d=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");Object.defineProperty(t,"prototype",{value:Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),writable:!1}),e&&p(t,e)}(c,t);var e,n,o,i,s=(o=c,i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,e=y(o);if(i){var n=y(this).constructor;t=Reflect.construct(e,arguments,n)}else t=e.apply(this,arguments);return h(this,t)});function c(t){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,c),s.call(this,t)}return e=c,(n=[{key:"interact",value:function(t,e){var n=null;switch(this.state){case"intro":this.state="loop",n=new r.aW(this.engine,"dialogue",[["I am the Water Knight!","Here is my home.","yo"],!1,{autoclose:!1,onClose:function(){return e(!0)}}],this);break;case"loop":this.state="loop2",n=new r.aW(this.engine,"dialogue",["I heard about a strange legend once.",!1,{autoclose:!0,onClose:function(){return e(!0)}}],this);break;case"loop2":this.state="loop",n=new r.aW(this.engine,"dialogue",["Sorry, I don't remember the story at the moment",!1,{autoclose:!0,onClose:function(){return e(!0)}}],this)}return n&&this.addAction(n),e&&e(!1),n}}])&&l(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),c}(function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");Object.defineProperty(t,"prototype",{value:Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),writable:!1}),e&&c(t,e)}(f,t);var e,n,r,s=(n=f,r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,e=u(n);if(r){var o=u(this).constructor;t=Reflect.construct(e,arguments,o)}else t=e.apply(this,arguments);return a(this,t)});function f(t){var e;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,f),(e=s.call(this,t)).src=i.Z.artResourceUrl("water-knight.gif"),e.portraitSrc=i.Z.artResourceUrl("water_portrait.gif"),e.sheetSize=[128,256],e.tileSize=[24,32],e.drawOffset=new o.OW(-.25,1,.125),e.hotspotOffset=new o.OW(.5,.5,0),e.frames={up:[[0,0],[24,0],[48,0],[24,0]],right:[[0,32],[24,32],[48,32],[24,32]],down:[[0,64],[24,64],[48,64],[24,64]],left:[[0,96],[24,96],[48,96],[24,96]]},e.bindCamera=!1,e.enableSpeech=!0,e.state="intro",e}return e=f,Object.defineProperty(e,"prototype",{writable:!1}),e}(n(7772).Z))},4247:(t,e,n)=>{"use strict";n.r(e),n.d(e,{default:()=>h}),n(9337);var r=n(8348),o=n(6185);function i(t){return i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},i(t)}function s(t,e){return s=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},s(t,e)}function c(t,e){if(e&&("object"===i(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function a(t){return a=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},a(t)}function u(t){return u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},u(t)}function f(t,e){return f=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},f(t,e)}function l(t,e){if(e&&("object"===u(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function p(t){return p=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},p(t)}var h=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");Object.defineProperty(t,"prototype",{value:Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),writable:!1}),e&&f(t,e)}(i,t);var e,n,r,o=(n=i,r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,e=p(n);if(r){var o=p(this).constructor;t=Reflect.construct(e,arguments,o)}else t=e.apply(this,arguments);return l(this,t)});function i(t){var e;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,i),(e=o.call(this,t)).enableSpeech=!1,e.inventory=[],e}return e=i,Object.defineProperty(e,"prototype",{writable:!1}),e}(function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");Object.defineProperty(t,"prototype",{value:Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),writable:!1}),e&&s(t,e)}(f,t);var e,n,i,u=(n=f,i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,e=a(n);if(i){var r=a(this).constructor;t=Reflect.construct(e,arguments,r)}else t=e.apply(this,arguments);return c(this,t)});function f(t){var e;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,f),(e=u.call(this,t)).src=o.Z.artResourceUrl("chests.gif"),e.sheetSize=[256,256],e.tileSize=[16,24],e.drawOffset=new r.OW(0,1,.2),e.hotspotOffset=new r.OW(.5,.5,0),e.frames={down:[[48,0],[48,24],[48,48],[48,72]],right:[[112,0],[112,24],[112,48],[112,72]],up:[[48,96],[48,120],[48,144],[48,168]],left:[[176,0],[176,24],[176,48],[176,72]]},e.bindCamera=!1,e.enableSpeech=!0,e.state="closed",e.inventory=[],e}return e=f,Object.defineProperty(e,"prototype",{writable:!1}),e}(n(6595).Z))},2188:(t,e,n)=>{"use strict";n.r(e),n.d(e,{default:()=>h}),n(9337);var r=n(8348),o=n(6185);function i(t){return i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},i(t)}function s(t,e){return s=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},s(t,e)}function c(t,e){if(e&&("object"===i(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function a(t){return a=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},a(t)}function u(t){return u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},u(t)}function f(t,e){return f=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},f(t,e)}function l(t,e){if(e&&("object"===u(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function p(t){return p=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},p(t)}var h=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");Object.defineProperty(t,"prototype",{value:Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),writable:!1}),e&&f(t,e)}(i,t);var e,n,r,o=(n=i,r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,e=p(n);if(r){var o=p(this).constructor;t=Reflect.construct(e,arguments,o)}else t=e.apply(this,arguments);return l(this,t)});function i(t){var e;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,i),(e=o.call(this,t)).enableSpeech=!1,e.inventory=[],e}return e=i,Object.defineProperty(e,"prototype",{writable:!1}),e}(function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");Object.defineProperty(t,"prototype",{value:Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),writable:!1}),e&&s(t,e)}(f,t);var e,n,i,u=(n=f,i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,e=a(n);if(i){var r=a(this).constructor;t=Reflect.construct(e,arguments,r)}else t=e.apply(this,arguments);return c(this,t)});function f(t){var e;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,f),(e=u.call(this,t)).src=o.Z.artResourceUrl("chests.gif"),e.sheetSize=[256,256],e.tileSize=[16,24],e.drawOffset=new r.OW(0,1,.2),e.hotspotOffset=new r.OW(.5,.5,0),e.frames={down:[[16,0],[16,24],[16,48],[16,72]],right:[[80,0],[80,24],[80,48],[80,72]],up:[[16,96],[16,120],[16,144],[16,168]],left:[[144,0],[144,24],[144,48],[144,72]]},e.bindCamera=!1,e.enableSpeech=!0,e.state="closed",e.inventory=[],e}return e=f,Object.defineProperty(e,"prototype",{writable:!1}),e}(n(6595).Z))},3991:(t,e,n)=>{"use strict";n.r(e),n.d(e,{default:()=>h}),n(9337);var r=n(8348),o=n(6185);function i(t){return i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},i(t)}function s(t,e){return s=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},s(t,e)}function c(t,e){if(e&&("object"===i(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function a(t){return a=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},a(t)}function u(t){return u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},u(t)}function f(t,e){return f=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},f(t,e)}function l(t,e){if(e&&("object"===u(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function p(t){return p=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},p(t)}var h=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");Object.defineProperty(t,"prototype",{value:Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),writable:!1}),e&&f(t,e)}(i,t);var e,n,r,o=(n=i,r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,e=p(n);if(r){var o=p(this).constructor;t=Reflect.construct(e,arguments,o)}else t=e.apply(this,arguments);return l(this,t)});function i(t){var e;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,i),(e=o.call(this,t)).enableSpeech=!1,e.inventory=[],e}return e=i,Object.defineProperty(e,"prototype",{writable:!1}),e}(function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");Object.defineProperty(t,"prototype",{value:Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),writable:!1}),e&&s(t,e)}(f,t);var e,n,i,u=(n=f,i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,e=a(n);if(i){var r=a(this).constructor;t=Reflect.construct(e,arguments,r)}else t=e.apply(this,arguments);return c(this,t)});function f(t){var e;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,f),(e=u.call(this,t)).src=o.Z.artResourceUrl("chests.gif"),e.sheetSize=[256,256],e.tileSize=[16,24],e.drawOffset=new r.OW(0,1,.2),e.hotspotOffset=new r.OW(.5,.5,0),e.frames={down:[[32,0],[32,24],[32,48],[32,72]],right:[[96,0],[96,24],[96,48],[96,72]],up:[[32,96],[32,120],[32,144],[32,168]],left:[[160,0],[160,24],[160,48],[160,72]]},e.bindCamera=!1,e.enableSpeech=!0,e.state="closed",e.inventory=[],e}return e=f,Object.defineProperty(e,"prototype",{writable:!1}),e}(n(6595).Z))},4475:(t,e,n)=>{"use strict";n.r(e),n.d(e,{default:()=>h}),n(9337);var r=n(8348),o=n(6185);function i(t){return i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},i(t)}function s(t,e){return s=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},s(t,e)}function c(t,e){if(e&&("object"===i(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function a(t){return a=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},a(t)}function u(t){return u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},u(t)}function f(t,e){return f=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},f(t,e)}function l(t,e){if(e&&("object"===u(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function p(t){return p=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},p(t)}var h=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");Object.defineProperty(t,"prototype",{value:Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),writable:!1}),e&&f(t,e)}(i,t);var e,n,r,o=(n=i,r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,e=p(n);if(r){var o=p(this).constructor;t=Reflect.construct(e,arguments,o)}else t=e.apply(this,arguments);return l(this,t)});function i(t){var e;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,i),(e=o.call(this,t)).enableSpeech=!1,e.inventory=[{id:"sword",type:"object"}],e}return e=i,Object.defineProperty(e,"prototype",{writable:!1}),e}(function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");Object.defineProperty(t,"prototype",{value:Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),writable:!1}),e&&s(t,e)}(f,t);var e,n,i,u=(n=f,i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,e=a(n);if(i){var r=a(this).constructor;t=Reflect.construct(e,arguments,r)}else t=e.apply(this,arguments);return c(this,t)});function f(t){var e;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,f),(e=u.call(this,t)).src=o.Z.artResourceUrl("chests.gif"),e.sheetSize=[256,256],e.tileSize=[16,24],e.drawOffset=new r.OW(0,1,.2),e.hotspotOffset=new r.OW(.5,.5,0),e.frames={down:[[0,0],[0,24],[0,48],[0,72]],right:[[64,0],[64,24],[64,48],[64,72]],up:[[0,96],[0,120],[0,144],[0,168]],left:[[128,0],[128,24],[128,48],[128,72]]},e.bindCamera=!1,e.enableSpeech=!0,e.state="closed",e.inventory=[],e}return e=f,Object.defineProperty(e,"prototype",{writable:!1}),e}(n(6595).Z))},1262:(t,e,n)=>{"use strict";n.d(e,{Z:()=>r});const r={FLOOR:["FLAT_ALL","FLOOR",0],WATER:["FLAT_NONE","WATER",-1.5],EMPTY:["FLAT_ALL","EMPTY",2],N_STAIR:["FLAT_ALL","FLOOR_V",-1,"WALL_R","WATER_WALL",-1,"WALL_L","WATER_WALL",-1,"STAIR_T","STAIR",-1],N_STAIRWALL:["FLAT_ALL","FLOOR_B",0,"WALL_T","WALL_WATER",0,15],S_STAIR:["FLAT_ALL","FLOOR_V",-1,"WALL_R","WATER_WALL",-1,"WALL_L","WATER_WALL",-1,"STAIR_B","STAIR",-1],S_STAIRWALL:["FLAT_ALL","FLOOR_T",0,"WALL_B","WALL",0,15],L_STAIR:["FLAT_ALL","FLOOR_H",-1,"WALL_T","WATER_WALL",-1,"WALL_B","WATER_WALL",-1,"STAIR_L","STAIR",-1],L_STAIRWALL:["FLAT_ALL","FLOOR_R",0,"WALL_L","WALL_WATER",0,15],R_STAIR:["FLAT_ALL","FLOOR_H",-1,"WALL_T","WATER_WALL",-1,"WALL_B","WATER_WALL",-1,"STAIR_R","STAIR",-1],R_STAIRWALL:["FLAT_ALL","FLOOR_L",0,"WALL_R","WALL_WATER",0,15],N_WALL:["WALL_T","WALL",2,"FLAT_ALL","EMPTY_B",2],S_WALL:["WALL_B","WALL",2,"FLAT_ALL","EMPTY_T",2],L_WALL:["WALL_L","WALL",2,"FLAT_ALL","EMPTY_R",2],R_WALL:["WALL_R","WALL",2,"FLAT_ALL","EMPTY_L",2],NLW_CORNER:["FLAT_ALL","EMPTY_CTL",2],NRW_CORNER:["FLAT_ALL","EMPTY_CTR",2],SLW_CORNER:["FLAT_ALL","EMPTY_CBL",2],SRW_CORNER:["FLAT_ALL","EMPTY_CBR",2],NLW_COLUMN:["WALL_T","WALL",2,"WALL_L","WALL",2,"FLAT_NONE","EMPTY_BR",2],NRW_COLUMN:["WALL_R","WALL",2,"WALL_T","WALL",2,"FLAT_NONE","EMPTY_BL",2],SLW_COLUMN:["WALL_L","WALL",2,"WALL_B","WALL",2,"FLAT_NONE","EMPTY_TR",2],SRW_COLUMN:["WALL_R","WALL",2,"WALL_B","WALL",2,"FLAT_NONE","EMPTY_TL",2],NRW_WATER_COLUMN:["WALL_R","WALL",2,"WALL_R","WALL_WATER",0,"WALL_T","WALL",2,"WALL_T","WALL_WATER",0,"FLAT_ALL","EMPTY_BL",2],NLW_WATER_COLUMN:["WALL_T","WALL",2,"WALL_L","WALL",2,"FLAT_ALL","EMPTY_BR",2,"WALL_L","WALL_WATER",0,"WALL_T","WALL_WATER",0],SLW_WATER_COLUMN:["WALL_L","WALL",2,"WALL_B","WALL",2,"FLAT_ALL","EMPTY_TR",2,"WALL_L","WALL_WATER",0,"WALL_B","WALL_WATER",0],SRW_WATER_COLUMN:["WALL_R","WALL",2,"WALL_R","WALL_WATER",0,"WALL_B","WALL",2,"WALL_B","WALL_WATER",0,"FLAT_ALL","EMPTY_TL",2],NW_NPIT:["FLAT_ALL","FLOOR_B",0,"WALL_T","WALL_WATER",0],LW_LPIT:["FLAT_ALL","FLOOR_R",0,"WALL_L","WALL_WATER",0],RW_RPIT:["FLAT_ALL","FLOOR_L",0,"WALL_R","WALL_WATER",0],SW_SPIT:["FLAT_ALL","FLOOR_T",0,"WALL_B","WALL_WATER",0],C_WALKWAY:["FLAT_ALL","FLOOR_C",-1],V_WALKWAY:["FLAT_ALL","FLOOR_V",-1,"WALL_R","WATER_WALL",-1,"WALL_L","WATER_WALL",-1],H_WALKWAY:["FLAT_ALL","FLOOR_H",-1,"WALL_T","WATER_WALL",-1,"WALL_B","WATER_WALL",-1]}},3507:(t,e,n)=>{"use strict";n.r(e),n.d(e,{default:()=>r});const r={src:n(6185).Z.artResourceUrl("sewer.gif"),sheetSize:[256,256],tileSize:16,bgColor:[31,20,29],textures:{FLOOR:[1,1],FLOOR_BR:[2,2],FLOOR_R:[2,1],FLOOR_TR:[2,0],FLOOR_T:[1,0],FLOOR_TL:[0,0],FLOOR_L:[0,1],FLOOR_BL:[0,2],FLOOR_B:[1,2],FLOOR_CBR:[4,1],FLOOR_CTR:[4,0],FLOOR_CTL:[3,0],FLOOR_CBL:[3,1],FLOOR_V:[3,2],WATER:[.5,7.5],FLOOR_H:[4,2],FLOOR_C:[3,3],EMPTY:[6,1],EMPTY_BR:[7,2],EMPTY_R:[7,1],EMPTY_TR:[7,0],EMPTY_T:[6,0],EMPTY_TL:[5,0],EMPTY_L:[5,1],EMPTY_BL:[5,2],EMPTY_B:[6,2],EMPTY_CBR:[9,1],EMPTY_CTR:[9,0],EMPTY_CTL:[8,0],EMPTY_CBL:[8,1],STAIR:[5,3],WALL:[0,3],WALL_WATER:[0,5],WATER_WALL:[0,6]},geometry:{FLAT_ALL:{vertices:[[[0,1,0],[1,1,0],[1,0,0]],[[0,1,0],[1,0,0],[0,0,0]]],surfaces:[[[0,1],[1,1],[1,0]],[[0,1],[1,0],[0,0]]],type:parseInt("1111",2)},FLAT_NONE:{vertices:[[[0,1,0],[1,1,0],[1,0,0]],[[0,1,0],[1,0,0],[0,0,0]]],surfaces:[[[0,1],[1,1],[1,0]],[[0,1],[1,0],[0,0]]],type:parseInt("0000",2)},STAIR_R:{vertices:[[[.25,0,.25],[.25,1,.25],[.5,1,.25]],[[.25,0,.25],[.5,1,.25],[.5,0,.25]],[[.5,0,.5],[.5,1,.5],[.75,1,.5]],[[.5,0,.5],[.75,1,.5],[.75,0,.5]],[[.75,0,.75],[.75,1,.75],[1,1,.75]],[[.75,0,.75],[1,1,.75],[1,0,.75]],[[.25,0,0],[.25,1,0],[.25,1,.25]],[[.25,0,0],[.25,1,.25],[.25,0,.25]],[[.5,0,.25],[.5,1,.25],[.5,1,.5]],[[.5,0,.25],[.5,1,.5],[.5,0,.5]],[[.75,0,.5],[.75,1,.5],[.75,1,.75]],[[.75,0,.5],[.75,1,.75],[.75,0,.75]],[[1,0,.75],[1,1,.75],[1,1,1]],[[1,0,.75],[1,1,1],[1,0,1]],[[0,0,0],[1,0,0],[1,0,1]],[[0,0,0],[1,0,1],[0,0,1]],[[0,1,0],[1,1,0],[1,1,1]],[[0,1,0],[1,1,1],[0,1,1]]],surfaces:[[[0,.75],[1,.75],[1,.5]],[[0,.75],[1,.5],[0,.5]],[[0,.5],[1,.5],[1,.25]],[[0,.5],[1,.25],[0,.25]],[[0,.25],[1,.25],[1,0]],[[0,.25],[1,0],[0,0]],[[0,2],[1,2],[1,1.75]],[[0,2],[1,1.75],[0,1.75]],[[0,1.75],[1,1.75],[1,1.5]],[[0,1.75],[1,1.5],[0,1.5]],[[0,1.5],[1,1.5],[1,1.25]],[[0,1.5],[1,1.25],[0,1.25]],[[0,1.25],[1,1.25],[1,1]],[[0,1.25],[1,1],[0,1]],[[0,3],[1,3],[1,2]],[[0,3],[1,2],[0,2]],[[0,3],[1,3],[1,2]],[[0,3],[1,2],[0,2]]],walkPoly:[[[0,1,0],[1,1,1],[1,0,1]],[[0,1,0],[1,0,1],[0,0,0]]],type:parseInt("0101",2)},STAIR_T:{vertices:[[[0,.75,.25],[1,.75,.25],[1,.5,.25]],[[0,.75,.25],[1,.5,.25],[0,.5,.25]],[[0,.5,.5],[1,.5,.5],[1,.25,.5]],[[0,.5,.5],[1,.25,.5],[0,.25,.5]],[[0,.25,.75],[1,.25,.75],[1,0,.75]],[[0,.25,.75],[1,0,.75],[0,0,.75]],[[0,.75,0],[1,.75,0],[1,.75,.25]],[[0,.75,0],[1,.75,.25],[0,.75,.25]],[[0,.5,.25],[1,.5,.25],[1,.5,.5]],[[0,.5,.25],[1,.5,.5],[0,.5,.5]],[[0,.25,.5],[1,.25,.5],[1,.25,.75]],[[0,.25,.5],[1,.25,.75],[0,.25,.75]],[[0,0,.75],[1,0,.75],[1,0,1]],[[0,0,.75],[1,0,1],[0,0,1]],[[0,1,0],[0,0,0],[0,0,1]],[[0,1,0],[0,0,1],[0,1,1]],[[1,1,0],[1,0,0],[1,0,1]],[[1,1,0],[1,0,1],[1,1,1]]],surfaces:[[[0,.75],[1,.75],[1,.5]],[[0,.75],[1,.5],[0,.5]],[[0,.5],[1,.5],[1,.25]],[[0,.5],[1,.25],[0,.25]],[[0,.25],[1,.25],[1,0]],[[0,.25],[1,0],[0,0]],[[0,2],[1,2],[1,1.75]],[[0,2],[1,1.75],[0,1.75]],[[0,1.75],[1,1.75],[1,1.5]],[[0,1.75],[1,1.5],[0,1.5]],[[0,1.5],[1,1.5],[1,1.25]],[[0,1.5],[1,1.25],[0,1.25]],[[0,1.25],[1,1.25],[1,1]],[[0,1.25],[1,1],[0,1]],[[0,3],[1,3],[1,2]],[[0,3],[1,2],[0,2]],[[0,3],[1,3],[1,2]],[[0,3],[1,2],[0,2]]],walkPoly:[[[0,1,0],[1,1,0],[1,0,1]],[[0,1,0],[1,0,1],[0,0,1]]],type:parseInt("1010",2)},STAIR_L:{vertices:[[[.75,1,.25],[.75,0,.25],[.5,0,.25]],[[.75,1,.25],[.5,0,.25],[.5,1,.25]],[[.5,1,.5],[.5,0,.5],[.25,0,.5]],[[.5,1,.5],[.25,0,.5],[.25,1,.5]],[[.25,1,.75],[.25,0,.75],[0,0,.75]],[[.25,1,.75],[0,0,.75],[0,1,.75]],[[.75,1,0],[.75,0,0],[.75,0,.25]],[[.75,1,0],[.75,0,.25],[.75,1,.25]],[[.5,1,.25],[.5,0,.25],[.5,0,.5]],[[.5,1,.25],[.5,0,.5],[.5,1,.5]],[[.25,1,.5],[.25,0,.5],[.25,0,.75]],[[.25,1,.5],[.25,0,.75],[.25,1,.75]],[[0,1,.75],[0,0,.75],[0,0,1]],[[0,1,.75],[0,0,1],[0,1,1]],[[1,1,0],[0,1,0],[0,1,1]],[[1,1,0],[0,1,1],[1,1,1]],[[1,0,0],[0,0,0],[0,0,1]],[[1,0,0],[0,0,1],[1,0,1]]],surfaces:[[[0,.75],[1,.75],[1,.5]],[[0,.75],[1,.5],[0,.5]],[[0,.5],[1,.5],[1,.25]],[[0,.5],[1,.25],[0,.25]],[[0,.25],[1,.25],[1,0]],[[0,.25],[1,0],[0,0]],[[0,2],[1,2],[1,1.75]],[[0,2],[1,1.75],[0,1.75]],[[0,1.75],[1,1.75],[1,1.5]],[[0,1.75],[1,1.5],[0,1.5]],[[0,1.5],[1,1.5],[1,1.25]],[[0,1.5],[1,1.25],[0,1.25]],[[0,1.25],[1,1.25],[1,1]],[[0,1.25],[1,1],[0,1]],[[0,3],[1,3],[1,2]],[[0,3],[1,2],[0,2]],[[0,3],[1,3],[1,2]],[[0,3],[1,2],[0,2]]],walkPoly:[[[0,1,1],[1,1,0],[1,0,0]],[[0,1,1],[1,0,0],[0,0,1]]],type:parseInt("0101",2)},STAIR_B:{vertices:[[[1,.25,.25],[0,.25,.25],[0,.5,.25]],[[1,.25,.25],[0,.5,.25],[1,.5,.25]],[[1,.5,.5],[0,.5,.5],[0,.75,.5]],[[1,.5,.5],[0,.75,.5],[1,.75,.5]],[[1,.75,.75],[0,.75,.75],[0,1,.75]],[[1,.75,.75],[0,1,.75],[1,1,.75]],[[1,.25,0],[0,.25,0],[0,.25,.25]],[[1,.25,0],[0,.25,.25],[1,.25,.25]],[[1,.5,.25],[0,.5,.25],[0,.5,.5]],[[1,.5,.25],[0,.5,.5],[1,.5,.5]],[[1,.75,.5],[0,.75,.5],[0,.75,.75]],[[1,.75,.5],[0,.75,.75],[1,.75,.75]],[[1,1,.75],[0,1,.75],[0,1,1]],[[1,1,.75],[0,1,1],[1,1,1]],[[1,0,0],[1,1,0],[1,1,1]],[[1,0,0],[1,1,1],[1,0,1]],[[0,0,0],[0,1,0],[0,1,1]],[[0,0,0],[0,1,1],[0,0,1]]],surfaces:[[[0,.75],[1,.75],[1,.5]],[[0,.75],[1,.5],[0,.5]],[[0,.5],[1,.5],[1,.25]],[[0,.5],[1,.25],[0,.25]],[[0,.25],[1,.25],[1,0]],[[0,.25],[1,0],[0,0]],[[0,2],[1,2],[1,1.75]],[[0,2],[1,1.75],[0,1.75]],[[0,1.75],[1,1.75],[1,1.5]],[[0,1.75],[1,1.5],[0,1.5]],[[0,1.5],[1,1.5],[1,1.25]],[[0,1.5],[1,1.25],[0,1.25]],[[0,1.25],[1,1.25],[1,1]],[[0,1.25],[1,1],[0,1]],[[0,3],[1,3],[1,2]],[[0,3],[1,2],[0,2]],[[0,3],[1,3],[1,2]],[[0,3],[1,2],[0,2]]],walkPoly:[[[0,1,1],[1,1,1],[1,0,0]],[[0,1,1],[1,0,0],[0,0,0]]],type:parseInt("1010",2)},WALL_R:{vertices:[[[0,0,-2],[0,1,-2],[0,1,0]],[[0,0,-2],[0,1,0],[0,0,0]]],surfaces:[[[0,2],[1,2],[1,0]],[[0,2],[1,0],[0,0]]],type:parseInt("1011",2)},WALL_T:{vertices:[[[0,1,-2],[1,1,-2],[1,1,0]],[[0,1,-2],[1,1,0],[0,1,0]]],surfaces:[[[0,2],[1,2],[1,0]],[[0,2],[1,0],[0,0]]],type:parseInt("0111",2)},WALL_L:{vertices:[[[1,1,-2],[1,0,-2],[1,0,0]],[[1,1,-2],[1,0,0],[1,1,0]]],surfaces:[[[0,2],[1,2],[1,0]],[[0,2],[1,0],[0,0]]],type:parseInt("1110",2)},WALL_B:{vertices:[[[1,0,-2],[0,0,-2],[0,0,0]],[[1,0,-2],[0,0,0],[1,0,0]]],surfaces:[[[0,2],[1,2],[1,0]],[[0,2],[1,0],[0,0]]],type:parseInt("1101",2)}}}},4913:(t,e,n)=>{"use strict";n.d(e,{Z:()=>c});var r=n(7537),o=n.n(r),i=n(3645),s=n.n(i)()(o());s.push([t.id,"/*                                                 *** ----------------------------------------------- **\n**             Calliope - Site Generator   \t       **\n** ----------------------------------------------- **\n**  Copyright (c) 2020-2021 - Kyle Derby MacInnis  **\n**                                                 **\n**    Any unauthorized distribution or transfer    **\n**       of this work is strictly prohibited.      **\n**                                                 **\n**               All Rights Reserved.              **\n** ----------------------------------------------- **\n\\*                                                 */\n.pixos {\n    font-family: Arial, Helvetica, sans-serif;\n    font-size: 16px;\n    width: 100%;\n    text-shadow: #3f3f3f 2px 2px 0px;\n    position: relative;\n    padding: 2.5em;\n    align-items: center;\n    align-content: center; }\n  \n  .renderSurface {\n    height: 100%;\n    left: 0;\n    position: absolute;\n    top: 0;\n    width: 100%; }\n  \n  .materialSelector {\n    background: rgba(0, 0, 0, 0.6);\n    margin: auto;\n    position: relative; }\n    .materialSelector tr {\n      height: 70px; }\n    .materialSelector td {\n      background-position: 0px 0px;\n      cursor: pointer;\n      margin: 0;\n      opacity: 0.3;\n      padding: 0;\n      width: 70px; }\n      .materialSelector td:hover {\n        opacity: 0.8; }\n  \n  .nickname {\n    color: #ffffff;\n    cursor: default;\n    left: 42%;\n    position: absolute;\n    top: 40%;\n    width: 300px; }\n    .nickname input {\n      background: none;\n      border-bottom: 1px solid #888888;\n      border: none;\n      color: white;\n      font-family: Arial, Helvetica, sans-serif;\n      font-size: 24px;\n      outline: none;\n      width: 100%; }\n  \n  .joininfo {\n    color: #ffffff;\n    cursor: default;\n    font-size: 24px;\n    position: absolute;\n    text-align: center;\n    top: 42%;\n    width: 99%; }\n  \n  .chatbox {\n    background: rgba(0, 0, 0, 0.6);\n    bottom: 55px;\n    color: white;\n    cursor: default;\n    height: 195px;\n    left: 20px;\n    overflow: hidden;\n    padding-left: 10px;\n    padding-right: 10px;\n    position: absolute;\n    width: 600px; }\n  \n  .chatbox_text {\n    bottom: 8px;\n    position: absolute;\n    text-shadow: none; }\n  \n  .chatbox_entry {\n    background: rgba(0, 0, 0, 0.6);\n    border: none;\n    bottom: 18px;\n    color: white;\n    font-family: Arial, Helvetica, sans-serif;\n    font-size: 16px;\n    height: 30px;\n    left: 20px;\n    outline: none;\n    padding-bottom: 2px;\n    padding-left: 10px;\n    position: absolute;\n    width: 610px; }\n  ","",{version:3,sources:["webpack://./pixos/less/pixos.css"],names:[],mappings:"AAAA;;;;;;;;;;oDAUoD;AACpD;IACI,yCAAyC;IACzC,eAAe;IACf,WAAW;IACX,gCAAgC;IAChC,kBAAkB;IAClB,cAAc;IACd,mBAAmB;IACnB,qBAAqB,EAAE;;EAEzB;IACE,YAAY;IACZ,OAAO;IACP,kBAAkB;IAClB,MAAM;IACN,WAAW,EAAE;;EAEf;IACE,8BAA8B;IAC9B,YAAY;IACZ,kBAAkB,EAAE;IACpB;MACE,YAAY,EAAE;IAChB;MACE,4BAA4B;MAC5B,eAAe;MACf,SAAS;MACT,YAAY;MACZ,UAAU;MACV,WAAW,EAAE;MACb;QACE,YAAY,EAAE;;EAEpB;IACE,cAAc;IACd,eAAe;IACf,SAAS;IACT,kBAAkB;IAClB,QAAQ;IACR,YAAY,EAAE;IACd;MACE,gBAAgB;MAChB,gCAAgC;MAChC,YAAY;MACZ,YAAY;MACZ,yCAAyC;MACzC,eAAe;MACf,aAAa;MACb,WAAW,EAAE;;EAEjB;IACE,cAAc;IACd,eAAe;IACf,eAAe;IACf,kBAAkB;IAClB,kBAAkB;IAClB,QAAQ;IACR,UAAU,EAAE;;EAEd;IACE,8BAA8B;IAC9B,YAAY;IACZ,YAAY;IACZ,eAAe;IACf,aAAa;IACb,UAAU;IACV,gBAAgB;IAChB,kBAAkB;IAClB,mBAAmB;IACnB,kBAAkB;IAClB,YAAY,EAAE;;EAEhB;IACE,WAAW;IACX,kBAAkB;IAClB,iBAAiB,EAAE;;EAErB;IACE,8BAA8B;IAC9B,YAAY;IACZ,YAAY;IACZ,YAAY;IACZ,yCAAyC;IACzC,eAAe;IACf,YAAY;IACZ,UAAU;IACV,aAAa;IACb,mBAAmB;IACnB,kBAAkB;IAClB,kBAAkB;IAClB,YAAY,EAAE",sourcesContent:["/*                                                 *** ----------------------------------------------- **\n**             Calliope - Site Generator   \t       **\n** ----------------------------------------------- **\n**  Copyright (c) 2020-2021 - Kyle Derby MacInnis  **\n**                                                 **\n**    Any unauthorized distribution or transfer    **\n**       of this work is strictly prohibited.      **\n**                                                 **\n**               All Rights Reserved.              **\n** ----------------------------------------------- **\n\\*                                                 */\n.pixos {\n    font-family: Arial, Helvetica, sans-serif;\n    font-size: 16px;\n    width: 100%;\n    text-shadow: #3f3f3f 2px 2px 0px;\n    position: relative;\n    padding: 2.5em;\n    align-items: center;\n    align-content: center; }\n  \n  .renderSurface {\n    height: 100%;\n    left: 0;\n    position: absolute;\n    top: 0;\n    width: 100%; }\n  \n  .materialSelector {\n    background: rgba(0, 0, 0, 0.6);\n    margin: auto;\n    position: relative; }\n    .materialSelector tr {\n      height: 70px; }\n    .materialSelector td {\n      background-position: 0px 0px;\n      cursor: pointer;\n      margin: 0;\n      opacity: 0.3;\n      padding: 0;\n      width: 70px; }\n      .materialSelector td:hover {\n        opacity: 0.8; }\n  \n  .nickname {\n    color: #ffffff;\n    cursor: default;\n    left: 42%;\n    position: absolute;\n    top: 40%;\n    width: 300px; }\n    .nickname input {\n      background: none;\n      border-bottom: 1px solid #888888;\n      border: none;\n      color: white;\n      font-family: Arial, Helvetica, sans-serif;\n      font-size: 24px;\n      outline: none;\n      width: 100%; }\n  \n  .joininfo {\n    color: #ffffff;\n    cursor: default;\n    font-size: 24px;\n    position: absolute;\n    text-align: center;\n    top: 42%;\n    width: 99%; }\n  \n  .chatbox {\n    background: rgba(0, 0, 0, 0.6);\n    bottom: 55px;\n    color: white;\n    cursor: default;\n    height: 195px;\n    left: 20px;\n    overflow: hidden;\n    padding-left: 10px;\n    padding-right: 10px;\n    position: absolute;\n    width: 600px; }\n  \n  .chatbox_text {\n    bottom: 8px;\n    position: absolute;\n    text-shadow: none; }\n  \n  .chatbox_entry {\n    background: rgba(0, 0, 0, 0.6);\n    border: none;\n    bottom: 18px;\n    color: white;\n    font-family: Arial, Helvetica, sans-serif;\n    font-size: 16px;\n    height: 30px;\n    left: 20px;\n    outline: none;\n    padding-bottom: 2px;\n    padding-left: 10px;\n    position: absolute;\n    width: 610px; }\n  "],sourceRoot:""}]);const c=s},3645:t=>{"use strict";t.exports=function(t){var e=[];return e.toString=function(){return this.map((function(e){var n="",r=void 0!==e[5];return e[4]&&(n+="@supports (".concat(e[4],") {")),e[2]&&(n+="@media ".concat(e[2]," {")),r&&(n+="@layer".concat(e[5].length>0?" ".concat(e[5]):""," {")),n+=t(e),r&&(n+="}"),e[2]&&(n+="}"),e[4]&&(n+="}"),n})).join("")},e.i=function(t,n,r,o,i){"string"==typeof t&&(t=[[null,t,void 0]]);var s={};if(r)for(var c=0;c<this.length;c++){var a=this[c][0];null!=a&&(s[a]=!0)}for(var u=0;u<t.length;u++){var f=[].concat(t[u]);r&&s[f[0]]||(void 0!==i&&(void 0===f[5]||(f[1]="@layer".concat(f[5].length>0?" ".concat(f[5]):""," {").concat(f[1],"}")),f[5]=i),n&&(f[2]?(f[1]="@media ".concat(f[2]," {").concat(f[1],"}"),f[2]=n):f[2]=n),o&&(f[4]?(f[1]="@supports (".concat(f[4],") {").concat(f[1],"}"),f[4]=o):f[4]="".concat(o)),e.push(f))}},e}},7537:t=>{"use strict";t.exports=function(t){var e=t[1],n=t[3];if(!n)return e;if("function"==typeof btoa){var r=btoa(unescape(encodeURIComponent(JSON.stringify(n)))),o="sourceMappingURL=data:application/json;charset=utf-8;base64,".concat(r),i="/*# ".concat(o," */"),s=n.sources.map((function(t){return"/*# sourceURL=".concat(n.sourceRoot||"").concat(t," */")}));return[e].concat(s).concat([i]).join("\n")}return[e].join("\n")}},8679:(t,e,n)=>{"use strict";var r=n(9864),o={childContextTypes:!0,contextType:!0,contextTypes:!0,defaultProps:!0,displayName:!0,getDefaultProps:!0,getDerivedStateFromError:!0,getDerivedStateFromProps:!0,mixins:!0,propTypes:!0,type:!0},i={name:!0,length:!0,prototype:!0,caller:!0,callee:!0,arguments:!0,arity:!0},s={$$typeof:!0,compare:!0,defaultProps:!0,displayName:!0,propTypes:!0,type:!0},c={};function a(t){return r.isMemo(t)?s:c[t.$$typeof]||o}c[r.ForwardRef]={$$typeof:!0,render:!0,defaultProps:!0,displayName:!0,propTypes:!0},c[r.Memo]=s;var u=Object.defineProperty,f=Object.getOwnPropertyNames,l=Object.getOwnPropertySymbols,p=Object.getOwnPropertyDescriptor,h=Object.getPrototypeOf,y=Object.prototype;t.exports=function t(e,n,r){if("string"!=typeof n){if(y){var o=h(n);o&&o!==y&&t(e,o,r)}var s=f(n);l&&(s=s.concat(l(n)));for(var c=a(e),d=a(n),b=0;b<s.length;++b){var v=s[b];if(!(i[v]||r&&r[v]||d&&d[v]||c&&c[v])){var m=p(n,v);try{u(e,v,m)}catch(t){}}}}return e}},2703:(t,e,n)=>{"use strict";var r=n(414);function o(){}function i(){}i.resetWarningCache=o,t.exports=function(){function t(t,e,n,o,i,s){if(s!==r){var c=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw c.name="Invariant Violation",c}}function e(){return t}t.isRequired=t;var n={array:t,bool:t,func:t,number:t,object:t,string:t,symbol:t,any:t,arrayOf:e,element:t,elementType:t,instanceOf:e,node:t,objectOf:e,oneOf:e,oneOfType:e,shape:e,exact:e,checkPropTypes:i,resetWarningCache:o};return n.PropTypes=n,n}},5697:(t,e,n)=>{t.exports=n(2703)()},414:t=>{"use strict";t.exports="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED"},9921:(t,e)=>{"use strict";var n="function"==typeof Symbol&&Symbol.for,r=n?Symbol.for("react.element"):60103,o=n?Symbol.for("react.portal"):60106,i=n?Symbol.for("react.fragment"):60107,s=n?Symbol.for("react.strict_mode"):60108,c=n?Symbol.for("react.profiler"):60114,a=n?Symbol.for("react.provider"):60109,u=n?Symbol.for("react.context"):60110,f=n?Symbol.for("react.async_mode"):60111,l=n?Symbol.for("react.concurrent_mode"):60111,p=n?Symbol.for("react.forward_ref"):60112,h=n?Symbol.for("react.suspense"):60113,y=n?Symbol.for("react.suspense_list"):60120,d=n?Symbol.for("react.memo"):60115,b=n?Symbol.for("react.lazy"):60116,v=n?Symbol.for("react.block"):60121,m=n?Symbol.for("react.fundamental"):60117,O=n?Symbol.for("react.responder"):60118,g=n?Symbol.for("react.scope"):60119;function w(t){if("object"==typeof t&&null!==t){var e=t.$$typeof;switch(e){case r:switch(t=t.type){case f:case l:case i:case c:case s:case h:return t;default:switch(t=t&&t.$$typeof){case u:case p:case b:case d:case a:return t;default:return e}}case o:return e}}}function L(t){return w(t)===l}e.AsyncMode=f,e.ConcurrentMode=l,e.ContextConsumer=u,e.ContextProvider=a,e.Element=r,e.ForwardRef=p,e.Fragment=i,e.Lazy=b,e.Memo=d,e.Portal=o,e.Profiler=c,e.StrictMode=s,e.Suspense=h,e.isAsyncMode=function(t){return L(t)||w(t)===f},e.isConcurrentMode=L,e.isContextConsumer=function(t){return w(t)===u},e.isContextProvider=function(t){return w(t)===a},e.isElement=function(t){return"object"==typeof t&&null!==t&&t.$$typeof===r},e.isForwardRef=function(t){return w(t)===p},e.isFragment=function(t){return w(t)===i},e.isLazy=function(t){return w(t)===b},e.isMemo=function(t){return w(t)===d},e.isPortal=function(t){return w(t)===o},e.isProfiler=function(t){return w(t)===c},e.isStrictMode=function(t){return w(t)===s},e.isSuspense=function(t){return w(t)===h},e.isValidElementType=function(t){return"string"==typeof t||"function"==typeof t||t===i||t===l||t===c||t===s||t===h||t===y||"object"==typeof t&&null!==t&&(t.$$typeof===b||t.$$typeof===d||t.$$typeof===a||t.$$typeof===u||t.$$typeof===p||t.$$typeof===m||t.$$typeof===O||t.$$typeof===g||t.$$typeof===v)},e.typeOf=w},9864:(t,e,n)=>{"use strict";t.exports=n(9921)},6626:(t,e,n)=>{"use strict";n.d(e,{collect:()=>X});const r={currentComponent:null,isBatchUpdating:!1,isInBrowser:"undefined"!=typeof window,listeners:new Map,manualListeners:[],nextVersionMap:new WeakMap,proxyIsMuted:!1,redirectToNext:!0,store:{}},o=Symbol("PATH"),i=Symbol("ORIGINAL"),s="RR_DEBUG",c=t=>!!t&&"object"==typeof t&&t.constructor===Object,a=t=>Array.isArray(t),u=t=>t instanceof Map,f=t=>t instanceof Set,l=t=>c(t)||a(t)||u(t)||f(t),p=t=>t===o||"constructor"===t||"toJSON"===t||"@@toStringTag"===t||t===Symbol.toStringTag,h=t=>"function"==typeof t,y=t=>c(t)?Object.assign({},t):a(t)?t.slice():u(t)?new Map(t):f(t)?new Set(t):t,d=(t,e)=>u(t)?t.get(e):f(t)?e:(a(t),t[e]),b=(t,e,n)=>{if(c(t))t[e]=n;else if(a(t))t[e]=n;else if(u(t))t.set(e,n);else{if(!f(t))throw Error("Unexpected type");t.add(n)}},v=t=>{if(c(t))return Object.keys(t).length;if(a(t))return t.length;if(u(t)||f(t))return t.size;throw Error("Unexpected type")},m=(t,e)=>{const n=[],r=t=>{const o=e(t,n.slice()),i=void 0!==o?o:t,s=(t,e)=>{n.push(t);const o=r(e);n.pop(),b(i,t,o)};if(c(i))Object.entries(i).forEach((([t,e])=>{s(t,e)}));else if(a(i)||u(i))i.forEach(((t,e)=>{s(e,t)}));else if(f(i)){const t=Array.from(i);i.clear(),t.forEach((t=>{s(t,t)}))}return i};return r(t)},O=t=>{r.proxyIsMuted=!0;const e=t();return r.proxyIsMuted=!1,e},g=(t,e)=>t.map((t=>t.toString())).join(e),w=t=>g(t,"."),L=t=>g(t,"~~~"),R=(t,e)=>{const n=t[o]||[];return void 0===e?n:n.concat(e)},A=(t,e)=>w(R(t,e)),T=(t,e)=>{t&&Object.defineProperty(t,o,{value:e,writable:!0})},_=t=>t[o]||[],P="undefined"!=typeof window&&!!window.localStorage,E=(t,e)=>{if(P)try{const n="string"==typeof e?e:JSON.stringify(e);return localStorage.setItem(t,n)}catch(t){return}},Z="on",x="off";let S=(t=>{if(!P)return;const e=localStorage.getItem("RR_DEBUG");if(!e)return e;try{return JSON.parse(e)}catch(t){return e}})()||x;S===Z&&console.info("Recollect debugging is enabled. Type __RR__.debugOff() to turn it off.");const W=t=>{S===Z&&t()},j=(t,e,n)=>{W((()=>{console.groupCollapsed(`GET: ${A(t,e)}`),console.info(`Component: <${r.currentComponent._name}>`),void 0!==n&&console.info("Value:",n),console.groupEnd()}))},M=(t,e,n)=>{W((()=>{console.groupCollapsed(`SET: ${A(t,e)}`),console.info("From:",d(t,e)),console.info("To:  ",n),console.groupEnd()}))},k={},C=t=>k.UpdateNextStore(t),F=t=>{if(!r.currentComponent)return;const e=L(t),n=r.listeners.get(e)||new Set;n.add(r.currentComponent),r.listeners.set(e,n)},Y=t=>{return new Proxy(t,u(e=t)||f(e)?{get(t,e){if(e===i)return t;let n=Reflect.get(t,e);if(h(n)&&(n=n.bind(t)),r.proxyIsMuted||p(e))return n;if(!r.currentComponent&&r.redirectToNext){const n=r.nextVersionMap.get(t);if(n)return Reflect.get(n,e)}return"set"===e?new Proxy(n,{apply:(n,r,[o,i])=>r.get(o)===i||C({target:r,prop:o,value:i,updater:(n,r)=>(M(t,e,r),Reflect.apply(n[e],n,[o,r]))})}):"add"===e?new Proxy(n,{apply:(n,r,[o])=>!!r.has(o)||C({target:r,notifyTarget:!0,value:o,updater:(n,r)=>(M(t,e,r),Reflect.apply(n[e],n,[r]))})}):"clear"===e||"delete"===e?new Proxy(n,{apply:(n,r,[o])=>!(!r.size||"delete"===e&&!r.has(o))&&C({target:r,notifyTarget:!0,updater:n=>(M(t,e),Reflect.apply(n[e],n,[o]))})}):r.currentComponent&&u(t)&&"get"===e?new Proxy(n,{apply:(e,n,r)=>(F(R(t,r[0])),Reflect.apply(e,n,r))}):n}}:{get(t,e){if(e===i)return t;const n=Reflect.get(t,e);if(r.proxyIsMuted||p(e))return n;if(((t,e)=>a(t)&&["copyWithin","fill","pop","push","reverse","shift","sort","splice","unshift"].includes(e))(t,e))return new Proxy(n,{apply:(n,r,o)=>C({target:r,notifyTarget:!0,value:o,updater:(n,r)=>{M(t,e,r);const o=Reflect.apply(n[e],n,r),i=_(t);return m(n,((t,e)=>{l(t)&&T(t,[...i,...e])})),o}})});if(h(t[e]))return n;if(r.currentComponent)a(t)&&"length"===e||(j(t,e,n),F(R(t,e)));else if(r.redirectToNext){const n=r.nextVersionMap.get(t);if(n)return Reflect.get(n,e)}return n},has(t,e){const n=Reflect.has(t,e);if(r.proxyIsMuted||p(e))return n;if(r.currentComponent)a(t)||(j(t,e),F(R(t,e)));else{const n=r.nextVersionMap.get(t);if(n)return Reflect.has(n,e)}return n},ownKeys(t){const e=Reflect.ownKeys(t);if(r.proxyIsMuted)return e;if(r.currentComponent)j(t),F(_(t));else{const e=r.nextVersionMap.get(t);if(e)return Reflect.ownKeys(e)}return e},set:(t,e,n)=>r.proxyIsMuted?Reflect.set(t,e,n):t[e]===n||C({target:t,prop:e,value:n,updater:(n,r)=>(M(t,e,r),Reflect.set(n,e,r))}),deleteProperty:(t,e)=>r.proxyIsMuted?Reflect.deleteProperty(t,e):C({target:t,prop:e,notifyTarget:!0,updater:n=>(((t,e)=>{W((()=>{console.groupCollapsed(`DELETE: ${A(t,e)}`),console.info("Property: ",A(t,e)),console.groupEnd()}))})(t,e),Reflect.deleteProperty(n,e))})});var e},I=require("react-dom"),B=n.n(I)().unstable_batchedUpdates||(t=>{t()}),N={components:new Map,changedPaths:new Set};var D;r.store=Y({}),D=({target:t,prop:e,value:n,notifyTarget:o=!1,updater:s})=>O((()=>{let c;const a=_(t),u=R(t,e);let f=!1;const p=v(t);let h=n;return l(h)&&(h=m(n,((t,e)=>{if(!l(t))return t;const n=y(t);return T(n,[...u,...e]),Y(n)}))),a.length?a.reduce(((e,n,o)=>{const u=d(e,n);let l=y(u);return T(l,_(u)),l=Y(l),b(e,n,l),o===a.length-1&&(c=s(l,h),f=v(l)!==p,r.nextVersionMap.set(t[i]||t,l)),l}),r.store):(c=s(r.store,h),f=v(r.store)!==p),(t=>{const e=L(t),n=w(t);N.changedPaths.add(n),r.listeners.forEach(((t,r)=>{""!==e&&e!==r||t.forEach((t=>{const e=N.components.get(t)||new Set;e.add(n),N.components.set(t,e)}))})),r.isBatchUpdating||(B((()=>{N.components.forEach(((t,e)=>{((t,e)=>{W((()=>{console.groupCollapsed(`UPDATE:  <${t._name}>`),console.info("Changed properties:",e),console.groupEnd()}))})(e,Array.from(t)),e.update()}))})),r.manualListeners.forEach((t=>t({changedProps:Array.from(N.changedPaths),renderedComponents:Array.from(N.components.keys()),store:r.store}))),N.components.clear(),N.changedPaths.clear())})(o||f?a:u),c})),k.UpdateNextStore=D;var z=n(1974),U=n.n(z),V=n(8679),K=n.n(V);const H=[],$=()=>{r.isInBrowser&&(W((()=>{console.groupEnd()})),H.pop(),r.currentComponent=H[H.length-1]||null)},G=()=>O((()=>{const t=Object.assign({},r.store);return r.nextVersionMap.set(t,r.store),Y(t)})),X=t=>{const e=t.displayName||t.name||"NamelessComponent";class n extends U().PureComponent{constructor(){super(...arguments),this.state={store:G()},this._isMounted=!1,this._isMounting=!0,this._isRendering=!1,this._name=e}componentDidMount(){this._isMounted=!0,this._isMounting=!1,$(),this._isRendering=!1}componentDidUpdate(){$(),this._isRendering=!1}componentWillUnmount(){var t;t=this,r.listeners.forEach(((e,n)=>{const o=Array.from(e).filter((e=>e!==t));o.length?r.listeners.set(n,new Set(o)):r.listeners.delete(n)})),this._isMounted=!1}update(){(this._isMounted||this._isMounting)&&this.setState({store:G()})}render(){var e;this._isRendering||(e=this,r.isInBrowser&&(W((()=>{console.groupCollapsed(`RENDER: <${e._name}>`)})),r.currentComponent=e,H.push(r.currentComponent)),this._isRendering=!0);const n=Object.assign(Object.assign({},this.props),{store:this.state.store});return U().createElement(t,Object.assign({},n))}}return n.displayName=`Collected(${e})`,K()(n,t)};let q;q=n(5697);const{store:J}=r;"undefined"!=typeof window&&("Proxy"in window?window.__RR__={debugOn:()=>{S=Z,E(s,Z)},debugOff:()=>{S=x,E(s,x)},internals:r}:console.warn("This browser doesn't support the Proxy object, which react-recollect needs. See https://caniuse.com/#search=proxy to find out which browsers do support it"))},5565:(t,e,n)=>{t.exports=n(6626)},3379:t=>{"use strict";var e=[];function n(t){for(var n=-1,r=0;r<e.length;r++)if(e[r].identifier===t){n=r;break}return n}function r(t,r){for(var i={},s=[],c=0;c<t.length;c++){var a=t[c],u=r.base?a[0]+r.base:a[0],f=i[u]||0,l="".concat(u," ").concat(f);i[u]=f+1;var p=n(l),h={css:a[1],media:a[2],sourceMap:a[3],supports:a[4],layer:a[5]};if(-1!==p)e[p].references++,e[p].updater(h);else{var y=o(h,r);r.byIndex=c,e.splice(c,0,{identifier:l,updater:y,references:1})}s.push(l)}return s}function o(t,e){var n=e.domAPI(e);return n.update(t),function(e){if(e){if(e.css===t.css&&e.media===t.media&&e.sourceMap===t.sourceMap&&e.supports===t.supports&&e.layer===t.layer)return;n.update(t=e)}else n.remove()}}t.exports=function(t,o){var i=r(t=t||[],o=o||{});return function(t){t=t||[];for(var s=0;s<i.length;s++){var c=n(i[s]);e[c].references--}for(var a=r(t,o),u=0;u<i.length;u++){var f=n(i[u]);0===e[f].references&&(e[f].updater(),e.splice(f,1))}i=a}}},569:t=>{"use strict";var e={};t.exports=function(t,n){var r=function(t){if(void 0===e[t]){var n=document.querySelector(t);if(window.HTMLIFrameElement&&n instanceof window.HTMLIFrameElement)try{n=n.contentDocument.head}catch(t){n=null}e[t]=n}return e[t]}(t);if(!r)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");r.appendChild(n)}},9216:t=>{"use strict";t.exports=function(t){var e=document.createElement("style");return t.setAttributes(e,t.attributes),t.insert(e,t.options),e}},3565:(t,e,n)=>{"use strict";t.exports=function(t){var e=n.nc;e&&t.setAttribute("nonce",e)}},7795:t=>{"use strict";t.exports=function(t){var e=t.insertStyleElement(t);return{update:function(n){!function(t,e,n){var r="";n.supports&&(r+="@supports (".concat(n.supports,") {")),n.media&&(r+="@media ".concat(n.media," {"));var o=void 0!==n.layer;o&&(r+="@layer".concat(n.layer.length>0?" ".concat(n.layer):""," {")),r+=n.css,o&&(r+="}"),n.media&&(r+="}"),n.supports&&(r+="}");var i=n.sourceMap;i&&"undefined"!=typeof btoa&&(r+="\n/*# sourceMappingURL=data:application/json;base64,".concat(btoa(unescape(encodeURIComponent(JSON.stringify(i))))," */")),e.styleTagTransform(r,t,e.options)}(e,t,n)},remove:function(){!function(t){if(null===t.parentNode)return!1;t.parentNode.removeChild(t)}(e)}}}},4589:t=>{"use strict";t.exports=function(t,e){if(e.styleSheet)e.styleSheet.cssText=t;else{for(;e.firstChild;)e.removeChild(e.firstChild);e.appendChild(document.createTextNode(t))}}},3333:(t,e,n)=>{var r={"./animate.jsx":5061,"./changezone.jsx":1183,"./chat.jsx":5317,"./dialogue.jsx":2282,"./face.jsx":2813,"./greeting.jsx":1162,"./interact.jsx":5544,"./move.jsx":2897,"./patrol.jsx":2704,"./script.jsx":5744};function o(t){var e=i(t);return n(e)}function i(t){if(!n.o(r,t)){var e=new Error("Cannot find module '"+t+"'");throw e.code="MODULE_NOT_FOUND",e}return r[t]}o.keys=function(){return Object.keys(r)},o.resolve=i,t.exports=o,o.id=3333},4816:(t,e,n)=>{var r={"./dungeon-bottom/map.jsx":948,"./dungeon-top/map.jsx":4805,"./room/map.jsx":5686};function o(t){var e=i(t);return n(e)}function i(t){if(!n.o(r,t)){var e=new Error("Cannot find module '"+t+"'");throw e.code="MODULE_NOT_FOUND",e}return r[t]}o.keys=function(){return Object.keys(r)},o.resolve=i,t.exports=o,o.id=4816},7467:(t,e,n)=>{var r={"./characters/copy.jsx":642,"./characters/default.jsx":7154,"./effects/fireplace.jsx":597,"./effects/waterspurt.jsx":5359,"./furniture/door.jsx":7085,"./furniture/fireplace.jsx":6463,"./furniture/tree.jsx":5624,"./npc/air-knight.jsx":5378,"./npc/darkness.jsx":6613,"./npc/earth-knight.jsx":5532,"./npc/fire-knight.jsx":4267,"./npc/water-knight.jsx":3886,"./objects/chests/blue.jsx":4247,"./objects/chests/metal.jsx":2188,"./objects/chests/red.jsx":3991,"./objects/chests/wood.jsx":4475};function o(t){var e=i(t);return n(e)}function i(t){if(!n.o(r,t)){var e=new Error("Cannot find module '"+t+"'");throw e.code="MODULE_NOT_FOUND",e}return r[t]}o.keys=function(){return Object.keys(r)},o.resolve=i,t.exports=o,o.id=7467},7935:(t,e,n)=>{var r={"./sewer/tileset.jsx":3507};function o(t){var e=i(t);return n(e)}function i(t){if(!n.o(r,t)){var e=new Error("Cannot find module '"+t+"'");throw e.code="MODULE_NOT_FOUND",e}return r[t]}o.keys=function(){return Object.keys(r)},o.resolve=i,t.exports=o,o.id=7935},1974:t=>{"use strict";t.exports=require("react")}},e={};function n(r){var o=e[r];if(void 0!==o)return o.exports;var i=e[r]={id:r,exports:{}};return t[r](i,i.exports,n),i.exports}n.n=t=>{var e=t&&t.__esModule?()=>t.default:()=>t;return n.d(e,{a:e}),e},n.d=(t,e)=>{for(var r in e)n.o(e,r)&&!n.o(t,r)&&Object.defineProperty(t,r,{enumerable:!0,get:e[r]})},n.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),n.r=t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})};var r={};(()=>{"use strict";n.r(r),n.d(r,{default:()=>bt});var t=n(1974),e=n.n(t),o=n(5565),i=n(5697),s=n.n(i),c=n(9175),a=n(8348),u=n(7408);function f(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var l=function(){function t(e,n){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.engine=n,this.src=e,this.glTexture=n.gl.createTexture(),this.image=new Image,this.image.onload=this.onImageLoaded.bind(this),this.image.src=e,this.loaded=!1,this.onLoadActions=new u.Z}var e,n;return e=t,(n=[{key:"runWhenLoaded",value:function(t){this.loaded?t():this.onLoadActions.add(t)}},{key:"onImageLoaded",value:function(){var t=this.engine.gl;console.log("loaded image '"+this.src+"'"),t.bindTexture(t.TEXTURE_2D,this.glTexture),t.texImage2D(t.TEXTURE_2D,0,t.RGBA,t.RGBA,t.UNSIGNED_BYTE,this.image),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MAG_FILTER,t.NEAREST),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,t.NEAREST),t.bindTexture(t.TEXTURE_2D,null),this.loaded=!0,this.onLoadActions.run()}},{key:"attach",value:function(){var t=this.engine.gl;t.activeTexture(t.TEXTURE0),t.bindTexture(t.TEXTURE_2D,this.glTexture),t.uniform1i(this.engine.shaderProgram.samplerUniform,0)}}])&&f(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),t}();function p(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var h=new FontFace("minecraftia","url(/pixos/font/minecraftia.ttf)"),y=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.ctx=e,this.dirty=!0,this.scrollY=0,this.fontSize=24,this.font="minecraftia",this.align="left",this.background="#999",this.border={lineWidth:4,style:"white",corner:"round"},this.scrollBox={width:5,background:"#568",color:"#78a"},this.fontStyle="white",this.lines=[]}var e,n;return e=t,n=[{key:"init",value:function(t,e,n,r,o){var i,s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:{};this.text=t,this.x=e,this.y=n,this.width=r,this.height=o,this.portrait=null!==(i=s.portrait)&&void 0!==i?i:null,this.setOptions(s),this.cleanit()}},{key:"cleanit",value:function(t){this.dirty&&(this.setFont(),this.getTextPos(),this.dirty=!1,t||this.fitText())}},{key:"setOptions",value:function(t){var e=this;Object.keys(this).forEach((function(n){void 0!==t[n]&&(e[n]=t[n],e.dirty=!0)}))}},{key:"setFont",value:function(){this.fontStr=this.fontSize+"px "+this.font,this.textHeight=this.fontSize+Math.ceil(.05*this.fontSize)}},{key:"getTextPos",value:function(){"left"===this.align?this.textPos=2:"right"===this.align?this.textPos=Math.floor(this.width-this.scrollBox.width-this.fontSize/4):this.textPos=Math.floor((this.width- -this.scrollBox.width)/2)}},{key:"fitText",value:function(){var t=this.ctx;this.cleanit(!0),t.font=this.fontStr,t.textAlign=this.align,t.textBaseline="top";var e=this.text.split(" ");this.lines.length=0;for(var n="",r="";e.length>0;){var o=e.shift();t.measureText(n+r+o).width<this.width-this.scrollBox.width-this.scrollBox.width-(this.portrait?84:0)?(n+=r+o,r=" "):(""===r?n+=o:e.unshift(o),this.lines.push(n),r="",n="")}""!==n&&this.lines.push(n),this.maxScroll=(this.lines.length+.5)*this.textHeight-this.height}},{key:"drawBorder",value:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],e=this.ctx,n=this.border.lineWidth/2;e.lineJoin=this.border.corner,e.lineWidth=this.border.lineWidth,e.strokeStyle=this.border.style,t?e.strokeRect(this.x-n+84,this.y-n,this.width+2*n-84,this.height+2*n):e.strokeRect(this.x-n,this.y-n,this.width+2*n,this.height+2*n)}},{key:"drawScrollBox",value:function(){var t=this.ctx,e=this.height/(this.lines.length*this.textHeight);t.fillStyle=this.scrollBox.background,t.fillRect(this.x+this.width-this.scrollBox.width,this.y,this.scrollBox.width,this.height),t.fillStyle=this.scrollBox.color;var n=this.height*e;n>this.height&&(n=this.height),t.fillRect(this.x+this.width-this.scrollBox.width,this.y-this.scrollY*e,this.scrollBox.width,n)}},{key:"drawPortrait",value:function(){this.ctx.drawImage(this.portrait.image,this.x,this.y+38,76,76)}},{key:"scroll",value:function(t){this.cleanit(),this.scrollY=-t,this.scrollY>0?this.scrollY=0:this.scrollY<-this.maxScroll&&(this.scrollY=-this.maxScroll)}},{key:"scrollLines",value:function(t){this.cleanit(),this.scrollY=-this.textHeight*t,this.scrollY>0?this.scrollY=0:this.scrollY<-this.maxScroll&&(this.scrollY=-this.maxScroll)}},{key:"render",value:function(){var t=this.ctx;this.cleanit(),t.font=this.fontStr,t.textAlign=this.align,this.portrait?(this.drawBorder(!0),this.drawPortrait(),t.save(),t.fillStyle=this.background,t.fillRect(this.x+84,this.y,this.width-84,this.height)):(this.drawBorder(),t.save(),t.fillStyle=this.background,t.fillRect(this.x,this.y,this.width,this.height)),this.drawScrollBox(),this.portrait?(t.beginPath(),t.rect(this.x+84,this.y,this.width-this.scrollBox.width-84,this.height),t.clip(),t.setTransform(1,0,0,1,this.x+84,Math.floor(this.y+this.scrollY))):(t.beginPath(),t.rect(this.x,this.y,this.width-this.scrollBox.width,this.height),t.clip(),t.setTransform(1,0,0,1,this.x,Math.floor(this.y+this.scrollY))),t.fillStyle=this.fontStyle;for(var e=0;e<this.lines.length;e++)t.fillText(this.lines[e],this.textPos,Math.floor(e*this.textHeight)+2);t.restore()}}],n&&p(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),t}();function d(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var b=function(){function t(e,n,r){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.id=r,this.engine=n,this.canvas=e,this.ctx=e.getContext("2d"),this.glTexture=n.gl.createTexture(),this.loaded=!1,this.onLoadActions=new u.Z,this.loadImage()}var e,n;return e=t,n=[{key:"runWhenLoaded",value:function(t){this.loaded?t():this.onLoadActions.add(t)}},{key:"loadImage",value:function(){var t=this.engine.gl;t.pixelStorei(t.UNPACK_FLIP_Y_WEBGL,!0),t.bindTexture(t.TEXTURE_2D,this.glTexture),t.texImage2D(t.TEXTURE_2D,0,t.RGBA,t.RGBA,t.UNSIGNED_BYTE,this.canvas),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MAG_FILTER,t.LINEAR),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,t.LINEAR_MIPMAP_NEAREST),t.generateMipmap(t.TEXTURE_2D),t.bindTexture(t.TEXTURE_2D,null),t.pixelStorei(t.UNPACK_FLIP_Y_WEBGL,!1),console.log("loading canvas ",this.canvas),this.loaded=!0,this.onLoadActions.run()}},{key:"attach",value:function(){var t=this.engine.gl;t.activeTexture(t.TEXTURE0),t.bindTexture(t.TEXTURE_2D,this.glTexture),t.uniform1i(this.engine.shaderProgram.samplerUniform,0)}},{key:"clearHud",value:function(){var t=this.ctx;t.clearRect(0,0,t.canvas.width,t.canvas.height),this.loadImage()}},{key:"writeText",value:function(t,e,n){var r=this.ctx;r.save(),r.font="32px minecraftia",r.textAlign="center",r.textBaseline="middle",r.fillStyle="white",r.fillText(t,null!=e?e:r.canvas.width/2,null!=n?n:r.canvas.height/2),r.restore()}},{key:"scrollText",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=new y(this.ctx);return n.portrait?r.init(t,10,10,this.canvas.width-20-84,2*this.canvas.height/3-20,n):r.init(t,10,10,this.canvas.width-20,2*this.canvas.height/3-20,n),r.setOptions(n),e&&r.scroll((Math.sin((new Date).getTime()/3e3)+1)*r.maxScroll*.5),r.render(),r}}],n&&d(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),t}();function v(t,e,n,r,o,i,s){try{var c=t[i](s),a=c.value}catch(t){return void n(t)}c.done?e(a):Promise.resolve(a).then(r,o)}function m(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var O=function(){function t(e,n,r,o,i){var s,u,f=this;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),u=function(t,e){var n=e.vs,r=e.fs,o=f,i=f.loadShader(t,t.VERTEX_SHADER,n),s=f.loadShader(t,t.FRAGMENT_SHADER,r),c=t.createProgram();if(t.attachShader(c,i),t.attachShader(c,s),t.linkProgram(c),!t.getProgramParameter(c,t.LINK_STATUS))throw new Error("WebGL unable to initialize the shader program: ".concat(t.getshaderProgramLog(c)));return t.useProgram(c),c.vertexPositionAttribute=t.getAttribLocation(c,"aVertexPosition"),t.enableVertexAttribArray(c.vertexPositionAttribute),c.textureCoordAttribute=t.getAttribLocation(c,"aTextureCoord"),t.enableVertexAttribArray(c.textureCoordAttribute),c.pMatrixUniform=t.getUniformLocation(c,"uPMatrix"),c.mvMatrixUniform=t.getUniformLocation(c,"uMVMatrix"),c.samplerUniform=t.getUniformLocation(c,"uSampler"),c.setMatrixUniforms=function(){t.uniformMatrix4fv(this.pMatrixUniform,!1,o.uProjMat),t.uniformMatrix4fv(this.mvMatrixUniform,!1,o.uViewMat)},f.shaderProgram=c,c},(s="initShaderProgram")in this?Object.defineProperty(this,s,{value:u,enumerable:!0,configurable:!0,writable:!0}):this[s]=u,this.uViewMat=(0,c.Ue)(),this.uProjMat=(0,c.Ue)(),this.canvas=e,this.hud=n,this.mipmap=r,this.width=o,this.height=i,this.modelViewMatrixStack=[],this.globalStore={},this.textures=[],this.speeches=[],this.cameraAngle=45,this.cameraPosition=new a.OW(8,8,-1),this.cameraOffset=new a.OW(0,0,0),this.setCamera=this.setCamera.bind(this),this.render=this.render.bind(this)}var e,n,r,o;return e=t,n=[{key:"init",value:(r=regeneratorRuntime.mark((function t(e,n,r){var o,i;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(o=this.hud.getContext("2d"),i=this.canvas.getContext("webgl")){t.next=4;break}throw new Error("WebGL : unable to initialize");case 4:if(o){t.next=6;break}throw new Error("Canvas : unable to initialize HUD");case 6:return this.gl=i,this.ctx=o,this.time=(new Date).getTime(),this.scene=e,this.keyboard=n,this.touch=r,o.canvas.width=this.canvas.width,o.canvas.height=this.canvas.height,i.viewportWidth=this.canvas.width,i.viewportHeight=this.canvas.height,i.clearColor(0,1,0,1),i.clearDepth(1),i.enable(i.DEPTH_TEST),i.blendFunc(i.SRC_ALPHA,i.ONE_MINUS_SRC_ALPHA),i.enable(i.BLEND),this.initializedWebGl=!0,this.initShaderProgram(i,e.shaders),this.initProjection(i),t.next=26,e.init(this);case 26:case"end":return t.stop()}}),t,this)})),o=function(){var t=this,e=arguments;return new Promise((function(n,o){var i=r.apply(t,e);function s(t){v(i,n,o,s,c,"next",t)}function c(t){v(i,n,o,s,c,"throw",t)}s(void 0)}))},function(t,e,n){return o.apply(this,arguments)})},{key:"loadShader",value:function(t,e,n){var r=t.createShader(e);if(t.shaderSource(r,n),t.compileShader(r),!t.getShaderParameter(r,t.COMPILE_STATUS)){var o=t.getShaderInfoLog(r);throw t.deleteShader(r),new Error("An error occurred compiling the shaders: ".concat(o))}return r}},{key:"initProjection",value:function(t){var e=this.degToRad(45),n=t.canvas.clientWidth/t.canvas.clientHeight;this.uProjMat=(0,c.G3)(e,n,.1,100),this.uViewMat=(0,c.Ue)(),this.uProjMat[5]*=-1}},{key:"setCamera",value:function(){(0,c.Iu)(this.uViewMat,this.uViewMat,[0,0,-15]),(0,c.U1)(this.uViewMat,this.uViewMat,this.degToRad(this.cameraAngle),[1,0,0]),(0,a.tk)(this.cameraPosition,this.cameraOffset),(0,c.Iu)(this.uViewMat,this.uViewMat,this.cameraOffset.toArray())}},{key:"clearScreen",value:function(){var t=this.gl;t.viewport(0,0,t.viewportWidth,t.viewportHeight),t.clear(t.COLOR_BUFFER_BIT|t.DEPTH_BUFFER_BIT),(0,c.G3)(this.degToRad(45),t.viewportWidth/t.viewportHeight,.1,100,this.uProjMat),this.uViewMat=(0,c.Ue)()}},{key:"clearHud",value:function(){var t=this.ctx;t.clearRect(0,0,t.canvas.width,t.canvas.height)}},{key:"writeText",value:function(t,e,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,o=this.ctx;o.save(),o.font="20px invasion2000",o.textAlign="center",o.textBaseline="middle",o.fillStyle="white",r?(o.fillText(t,null!=e?e:o.canvas.width/2+76,null!=n?n:o.canvas.height/2),o.drawImage(r,null!=e?e:o.canvas.width/2,null!=n?n:o.canvas.height/2,76,76)):o.fillText(t,null!=e?e:o.canvas.width/2,null!=n?n:o.canvas.height/2),o.restore()}},{key:"setGreeting",value:function(t){this.globalStore.greeting=t}},{key:"scrollText",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=new y(this.ctx);return r.init(t,10,2*this.canvas.height/3,this.canvas.width-20,this.canvas.height/3-20,n),r.setOptions(n),e&&r.scroll((Math.sin((new Date).getTime()/3e3)+1)*r.maxScroll*.5),r.render(),r}},{key:"drawButton",value:function(t,e,n,r,o){var i=this.ctx,s=r/2;i.save(),i.fillStyle=o.background,i.beginPath(),i.rect(t,e,n,r),i.rect(t,e,n,r),i.fill(),i.clip();var c=i.createLinearGradient(t,e,t,e+s);c.addColorStop(0,"rgb(221,181,155)"),c.addColorStop(1,"rgb(22,13,8)"),i.fillStyle=c,i.globalAlpha=.5,i.fillRect(t,e,n,r),i.fillStyle=o.top;for(var a=0;a<r;a+=s){i.fillStyle=0===a?o.top:o.bottom;for(var u=0;u<50;u++){var f=t+Math.random()*n,l=e+a+Math.random()*s,p=10*Math.random(),h=10*Math.random(),y=360*Math.random(),d=Math.random();i.save(),i.translate(f,l),i.rotate(y*Math.PI/180),i.translate(-f,-l),i.globalAlpha=d,i.fillRect(f,l,p,h),i.restore()}}i.restore()}},{key:"render",value:function(){this.requestId=requestAnimationFrame(this.render),this.clearScreen(),this.clearHud(),this.scene.render(this,(new Date).getTime())}},{key:"createBuffer",value:function(t,e,n){var r=this.gl,o=r.createBuffer();return o.itemSize=n,o.numItems=t.length/n,r.bindBuffer(r.ARRAY_BUFFER,o),r.bufferData(r.ARRAY_BUFFER,new Float32Array(t),e),r.bindBuffer(r.ARRAY_BUFFER,null),o}},{key:"updateBuffer",value:function(t,e){var n=this.gl;n.bindBuffer(n.ARRAY_BUFFER,t),n.bufferSubData(n.ARRAY_BUFFER,0,new Float32Array(e)),n.bindBuffer(n.ARRAY_BUFFER,null)}},{key:"bindBuffer",value:function(t,e){var n=this.gl;n.bindBuffer(n.ARRAY_BUFFER,t),n.vertexAttribPointer(e,t.itemSize,n.FLOAT,!1,0,0)}},{key:"loadTexture",value:function(t){return this.textures[t]||(this.textures[t]=new l(t,this)),this.textures[t]}},{key:"loadSpeech",value:function(t,e){return console.log("requesting speech",t),this.speeches[t]||(this.speeches[t]=new b(e,this,t)),this.speeches[t]}},{key:"mvPushMatrix",value:function(){var t=(0,c.Ue)();(0,c.t8)(this.uViewMat,t),this.modelViewMatrixStack.push(t)}},{key:"initCanvasTexture",value:function(){var t=this.gl.createTexture();return this.handleLoadedTexture(t,this.mipmap),t}},{key:"handleLoadedTexture",value:function(t,e){var n=this.gl;n.pixelStorei(n.UNPACK_FLIP_Y_WEBGL,!0),n.bindTexture(n.TEXTURE_2D,t),n.texImage2D(n.TEXTURE_2D,0,n.RGBA,n.RGBA,n.UNSIGNED_BYTE,e),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_MAG_FILTER,n.LINEAR),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_MIN_FILTER,n.LINEAR_MIPMAP_NEAREST),n.generateMipmap(n.TEXTURE_2D),n.bindTexture(n.TEXTURE_2D,null)}},{key:"mvPopMatrix",value:function(){if(0==this.modelViewMatrixStack.length)throw"Invalid popMatrix!";this.uViewMat=this.modelViewMatrixStack.pop()}},{key:"close",value:function(){cancelAnimationFrame(this.requestId)}},{key:"degToRad",value:function(t){return t*Math.PI/180}}],n&&m(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),t}(),g=n(4180);function w(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var L=function(){function t(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),t._instance||(this.activeKeys=[],this.activeCodes=[],this.shift=!1,t._instance=this),t._instance}var e,n;return e=t,n=[{key:"onKeyDown",value:function(e){e.preventDefault();var n=String.fromCharCode(e.keyCode).toLowerCase();t._instance.activeKeys.indexOf(n)<0&&t._instance.activeKeys.push(n),t._instance.activeCodes.indexOf(e.key)<0&&t._instance.activeCodes.push(e.key),t._instance.shift=e.shiftKey}},{key:"onKeyUp",value:function(e){var n=String.fromCharCode(e.keyCode).toLowerCase(),r=t._instance.activeKeys.indexOf(n);t._instance.activeKeys.splice(r,1),t._instance.activeCodes.splice(r,1)}},{key:"lastPressed",value:function(e){for(var n=e.toLowerCase(),r=null,o=-1,i=0;i<e.length;i++){var s=n[i],c=t._instance.activeKeys.indexOf(s);c>o&&(r=s,o=c)}return r}},{key:"lastPressedCode",value:function(){for(var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",n=t._instance.activeCodes.pop(),r=e.toLowerCase(),o=0;o<r.length;o++){var i=t._instance.activeKeys.indexOf(n);i<0&&(n=t._instance.activeCodes.pop())}return n}},{key:"lastPressedKey",value:function(){return t._instance.activeKeys[t._instance.activeKeys.length-1]}}],n&&w(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),t}();function R(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var A=function(){function t(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),t._instance||(this.x=0,this.y=0,this.isDragging=!1,this.activeDirection=[],t._instance=this),t._instance}var e,n;return e=t,(n=[{key:"onTouch",value:function(t){t.touches&&(this.x=t.touches[0].pageX,this.y=t.touches[0].pageY,console.log("Touch:  x: ".concat(this.x,", y: ").concat(this.y)),t.preventDefault())}}])&&R(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),t}();function T(t,e,n,r,o,i,s){try{var c=t[i](s),a=c.value}catch(t){return void n(t)}c.done?e(a):Promise.resolve(a).then(r,o)}function _(t){return function(){var e=this,n=arguments;return new Promise((function(r,o){var i=t.apply(e,n);function s(t){T(i,r,o,s,c,"next",t)}function c(t){T(i,r,o,s,c,"throw",t)}s(void 0)}))}}var P=function(n){var r=n.width,o=n.height,i=n.SceneProvider,s=n.class,c=(0,t.useRef)(),a=(0,t.useRef)(),u=(0,t.useRef)(),f=new L,l=new A,p=i.onMouseEvent,y=i.onKeyEvent,d=i.onTouchEvent;function b(){return v.apply(this,arguments)}function v(){return(v=_(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,h.load();case 2:document.fonts.add(h);case 3:case"end":return t.stop()}}),t)})))).apply(this,arguments)}return(0,t.useEffect)(_(regeneratorRuntime.mark((function t(){var e,n,s,p;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e=c.current,n=a.current,s=u.current,p=new O(e,n,s,r,o),t.next=6,b();case 6:return t.next=8,p.init(i,f,l);case 8:return p.render(),t.abrupt("return",(function(){p.close()}));case 10:case"end":return t.stop()}}),t)}))),[i]),e().createElement("div",{style:{position:"relative"}},e().createElement("canvas",{style:{position:"absolute",zIndex:1,top:0,left:0},ref:c,width:r,height:o,className:s}),e().createElement("canvas",{style:{zIndex:2,top:0,left:0,background:"none"},tabIndex:0,ref:a,width:r,height:o,className:s,onTouchMoveCapture:function(t){return d(t.nativeEvent)},onTouchCancelCapture:function(t){return d(t.nativeEvent)},onTouchStartCapture:function(t){return d(t.nativeEvent)},onTouchEndCapture:function(t){return d(t.nativeEvent)},onKeyDownCapture:function(t){return y(t.nativeEvent)},onKeyUpCapture:function(t){return y(t.nativeEvent)},onContextMenu:function(t){return p(t.nativeEvent.clientX,t.nativeEvent.clientY,g.T.UP,!0,t)},onMouseUp:function(t){return p(t.nativeEvent.clientX,t.nativeEvent.clientY,g.T.UP,3==t.nativeEvent.button,t)},onMouseDown:function(t){return p(t.nativeEvent.clientX,t.nativeEvent.clientY,g.T.DOWN,3==t.nativeEvent.button,t)},onMouseMove:function(t){return p(t.nativeEvent.clientX,t.nativeEvent.clientY,g.T.MOVE,3==t.nativeEvent.button,t)}}),e().createElement("canvas",{style:{display:"none"},ref:u,width:256,height:256}))};P.propTypes={width:s().number.isRequired,height:s().number.isRequired,SceneProvider:s().object.isRequired,class:s().string.isRequired};const E=P;var Z=n(6185),x=n(9337);function S(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function W(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?S(Object(n),!0).forEach((function(e){j(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):S(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function j(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function M(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function k(t,e,n,r,o,i,s){try{var c=t[i](s),a=c.value}catch(t){return void n(t)}c.done?e(a):Promise.resolve(a).then(r,o)}function C(t){return function(){var e=this,n=arguments;return new Promise((function(r,o){var i=t.apply(e,n);function s(t){k(i,r,o,s,c,"next",t)}function c(t){k(i,r,o,s,c,"throw",t)}s(void 0)}))}}function F(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var Y=function(){function t(e,n){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.id=e,this.world=n,this.data={},this.spriteDict={},this.spriteList=[],this.engine=n.engine,this.onLoadActions=new u.Z,this.spriteLoader=new x.jf(n.engine),this.tsLoader=new x.e5(n.engine),this.onTilesetDefinitionLoaded=this.onTilesetDefinitionLoaded.bind(this),this.onTilesetOrSpriteLoaded=this.onTilesetOrSpriteLoaded.bind(this),this.loadSprite=this.loadSprite.bind(this,this),this.checkInput=this.checkInput.bind(this)}var e,r,o,i,s,c,a,f,l;return e=t,r=[{key:"loadRemote",value:(l=C(regeneratorRuntime.mark((function t(){var e,n,r=this;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,fetch(Z.Z.zoneRequestUrl(this.id));case 2:if(!(e=t.sent).ok){t.next=25;break}return t.prev=4,t.next=7,e.json();case 7:return n=t.sent,this.bounds=n.bounds,this.size=[n.bounds[2]-n.bounds[0],n.bounds[3]-n.bounds[1]],this.cells=n.cells,t.next=13,this.tsLoader.load(n.tileset);case 13:return this.tileset=t.sent,this.tileset.runWhenDefinitionLoaded(this.onTilesetDefinitionLoaded.bind(this)),this.tileset.runWhenLoaded(this.onTilesetOrSpriteLoaded.bind(this)),t.next=18,Promise.all(n.sprites.map(this.loadSprite.bind(this)));case 18:this.spriteList.forEach((function(t){return t.runWhenLoaded(r.onTilesetOrSpriteLoaded.bind(r))})),t.next=25;break;case 21:t.prev=21,t.t0=t.catch(4),console.error("Error parsing zone "+this.id),console.error(t.t0);case 25:case"end":return t.stop()}}),t,this,[[4,21]])}))),function(){return l.apply(this,arguments)})},{key:"load",value:(f=C(regeneratorRuntime.mark((function t(){var e,r;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,e=n(4816)("./"+this.id+"/map.jsx").default,Object.assign(this,e),this.audioSrc&&(this.audio=new x.mT(this.audioSrc,!0)),this.size=[this.bounds[2]-this.bounds[0],this.bounds[3]-this.bounds[1]],t.next=7,this.tsLoader.load(this.tileset);case 7:return this.tileset=t.sent,this.tileset.runWhenDefinitionLoaded(this.onTilesetDefinitionLoaded.bind(this)),this.tileset.runWhenLoaded(this.onTilesetOrSpriteLoaded.bind(this)),r=this,t.next=13,Promise.all(r.sprites.map(r.loadSprite));case 13:console.log(r.spriteDict),r.spriteList.forEach((function(t){return t.runWhenLoaded(r.onTilesetOrSpriteLoaded)})),t.next=21;break;case 17:t.prev=17,t.t0=t.catch(0),console.error("Error parsing zone "+this.id),console.error(t.t0);case 21:case"end":return t.stop()}}),t,this,[[0,17]])}))),function(){return f.apply(this,arguments)})},{key:"runWhenLoaded",value:function(t){this.loaded?t():this.onLoadActions.add(t)}},{key:"onTilesetDefinitionLoaded",value:function(){this.vertexPosBuf=[],this.vertexTexBuf=[],this.walkability=[];for(var t=0,e=0;t<this.size[1];t++){for(var n=[],r=[],o=0;o<this.size[0];o++,e++){var i=this.cells[e];this.walkability[e]=g.N.All;for(var s=Math.floor(i.length/3),c=0;c<s;c++){var a=[this.bounds[0]+o,this.bounds[1]+t,i[3*c+2]];this.walkability[e]&=this.tileset.getWalkability(i[3*c]),n=n.concat(this.tileset.getTileVertices(i[3*c],a)),r=r.concat(this.tileset.getTileTexCoords(i[3*c],i[3*c+1]))}i.length==3*s+1&&(this.walkability[e]=i[3*s])}this.vertexPosBuf[t]=this.engine.createBuffer(n,this.engine.gl.STATIC_DRAW,3),this.vertexTexBuf[t]=this.engine.createBuffer(r,this.engine.gl.STATIC_DRAW,2)}}},{key:"onTilesetOrSpriteLoaded",value:function(){var t=this;if(!this.loaded&&this.tileset.loaded&&this.spriteList.every((function(t){return t.loaded}))){console.log("Initialized zone '"+this+"'");var e=this;this.scripts.forEach((function(n){"load-scene"===n.id&&t.runWhenLoaded(n.trigger.bind(e))})),this.loaded=!0,this.onLoadActions.run()}}},{key:"loadSprite",value:(a=C(regeneratorRuntime.mark((function t(e,n){var r;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n.zone=e,t.next=3,this.spriteLoader.load(n.type,(function(t){return t.onLoad(n)}));case 3:r=t.sent,console.log(["this",this.spriteDict,this.spriteList,n,r]),this.spriteDict[n.id]=r,this.spriteList.push(r);case 7:case"end":return t.stop()}}),t,this)}))),function(t,e){return a.apply(this,arguments)})},{key:"addSprite",value:function(t){t.zone=this,this.spriteDict[t.id]=t,this.spriteList.push(t)}},{key:"removeSprite",value:function(t){this.spriteList=this.spriteList.filter((function(e){if(e.id!==t)return!0;e.removeAllActions()})),delete this.spriteDict[t]}},{key:"removeAllSprites",value:function(){this.spriteList=[],this.spriteDict={}}},{key:"getSpriteById",value:function(t){return this.spriteDict[t]}},{key:"getHeight",value:function(t,e){if(!this.isInZone(t,e))return console.error("Requesting height for ["+t+", "+e+"] outside zone bounds"),0;for(var n=Math.floor(t),r=Math.floor(e),o=[t-n,e-r],i=function(t,e){var n=[t[1][0]-t[0][0],t[1][1]-t[0][1]],r=[t[2][0]-t[0][0],t[2][1]-t[0][1]],o=1/(n[0]*r[1]-n[1]*r[0]),i=[o*r[1],-o*r[0],-o*n[1],o*n[0]];return[n=(e[0]-t[0][0])*i[0]+(e[1]-t[0][1])*i[1],r=(e[0]-t[0][0])*i[2]+(e[1]-t[0][1])*i[3]]},s=this.cells[(r-this.bounds[1])*this.size[0]+n-this.bounds[0]],c=Math.floor(s.length/3),a=0;a<c;a++){var u=this.tileset.getTileWalkPoly(s[3*a]);if(u)for(var f=0;f<u.length;f++){var l=i(u[f],o),p=l[0]+l[1];if(p<=1)return s[3*a+2]+(1-p)*u[f][0][2]+l[0]*u[f][1][2]+l[1]*u[f][2][2]}}return s[2]}},{key:"drawRow",value:function(t){this.engine.bindBuffer(this.vertexPosBuf[t],this.engine.shaderProgram.vertexPositionAttribute),this.engine.bindBuffer(this.vertexTexBuf[t],this.engine.shaderProgram.textureCoordAttribute),this.tileset.texture.attach(),this.engine.shaderProgram.setMatrixUniforms(),this.engine.gl.drawArrays(this.engine.gl.TRIANGLES,0,this.vertexPosBuf[t].numItems)}},{key:"draw",value:function(){if(this.loaded){this.spriteList.sort((function(t,e){return t.pos.y-e.pos.y})),this.engine.mvPushMatrix(),this.engine.setCamera();for(var t=0,e=0;e<this.size[1];e++)for(this.drawRow(e);t<this.spriteList.length&&this.spriteList[t].pos.y-this.bounds[1]<=e;)this.spriteList[t++].draw(this.engine);for(;t<this.spriteList.length;)this.spriteList[t++].draw(this.engine);this.engine.mvPopMatrix()}}},{key:"tick",value:function(t){this.loaded&&(this.checkInput(t),this.spriteList.forEach(function(){var e=C(regeneratorRuntime.mark((function e(n){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",n.tickOuter(t));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()))}},{key:"checkInput",value:function(t){"o"===this.engine.keyboard.lastPressedKey("o")&&this.audio&&this.audio.playAudio()}},{key:"isInZone",value:function(t,e){return t>=this.bounds[0]&&e>=this.bounds[1]&&t<this.bounds[2]&&e<this.bounds[3]}},{key:"isWalkable",value:function(t,e,n){if(!this.isInZone(t,e))return null;for(var r in this.spriteDict){if(!this.spriteDict[r].walkable&&this.spriteDict[r].pos.x===t&&this.spriteDict[r].pos.y===e&&!this.spriteDict[r].blocking&&this.spriteDict[r].override)return!0;if(!this.spriteDict[r].walkable&&this.spriteDict[r].pos.x===t&&this.spriteDict[r].pos.y===e&&this.spriteDict[r].blocking)return!1}return 0!=(this.walkability[(e-this.bounds[1])*this.size[0]+t-this.bounds[0]]&n)}},{key:"moveSprite",value:(c=C(regeneratorRuntime.mark((function t(e,n){var r,o=this,i=arguments;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=i.length>2&&void 0!==i[2]&&i[2],t.abrupt("return",new Promise((function(t,i){var s=o.getSpriteById(e);s.addAction(new x.aW(o.engine,"patrol",[s.pos.toArray(),n,r?200:600,o],s,t))})));case 2:case"end":return t.stop()}}),t)}))),function(t,e){return c.apply(this,arguments)})},{key:"spriteDialogue",value:(s=C(regeneratorRuntime.mark((function t(e,n){var r,o=this,i=arguments;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=i.length>2&&void 0!==i[2]?i[2]:{autoclose:!0},t.abrupt("return",new Promise((function(t,i){var s=o.getSpriteById(e);s.addAction(new x.aW(o.engine,"dialogue",[n,!1,r],s,t))})));case 2:case"end":return t.stop()}}),t)}))),function(t,e){return s.apply(this,arguments)})},{key:"runActions",value:(i=C(regeneratorRuntime.mark((function t(e){var n;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=this,t.next=3,e.reduce(function(){var t=C(regeneratorRuntime.mark((function t(e,r){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.then(C(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",new Promise((function(t,e){console.log("working on action ---- ",r),r||t();try{if(r.scope||(r.scope=n),r.sprite){var o=r.scope.getSpriteById(r.sprite);if(o&&r.action){console.log("playing scene action in zone",n);var i=r.args,s=i.pop();o.addAction(new x.aW(n.engine,r.action,[].concat(function(t){if(Array.isArray(t))return M(t)}(a=i)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(a)||function(t,e){if(t){if("string"==typeof t)return M(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?M(t,e):void 0}}(a)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}(),[W({},s)]),o,(function(){return t(n)})))}}if(r.trigger){console.log("trigger",r);var c=r.scope.getSpriteById("avatar");console.log("triggered by ",c),c&&r.trigger&&c.addAction(new x.aW(n.engine,"script",[r.trigger,r.scope,function(){return t(n)}],c))}}catch(t){e(t)}var a})));case 1:case"end":return t.stop()}}),t)})))).catch((function(t){console.warn("err",t.message)}));case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}(),Promise.resolve());case 3:return t.abrupt("return",t.sent);case 4:case"end":return t.stop()}}),t,this)}))),function(t){return i.apply(this,arguments)})},{key:"triggerScript",value:function(t){var e=this;this.scripts.forEach((function(n){n.id===t&&e.runWhenLoaded(n.trigger.bind(e))}))}},{key:"playScene",value:(o=C(regeneratorRuntime.mark((function t(e){var n;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:(n=this).scenes.forEach(function(){var t=C(regeneratorRuntime.mark((function t(r){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(t.prev=0,r.currentStep||(r.currentStep=0),!(r.currentStep>n.scenes.length)){t.next=4;break}return t.abrupt("return");case 4:if(r.id!==e){t.next=8;break}return console.log("found scene ---\x3e ",r),t.next=8,n.runActions(r.actions);case 8:t.next=13;break;case 10:t.prev=10,t.t0=t.catch(0),console.error(t.t0);case 13:case"end":return t.stop()}}),t,null,[[0,10]])})));return function(e){return t.apply(this,arguments)}}());case 2:case"end":return t.stop()}}),t,this)}))),function(t){return o.apply(this,arguments)})}],r&&F(e.prototype,r),Object.defineProperty(e,"prototype",{writable:!1}),t}();function I(t){return function(t){if(Array.isArray(t))return B(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(t){if("string"==typeof t)return B(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?B(t,e):void 0}}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function B(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function N(t,e,n,r,o,i,s){try{var c=t[i](s),a=c.value}catch(t){return void n(t)}c.done?e(a):Promise.resolve(a).then(r,o)}function D(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var z=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.engine=e,this.zoneDict={},this.zoneList=[],this.afterTickActions=new u.Z,this.sortZones=this.sortZones.bind(this),this.canWalk=this.canWalk.bind(this),this.pathFind=this.pathFind.bind(this)}var e,n,r,o;return e=t,n=[{key:"runAfterTick",value:function(t){this.afterTickActions.add(t)}},{key:"sortZones",value:function(){this.zoneList.sort((function(t,e){return t.bounds[1]-e.bounds[1]}))}},{key:"loadZone",value:(r=regeneratorRuntime.mark((function t(e){var n,r,o=arguments;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n=o.length>1&&void 0!==o[1]&&o[1],!this.zoneDict[e]){t.next=3;break}return t.abrupt("return",this.zoneDict[e]);case 3:if(r=new Y(e,this),!n){t.next=9;break}return t.next=7,r.loadRemote();case 7:t.next=11;break;case 9:return t.next=11,r.load();case 11:return this.zoneDict[e]=r,this.zoneList.push(r),r.runWhenLoaded(this.sortZones),t.abrupt("return",r);case 15:case"end":return t.stop()}}),t,this)})),o=function(){var t=this,e=arguments;return new Promise((function(n,o){var i=r.apply(t,e);function s(t){N(i,n,o,s,c,"next",t)}function c(t){N(i,n,o,s,c,"throw",t)}s(void 0)}))},function(t){return o.apply(this,arguments)})},{key:"removeZone",value:function(t){this.zoneList=this.zoneList.filter((function(e){if(e.id!==t)return!0;e.removeAllSprites()})),delete this.zoneDict[t]}},{key:"removeAllZones",value:function(){this.zoneList=[],this.zoneDict={}}},{key:"tick",value:function(t){for(var e in this.zoneDict){var n;null===(n=this.zoneDict[e])||void 0===n||n.tick(t)}this.afterTickActions.run(t)}},{key:"draw",value:function(){for(var t in this.zoneDict)this.zoneDict[t].draw(this.engine)}},{key:"zoneContaining",value:function(t,e){for(var n in this.zoneDict){var r=this.zoneDict[n];if(r.loaded&&r.isInZone(t,e))return r}return null}},{key:"pathFind",value:function(t,e){var n=[],r=!1,o=this,i=t[0],s=t[1];function c(t,i){var s=JSON.stringify([t[0],t[1]]);return!r&&(t[0]==e[0]&&t[1]==e[1]?(r=!0,o.canWalk(t,s,n)?[r,[].concat(I(i),[e])]:[r,I(i)]):!!o.canWalk(t,s,n)&&(n.push(s),o.getNeighbours.apply(o,I(t)).map((function(e){return c(e,[].concat(I(i),[[t[0],t[1],600]]))})).filter((function(t){return t})).flat()))}return o.getNeighbours(i,s).map((function(e){return c(e,[[t[0],t[1],600]])})).filter((function(t){return t[0]})).flat()}},{key:"getNeighbours",value:function(t,e){var n=[t,e+1,g.N.Up],r=[t,e-1,g.N.Down];return[n,[t-1,e,g.N.Left],[t+1,e,g.N.Right],r]}},{key:"canWalk",value:function(t,e,n){var r=this.zoneContaining.apply(this,I(t));return!(n.indexOf(e)>=0||!r||!r.isWalkable.apply(r,I(t))||!r.isWalkable(t[0],t[1],g.N.reverse(t[2])))}}],n&&D(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),t}();function U(t,e,n,r,o,i,s){try{var c=t[i](s),a=c.value}catch(t){return void n(t)}c.done?e(a):Promise.resolve(a).then(r,o)}function V(t){return function(){var e=this,n=arguments;return new Promise((function(r,o){var i=t.apply(e,n);function s(t){U(i,r,o,s,c,"next",t)}function c(t){U(i,r,o,s,c,"throw",t)}s(void 0)}))}}function K(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function H(t,e,n){return e&&K(t.prototype,e),n&&K(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function $(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var G=H((function t(){var e=this;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),$(this,"init",function(){var e=V(regeneratorRuntime.mark((function e(n){var r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t._instance.engine=n,r=t._instance.world=new z(n),e.next=4,r.loadZone("room");case 4:r.zoneList.forEach((function(t){return t.runWhenLoaded((function(){return console.log("loading...done")}))}));case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),$(this,"loadSceneManifest",function(){var t=V(regeneratorRuntime.mark((function t(e){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()),$(this,"loadAvatar",function(){var t=V(regeneratorRuntime.mark((function t(e,n){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}()),$(this,"exportAvatar",V(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:case"end":return t.stop()}}),t)})))),$(this,"render",(function(n,r){t._instance.world.tick(r),e.draw(n)})),$(this,"draw",(function(e){t._instance.world.draw(e)})),$(this,"onKeyEvent",(function(e){"keydown"===e.type?t._instance.engine.keyboard.onKeyDown(e):t._instance.engine.keyboard.onKeyUp(e)})),$(this,"onTouchEvent",(function(e){switch(e.type){case"touchstart":case"touchend":case"touchmove":case"touchcancel":t._instance.engine.touch.onTouch(e)}})),$(this,"onMouseEvent",(function(t,e,n,r,o){})),this.shaders={fs:"\n  precision mediump float;\n  varying vec2 vTextureCoord;\n  uniform sampler2D uSampler;\n  \n  void main(void) {\n    gl_FragColor = texture2D(uSampler, vec2(vTextureCoord.s, vTextureCoord.t));\n    if(gl_FragColor.a < 0.1)\n        discard;\n  }\n",vs:"\n  attribute vec3 aVertexPosition;\n  attribute vec2 aTextureCoord;\n  \n  uniform mat4 uMVMatrix;\n  uniform mat4 uPMatrix;\n  \n  varying vec2 vTextureCoord;\n  \n  void main(void) {\n    gl_Position = uPMatrix * uMVMatrix * vec4(aVertexPosition, 1.0);\n    vTextureCoord = aTextureCoord;\n  }\n"},t._instance||(t._instance=this),t._instance})),X=n(3379),q=n.n(X),J=n(7795),Q=n.n(J),tt=n(569),et=n.n(tt),nt=n(3565),rt=n.n(nt),ot=n(9216),it=n.n(ot),st=n(4589),ct=n.n(st),at=n(4913),ut={};function ft(t){return ft="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ft(t)}function lt(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function pt(t,e){return pt=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},pt(t,e)}function ht(t,e){if(e&&("object"===ft(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function yt(t){return yt=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},yt(t)}ut.styleTagTransform=ct(),ut.setAttributes=rt(),ut.insert=et().bind(null,"head"),ut.domAPI=Q(),ut.insertStyleElement=it(),q()(at.Z,ut),at.Z&&at.Z.locals&&at.Z.locals;var dt=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");Object.defineProperty(t,"prototype",{value:Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),writable:!1}),e&&pt(t,e)}(c,t);var n,r,o,i,s=(o=c,i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,e=yt(o);if(i){var n=yt(this).constructor;t=Reflect.construct(e,arguments,n)}else t=e.apply(this,arguments);return ht(this,t)});function c(t){var e;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,c),(e=s.call(this,t)).state={networkString:t.networkString,scene:new G,updated:Date.now()},e}return n=c,(r=[{key:"componentWillReceiveProps",value:function(t){console.log(t),JSON.stringify(this.props.networkString)!=JSON.stringify(t.networkString)&&this.setState({networkString:t.networkString,updated:Date.now()})}},{key:"render",value:function(){var t=this.state,n=t.networkString,r=t.updated,o=t.scene;return e().createElement(e().Fragment,null,e().createElement(E,{class:"pixos",key:r,width:640,height:480,SceneProvider:o,networkString:n}))}}])&&lt(n.prototype,r),Object.defineProperty(n,"prototype",{writable:!1}),c}(t.Component);const bt=(0,o.collect)(dt)})(),module.exports["calliope-pixos"]=r})();
//# sourceMappingURL=bundle.js.map