/*! For license information please see bundle.js.LICENSE.txt */
!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e(require("react"),require("react-dom")):"function"==typeof define&&define.amd?define(["react","react-dom"],e):"object"==typeof exports?exports["calliope-pixos"]=e(require("react"),require("react-dom")):t["calliope-pixos"]=e(t.react,t["react-dom"])}(self,(function(t,e){return(()=>{var n={997:(t,e,n)=>{var i={"./changezone.jsx":826,"./chat.jsx":774,"./dialogue.jsx":319,"./face.jsx":277,"./greeting.jsx":941,"./move.jsx":841};function r(t){var e=o(t);return n(e)}function o(t){if(!n.o(i,t)){var e=new Error("Cannot find module '"+t+"'");throw e.code="MODULE_NOT_FOUND",e}return i[t]}r.keys=function(){return Object.keys(i)},r.resolve=o,t.exports=r,r.id=997},183:(t,e,n)=>{var i={"./characters/player.jsx":701,"./effects/lavaspurt.jsx":42,"./monsters/air_elemental.jsx":714,"./monsters/fire_elemental.jsx":669,"./monsters/water_elemental.jsx":261};function r(t){var e=o(t);return n(e)}function o(t){if(!n.o(i,t)){var e=new Error("Cannot find module '"+t+"'");throw e.code="MODULE_NOT_FOUND",e}return i[t]}r.keys=function(){return Object.keys(i)},r.resolve=o,t.exports=r,r.id=183},267:(t,e,n)=>{var i={"./sewer.tileset.jsx":283};function r(t){var e=o(t);return n(e)}function o(t){if(!n.o(i,t)){var e=new Error("Cannot find module '"+t+"'");throw e.code="MODULE_NOT_FOUND",e}return i[t]}r.keys=function(){return Object.keys(i)},r.resolve=o,t.exports=r,r.id=267},394:(t,e,n)=>{var i={"./dungeon-bottom.zone.jsx":493,"./dungeon-top.zone.jsx":468};function r(t){var e=o(t);return n(e)}function o(t){if(!n.o(i,t)){var e=new Error("Cannot find module '"+t+"'");throw e.code="MODULE_NOT_FOUND",e}return i[t]}r.keys=function(){return Object.keys(i)},r.resolve=o,t.exports=r,r.id=394},826:(t,e,n)=>{"use strict";n.r(e),n.d(e,{default:()=>h});var i=n(968),r=n(979);function o(t,e,n){return o=s()?Reflect.construct:function(t,e,n){var i=[null];i.push.apply(i,e);var r=new(Function.bind.apply(t,i));return n&&a(r,n.prototype),r},o.apply(null,arguments)}function s(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}function a(t,e){return a=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},a(t,e)}function c(t){return function(t){if(Array.isArray(t))return u(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(t){if("string"==typeof t)return u(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?u(t,e):void 0}}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function u(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,i=new Array(e);n<e;n++)i[n]=t[n];return i}function l(t,e,n,i,r,o,s){try{var a=t[o](s),c=a.value}catch(t){return void n(t)}a.done?e(c):Promise.resolve(c).then(i,r)}const h={init:(f=regeneratorRuntime.mark((function t(e,n,s,a,u){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return console.log("loading - change zone"),t.next=3,this.sprite.zone.world.loadZone(e);case 3:return this.fromZone=t.sent,t.next=6,this.sprite.zone.world.loadZone(s);case 6:this.toZone=t.sent,this.from=o(i.OW,c(n)),this.to=o(i.OW,c(a)),this.facing=r.N.fromOffset([Math.round(a.x-n.x),Math.round(a.y-n.y)]),this.length=u;case 11:case"end":return t.stop()}}),t,this)})),d=function(){var t=this,e=arguments;return new Promise((function(n,i){var r=f.apply(t,e);function o(t){l(r,n,i,o,s,"next",t)}function s(t){l(r,n,i,o,s,"throw",t)}o(void 0)}))},function(t,e,n,i,r){return d.apply(this,arguments)}),tick:function(t){if(this.toZone.loaded&&this.fromZone.loaded){this.facing&&this.facing!=this.sprite.facing&&(this.sprite.facing=this.facing,this.sprite.setFrame(0));var e=this.startTime+this.length,n=(t-this.startTime)/this.length;t>=e?((0,i.t8)(this.to,this.sprite.pos),n=1):(0,i.t7)(this.from,this.to,n,this.sprite.pos);var r=Math.floor(4*n);r!=this.sprite.animFrame&&this.sprite.setFrame(r),this.sprite.zone.isInZone(this.sprite.pos.x,this.sprite.pos.y)||(this.fromZone.removeSprite(this.sprite.id),this.sprite.zone.world.runAfterTick(function(){this.toZone.addSprite(this.sprite),console.log("sprite '"+this.sprite.id+"' changed zone from '"+this.fromZone.id+"' to '"+this.toZone.id+"'")}.bind(this)));var o=this.sprite.pos.x+this.sprite.hotspotOffset.x,s=this.sprite.pos.y+this.sprite.hotspotOffset.y;return this.switchRenderZone||this.fromZone.isInZone(o,s)||(this.switchRenderZone=!0),this.sprite.pos.z=(this.switchRenderZone?this.toZone:this.fromZone).getHeight(o,s),t>=e}}};var f,d},774:(t,e,n)=>{"use strict";n.r(e),n.d(e,{default:()=>i});const i={init:function(t){var e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};console.log("loading - chat"),this.engine=this.sprite.engine,this.text="",this.prompt=t,this.scrolling=e,this.line=0,this.options=n,this.completed=!1,this.lastKey=(new Date).getTime()},tick:function(t){var e;if(this.loaded)return this.options&&this.options.autoclose&&(this.endTime=this.endTime?this.endTime:null!==(e=this.options.endTime)&&void 0!==e?e:(new Date).getTime()+1e4,t>this.endTime&&(this.completed=!0)),this.checkInput(t),this.textbox=this.engine.scrollText(this.prompt+this.text,this.scrolling,this.options),this.completed},checkInput:function(t){if(t>this.lastKey+100){switch(this.engine.keyboard.lastPressedCode()){case"Escape":this.completed=!0;break;case"Backspace":var e=this.text.split("");e.pop(),this.text=e.join(""),this.lastKey=t;break;case"Enter":this.engine.setGreeting(this.text),this.completed=!0}var n=this.engine.keyboard.lastPressed("abcdefghijklmnopqrstuvwxyz., ");n&&(this.lastKey=t,this.text+=""+n)}}}},319:(t,e,n)=>{"use strict";n.r(e),n.d(e,{default:()=>i});const i={init:function(t){var e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};console.log("loading - dialogue"),this.engine=this.sprite.engine,this.text=t,this.scrolling=e,this.options=n,this.completed=!1},tick:function(t){var e;if(this.loaded)return this.options&&this.options.autoclose&&(this.endTime=this.endTime?this.endTime:null!==(e=this.options.endTime)&&void 0!==e?e:(new Date).getTime()+1e4,t>this.endTime&&(this.completed=!0)),this.checkInput(),this.textbox=this.engine.scrollText(this.text,this.scrolling,this.options),this.completed},checkInput:function(){return"q"===this.engine.keyboard.lastPressed("q")&&(console.log("closing dialogue"),this.completed=!0),null}}},277:(t,e,n)=>{"use strict";n.r(e),n.d(e,{default:()=>i});const i={init:function(t){console.log("loading - face"),this.facing=t},tick:function(t){return this.facing&&this.facing!=this.sprite.facing&&this.sprite.setFacing(this.facing),!0}}},941:(t,e,n)=>{"use strict";n.r(e),n.d(e,{default:()=>i});const i={init:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};console.log("loading - greeting"),this.engine=this.sprite.engine,this.greeting=t,this.options=e,this.completed=!1},tick:function(t){if(this.loaded)return this.engine.setGreeting(this.text),!0}}},841:(t,e,n)=>{"use strict";n.r(e),n.d(e,{default:()=>l});var i=n(968),r=n(979);function o(t,e,n){return o=s()?Reflect.construct:function(t,e,n){var i=[null];i.push.apply(i,e);var r=new(Function.bind.apply(t,i));return n&&a(r,n.prototype),r},o.apply(null,arguments)}function s(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}function a(t,e){return a=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},a(t,e)}function c(t){return function(t){if(Array.isArray(t))return u(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(t){if("string"==typeof t)return u(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?u(t,e):void 0}}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function u(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,i=new Array(e);n<e;n++)i[n]=t[n];return i}const l={init:function(t,e,n){console.log("loading - move"),this.from=o(i.OW,c(t)),this.to=o(i.OW,c(e)),this.facing=r.N.fromOffset([Math.round(e.x-t.x),Math.round(e.y-t.y)]),this.length=n},tick:function(t){if(this.loaded){this.facing&&this.facing!=this.sprite.facing&&this.sprite.setFacing(this.facing);var e=this.startTime+this.length,n=(t-this.startTime)/this.length;t>=e?((0,i.t8)(this.to,this.sprite.pos),n=1):(0,i.t7)(this.from,this.to,n,this.sprite.pos);var r=Math.floor(4*n);r!=this.sprite.animFrame&&this.sprite.setFrame(r);var o=this.sprite.pos.x+this.sprite.hotspotOffset.x,s=this.sprite.pos.y+this.sprite.hotspotOffset.y;return this.sprite.pos.z=this.sprite.zone.getHeight(o,s),t>=e}}}},908:(t,e,n)=>{"use strict";function i(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}n.d(e,{Z:()=>r});var r=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.actions=[]}var e,n;return e=t,n=[{key:"add",value:function(t){this.actions.push(t)}},{key:"run",value:function(){var t=arguments;this.actions=this.actions.filter((function(e){return e(t)}))}}],n&&i(e.prototype,n),t}()},979:(t,e,n)=>{"use strict";n.d(e,{T:()=>i,N:()=>r});var i={DOWN:1,UP:2,MOVE:3},r={None:0,Right:1,Up:2,Left:4,Down:8,All:15,fromOffset:function(t){return t[0]>0?r.Right:t[0]<0?r.Left:t[1]>0?r.Down:t[1]<0?r.Up:0},toOffset:function(t){switch(t){case r.Right:return[1,0];case r.Up:return[0,-1];case r.Left:return[-1,0];case r.Down:return[0,1]}return[0,0]},reverse:function(t){switch(t){case r.Right:return r.Left;case r.Up:return r.Down;case r.Left:return r.Right;case r.Down:return r.Up}return r.None},spriteSequence:function(t){switch(t){case r.Right:return"right";case r.Up:return"up";case r.Left:return"left";case r.Down:return"down"}return"down"}}},242:(t,e,n)=>{"use strict";n.d(e,{aW:()=>E,OP:()=>Z,jf:()=>L,e5:()=>T});var i=n(655),r=n(968),o=n(990),s=n(979),a=n(908);function c(t,e,n){return c=u()?Reflect.construct:function(t,e,n){var i=[null];i.push.apply(i,e);var r=new(Function.bind.apply(t,i));return n&&l(r,n.prototype),r},c.apply(null,arguments)}function u(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}function l(t,e){return l=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},l(t,e)}function h(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,i=new Array(e);n<e;n++)i[n]=t[n];return i}function f(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}var d=function(){function t(e,i){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.engine=e,this.templateLoaded=!1,this.drawOffset=new r.OW(0,0,0),this.hotspotOffset=new r.OW(0,0,0),this.animFrame=0,this.pos=new r.OW(0,0,0),this.facing=s.N.Right,this.actionDict={},this.actionList=[],this.onLoadActions=new a.Z,this.getTexCoords=this.getTexCoords.bind(this),this.templateLoaded=!0,Object.assign(this,n(183)("./"+i+".jsx").default),this.loadTexture(this)}var e,i;return e=t,(i=[{key:"runWhenLoaded",value:function(t){this.loaded?t():this.onLoadActions.add(t)}},{key:"loadTexture",value:function(t){var e;this.loaded||(this.src&&this.sheetSize&&this.tileSize&&this.frames?(this.zone=t.zone,t.id&&(this.id=t.id),t.pos&&(0,r.t8)(c(r.OW,function(t){if(Array.isArray(t))return h(t)}(e=t.pos)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(e)||function(t,e){if(t){if("string"==typeof t)return h(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?h(t,e):void 0}}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),this.pos),t.facing&&0!==t.facing&&(this.facing=t.facing),console.log("facing",s.N.spriteSequence(this.facing)),this.texture=this.engine.loadTexture(this.src),this.texture.runWhenLoaded(this.onTilesetOrTextureLoaded.bind(this)),this.vertexTexBuf=this.engine.createBuffer(this.getTexCoords(),this.engine.gl.DYNAMIC_DRAW,2),this.zone.tileset.runWhenDefinitionLoaded(this.loadTilesetGeometry.bind(this))):console.error("Invalid sprite definition"))}},{key:"loadTilesetGeometry",value:function(){var t=this.zone.tileset.tileSize,e=[this.tileSize[0]/t,this.tileSize[1]/t],n=[[0,0,0],[e[0],0,0],[e[0],0,e[1]],[0,0,e[1]]],i=[[n[2],n[3],n[0]],[n[2],n[0],n[1]]].flat(3);this.vertexPosBuf=this.engine.createBuffer(i,this.engine.gl.STATIC_DRAW,3),this.zone.tileset.runWhenLoaded(this.onTilesetOrTextureLoaded.bind(this))}},{key:"onTilesetOrTextureLoaded",value:function(){!this.loaded&&this.zone.tileset.loaded&&this.texture.loaded&&(this.init(),this.loaded=!0,this.onLoadActions.run(),console.log("Initialized sprite '"+this.id+"' in zone '"+this.zone.id+"'"))}},{key:"getTexCoords",value:function(){"player"==this.id&&console.log("texture frames",this.facing,s.N.spriteSequence(this.facing));var t=this.frames[s.N.spriteSequence(this.facing)][this.animFrame%4],e=this.sheetSize,n=this.tileSize,i=[(t[0]+n[0])/e[0],t[1]/e[1]],r=[t[0]/e[0],(t[1]+n[1])/e[1]],o=[i,[r[0],i[1]],r,[i[0],r[1]]];return[[o[0],o[1],o[2]],[o[0],o[2],o[3]]].flat(3)}},{key:"draw",value:function(){this.loaded&&(this.engine.mvPushMatrix(),(0,o.Iu)(this.engine.uViewMat,this.engine.uViewMat,this.drawOffset.toArray()),(0,o.Iu)(this.engine.uViewMat,this.engine.uViewMat,this.pos.toArray()),(0,o.U1)(this.engine.uViewMat,this.engine.uViewMat,this.engine.degToRad(this.engine.cameraAngle),[1,0,0]),this.engine.bindBuffer(this.vertexPosBuf,this.engine.shaderProgram.vertexPositionAttribute),this.engine.bindBuffer(this.vertexTexBuf,this.engine.shaderProgram.textureCoordAttribute),this.texture.attach(),this.engine.shaderProgram.setMatrixUniforms(),this.engine.gl.depthFunc(this.engine.gl.ALWAYS),this.engine.gl.drawArrays(this.engine.gl.TRIANGLES,0,this.vertexPosBuf.numItems),this.engine.gl.depthFunc(this.engine.gl.LESS),this.engine.mvPopMatrix())}},{key:"setFrame",value:function(t){this.animFrame=t,this.engine.updateBuffer(this.vertexTexBuf,this.getTexCoords())}},{key:"setFacing",value:function(t){console.log("setting face to "+s.N.spriteSequence(t)),t&&(this.facing=t),this.setFrame(this.animFrame)}},{key:"addAction",value:function(t){console.log("adding action"),this.actionDict[t.id]&&this.removeAction(t.id),this.actionDict[t.id]=t,this.actionList.push(t)}},{key:"removeAction",value:function(t){console.log("removing action"),this.actionList=this.actionList.filter((function(e){return e.id!==t})),delete this.actionDict[t]}},{key:"tickOuter",value:function(t){var e=this;if(this.loaded){this.actionList.sort((function(t,e){var n=t.startTime-e.startTime;return n?t.id>e.id?1:-1:n}));var n=[];this.actionList.forEach((function(e){!e.loaded||e.startTime>t||e.tick(t)&&n.push(e)})),n.forEach((function(t){return e.removeAction(t.id)})),this.tick&&this.tick(t)}}},{key:"init",value:function(){console.log("- sprite hook",this.id,this.pos)}}])&&f(e.prototype,i),t}();function p(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}var g=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.engine=e,this.src=null,this.sheetSize=[0,0],this.tileSize=0,this.tiles={},this.loaded=!1,this.onLoadActions=new a.Z,this.onDefinitionLoadActions=new a.Z,this.onTextureLoaded=this.onTextureLoaded.bind(this)}var e,n;return e=t,(n=[{key:"runWhenLoaded",value:function(t){this.loaded?t():this.onLoadActions.add(t)}},{key:"runWhenDefinitionLoaded",value:function(t){this.definitionLoaded?t():this.onDefinitionLoadActions.add(t)}},{key:"loadTileset",value:function(t){Object.assign(this,t),this.definitionLoaded=!0,this.onDefinitionLoadActions.run(),this.texture=this.engine.loadTexture(this.src),this.texture.runWhenLoaded(this.onTextureLoaded),this.bgColor&&this.engine.gl.clearColor(this.bgColor[0]/255,this.bgColor[1]/255,this.bgColor[2]/255,1)}},{key:"onTextureLoaded",value:function(){console.log("Initialized tileset '"+this.src+"'"),this.loaded=!0,this.onLoadActions.run()}},{key:"getTileVertices",value:function(t,e){return this.tileGeometry[t].vertices.map((function(t){return t.map((function(t){return[t[0]+e[0],t[1]+e[1],t[2]+e[2]]}))})).flat(3)}},{key:"getTileTexCoords",value:function(t,e){var n=this.tiles[e],i=[this.tileSize/this.sheetSize[0],this.tileSize/this.sheetSize[1]];return this.tileGeometry[t].tiles.map((function(t){return t.map((function(t){return[(t[0]+n[0])*i[0],(t[1]+n[1])*i[1]]}))})).flat(3)}},{key:"getWalkability",value:function(t){return this.tileGeometry[t].type}},{key:"getTileWalkPoly",value:function(t){return this.tileGeometry[t].w}}])&&p(e.prototype,n),t}();function y(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}var v=function(){function t(e,i){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.type=e,this.sprite=i,this.time=(new Date).getTime(),this.id=i.id+"-"+e+"-"+this.time,this.templateLoaded=!0,Object.assign(this,n(997)("./"+e+".jsx").default)}var e,i;return e=t,(i=[{key:"configure",value:function(t,e,n,i,r){this.sprite=e,this.id=n,this.type=t,this.startTime=i,this.creationArgs=r}},{key:"onLoad",value:function(t){this.init.apply(this,t),this.loaded=!0}},{key:"serialize",value:function(){return{id:this.id,time:this.startTime,zone:this.sprite.zone.id,sprite:this.sprite.id,type:this.type,args:this.creationArgs}}}])&&y(e.prototype,i),t}();function m(t,e,n,i,r,o,s){try{var a=t[o](s),c=a.value}catch(t){return void n(t)}a.done?e(c):Promise.resolve(c).then(i,r)}function A(t){return function(){var e=this,n=arguments;return new Promise((function(i,r){var o=t.apply(e,n);function s(t){m(o,i,r,s,a,"next",t)}function a(t){m(o,i,r,s,a,"throw",t)}s(void 0)}))}}function b(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function w(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function x(t,e,n){return e&&w(t.prototype,e),n&&w(t,n),t}var T=function(){function t(e){b(this,t),this.engine=e,this.tilesets={}}var e,r;return x(t,[{key:"loadRemote",value:(r=A(regeneratorRuntime.mark((function t(e){var n,r,o;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!(n=this.tilesets[e])){t.next=3;break}return t.abrupt("return",n);case 3:return this.tilesets[e]=n=new g(this.engine),n.name=e,t.next=7,fetch(i.Z.tilesetRequestUrl(e));case 7:if(!(r=t.sent).ok){t.next=21;break}return t.prev=9,t.next=12,r.json();case 12:return o=t.sent,t.next=15,n.loadTileset(o);case 15:t.next=21;break;case 17:t.prev=17,t.t0=t.catch(9),console.error("Error parsing tileset '"+n.name+"' definition"),console.error(t.t0);case 21:return t.abrupt("return",this.tilesets[e]);case 22:case"end":return t.stop()}}),t,this,[[9,17]])}))),function(t){return r.apply(this,arguments)})},{key:"load",value:(e=A(regeneratorRuntime.mark((function t(e){var i,r;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!(i=this.tilesets[e])){t.next=3;break}return t.abrupt("return",i);case 3:return r=new g(this.engine),this.tilesets[e]=r,r.loadTileset(n(267)("./"+e+".tileset.jsx").default),t.abrupt("return",r);case 7:case"end":return t.stop()}}),t,this)}))),function(t){return e.apply(this,arguments)})}]),t}(),L=function(){function t(e){b(this,t),this.engine=e,this.definitions=[],this.instances={}}var e;return x(t,[{key:"load",value:(e=A(regeneratorRuntime.mark((function t(e){var n;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return this.instances[e]||(this.instances[e]=[]),n=new d(this.engine,e),this.instances[e].push({instance:n}),t.abrupt("return",n);case 4:case"end":return t.stop()}}),t,this)}))),function(t){return e.apply(this,arguments)})}]),t}(),Z=function(){function t(e){b(this,t),this.engine=e,this.definitions=[],this.instances={}}var e;return x(t,[{key:"load",value:(e=A(regeneratorRuntime.mark((function t(e){var n;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return this.instances[e]||(this.instances[e]=[]),n=new Dialogue(this.engine,e),this.instances[e].push({instance:n}),t.abrupt("return",n);case 4:case"end":return t.stop()}}),t,this)}))),function(t){return e.apply(this,arguments)})}]),t}(),E=function(){function t(e,n,i){return b(this,t),this.engine=e.engine,this.type=n,this.args=i,this.sprite=e,this.instances={},this.definitions=[],this.time=(new Date).getTime(),this.id=e.id+"-"+n+"-"+time,this.load(n,i)}return x(t,[{key:"load",value:function(t,e){this.instances[t]||(this.instances[t]=[]);var n=new v(this.type,this.sprite);return n.configure(t,sprite,this.id,this.time,e),n.onLoad(e),n}}]),t}()},990:(t,e,n)=>{"use strict";function i(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var i,r,o=[],s=!0,a=!1;try{for(n=n.call(t);!(s=(i=n.next()).done)&&(o.push(i.value),!e||o.length!==e);s=!0);}catch(t){a=!0,r=t}finally{try{s||null==n.return||n.return()}finally{if(a)throw r}}return o}}(t,e)||function(t,e){if(t){if("string"==typeof t)return r(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?r(t,e):void 0}}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function r(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,i=new Array(e);n<e;n++)i[n]=t[n];return i}n.d(e,{Ue:()=>o,G3:()=>s,Iu:()=>a,U1:()=>c,t8:()=>u});var o=function(){var t=new Float32Array(16);return t[0]=1,t[5]=1,t[10]=1,t[15]=1,t},s=function(t,e,n,i){var r=new Float32Array(16),o=1/Math.tan(t/2);if(r[0]=o/e,r[1]=0,r[2]=0,r[3]=0,r[4]=0,r[5]=o,r[6]=0,r[7]=0,r[8]=0,r[9]=0,r[10]=-1,r[11]=-1,r[12]=0,r[13]=0,r[14]=-2*n,r[15]=0,null!=i&&i!==1/0&&i!==n){var s=1/(n-i);r[10]=(i+n)*s,r[14]=2*i*n*s}return r},a=function(t,e,n){var r=t,o=i(n,3),s=o[0],a=o[1],c=o[2],u=i(e,12),l=u[0],h=u[1],f=u[2],d=u[3],p=u[4],g=u[5],y=u[6],v=u[7],m=u[8],A=u[9],b=u[10],w=u[11];return t!==e&&(r[0]=l,r[1]=h,r[2]=f,r[3]=d,r[4]=p,r[5]=g,r[6]=y,r[7]=v,r[8]=m,r[9]=A,r[10]=b,r[11]=w),r[12]=l*s+p*a+m*c+e[12],r[13]=h*s+g*a+A*c+e[13],r[14]=f*s+y*a+b*c+e[14],r[15]=d*s+v*a+w*c+e[15],r},c=function(t,e,n,r){var o=t,s=i(r,3),a=s[0],c=s[1],u=s[2],l=Math.hypot(a,c,u);if(l<1e-6)throw new Error("Matrix4*4 rotate has wrong axis");a*=l=1/l,c*=l,u*=l;var h=Math.sin(n),f=Math.cos(n),d=1-f,p=i(e,12),g=p[0],y=p[1],v=p[2],m=p[3],A=p[4],b=p[5],w=p[6],x=p[7],T=p[8],L=p[9],Z=p[10],E=p[11],R=a*a*d+f,P=c*a*d+u*h,M=u*a*d-c*h,O=a*c*d-u*h,S=c*c*d+f,k=u*c*d+a*h,_=a*u*d+c*h,C=c*u*d-a*h,W=u*u*d+f;return o[0]=g*R+A*P+T*M,o[1]=y*R+b*P+L*M,o[2]=v*R+w*P+Z*M,o[3]=m*R+x*P+E*M,o[4]=g*O+A*S+T*k,o[5]=y*O+b*S+L*k,o[6]=v*O+w*S+Z*k,o[7]=m*O+x*S+E*k,o[8]=g*_+A*C+T*W,o[9]=y*_+b*C+L*W,o[10]=v*_+w*C+Z*W,o[11]=m*_+x*C+E*W,e!==t&&(o[12]=e[12],o[13]=e[13],o[14]=e[14],o[15]=e[15]),o};function u(t,e){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e}},968:(t,e,n)=>{"use strict";function i(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}n.d(e,{OW:()=>r,t8:()=>o,tk:()=>s,t7:()=>a});var r=function(){function t(e,n,i){(function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")})(this,t),this.x=e,this.y=n,this.z=i}return e=t,(n=[{key:"add",value:function(e){return new t(this.x+e.x,this.y+e.y,this.z+e.z)}},{key:"sub",value:function(e){return new t(this.x-e.x,this.y-e.y,this.z-e.z)}},{key:"mul",value:function(e){return new t(this.x*e,this.y*e,this.z*e)}},{key:"length",value:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}},{key:"distance",value:function(t){return this.sub(t).length()}},{key:"normal",value:function(){if(0===this.x&&0===this.y&&0===this.z)return new t(0,0,0);var e=this.length();return new t(this.x/e,this.y/e,this.z/e)}},{key:"dot",value:function(t){return this.x*t.x+this.y*t.y+this.z*t.z}},{key:"toArray",value:function(){return[this.x,this.y,this.z]}},{key:"toString",value:function(){return"( ".concat(this.x,", ").concat(this.y,", ").concat(this.z," )")}},{key:"negate",value:function(){return new t(-1*this.x,-1*this.y,-1*this.z)}}])&&i(e.prototype,n),r&&i(e,r),t;var e,n,r}();function o(t,e){e.x=t.x,e.y=t.y,e.z=t.z}function s(t,e){return e||(e=new r(-t.x,-t.y,-t.z)),e.x=-t.x,e.y=-t.y,e.z=-t.z,e}function a(t,e,n,i){return i||(i=t),i.x=t.x+n*(e.x-t.x),i.y=t.y+n*(e.y-t.y),i.z=t.z+n*(e.z-t.z),i}},655:(t,e,n)=>{"use strict";n.d(e,{Z:()=>i});const i={tilesetRequestUrl:function(t){return"/pixos/tilesets/"+t+".tileset.jsx"},zoneRequestUrl:function(t){return"/pixos/zones/"+t+".zone.jsx"},artResourceUrl:function(t){return"/pixos/art/"+t}}},701:(t,e,n)=>{"use strict";n.r(e),n.d(e,{default:()=>u});var i=n(968),r=n(979),o=n(242);function s(t,e,n){return s=a()?Reflect.construct:function(t,e,n){var i=[null];i.push.apply(i,e);var r=new(Function.bind.apply(t,i));return n&&c(r,n.prototype),r},s.apply(null,arguments)}function a(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}function c(t,e){return c=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},c(t,e)}const u={src:n(655).Z.artResourceUrl("player.gif"),sheetSize:[128,256],tileSize:[24,32],frames:{up:[[0,0],[24,0],[48,0],[24,0]],right:[[0,32],[24,32],[48,32],[24,32]],down:[[0,64],[24,64],[48,64],[24,64]],left:[[0,96],[24,96],[48,96],[24,96]]},drawOffset:new i.OW(-.25,1,.125),hotspotOffset:new i.OW(.5,.5,0),bindCamera:!0,tick:function(t){if(!this.actionList.length){var e=this.checkInput();e&&this.addAction(e)}this.bindCamera&&(0,i.t8)(this.pos,this.engine.cameraPosition)},checkInput:function(){var t=r.N.None;switch(this.engine.keyboard.lastPressedKey("wsadhm")){case"w":t=r.N.Up;break;case"s":t=r.N.Down;break;case"a":t=r.N.Left;break;case"d":t=r.N.Right;break;case"h":return new o.aW(this,"dialogue",["Welcome! You pressed help!",!1,{autoclose:!0}]);case"m":return new o.aW(this,"chat",[">:",!0,{autoclose:!1}]);default:return null}if(this.facing!==t)return this.faceDir(t);var e=this.pos,n=r.N.toOffset(t),a=s(i.OW,[Math.round(e.x+n[0]),Math.round(e.y+n[1]),0]);if(!this.zone.isInZone(a.x,a.y)){var c=this.zone.world.zoneContaining(a.x,a.y);return c&&c.loaded&&c.isWalkable(a.x,a.y,r.N.reverse(t))?new o.aW(this,"changezone",[this.zone.id,this.pos.toArray(),c.id,a.toArray(),600]):this.faceDir(t)}return this.zone.isWalkable(this.pos.x,this.pos.y,t)&&this.zone.isWalkable(a.x,a.y,r.N.reverse(t))?new o.aW(this,"move",[this.pos.toArray(),a.toArray(),600]):this.faceDir(t)},faceDir:function(t){return this.facing==t||t===r.N.None?null:new o.aW(this,"face",[t])},setGreeting:function(t){return new o.aW(this,"greeting",[t,{autoclose:!0}])}}},42:(t,e,n)=>{"use strict";n.r(e),n.d(e,{default:()=>o});var i=n(968),r=n(990);const o={src:n(655).Z.artResourceUrl("sewer.png"),sheetSize:[256,256],tileSize:[16,16],frames:{up:[[0,144],[16,144],[32,144],[48,144],[64,144],[80,144]]},drawOffset:new i.OW(0,1,.001),hotspotOffset:new i.OW(.5,.5,0),lastTime:0,accumTime:0,blowTime:0,frameTime:150,init:function(){this.blowTime=1e3+5e3*Math.random()},tick:function(t){0!=this.lastTime?(this.accumTime+=t-this.lastTime,this.accumTime<this.frameTime||0==this.animFrame&&this.accumTime<this.blowTime||(5==this.animFrame?(this.setFrame(0),this.blowTime=1e3+4e3*Math.random()):(this.setFrame(this.animFrame+1),this.accumTime=0,this.lastTime=t))):this.lastTime=t},draw:function(t){this.loaded&&(t.mvPushMatrix(),(0,r.Iu)(t.uViewMat,t.uViewMat,this.pos.toArray()),(0,r.Iu)(t.uViewMat,t.uViewMat,this.drawOffset.toArray()),(0,r.U1)(t.uViewMat,t.uViewMat,t.degToRad(90),[1,0,0]),t.bindBuffer(this.vertexPosBuf,t.shaderProgram.vertexPositionAttribute),t.bindBuffer(this.vertexTexBuf,t.shaderProgram.textureCoordAttribute),this.texture.attach(),t.shaderProgram.setMatrixUniforms(),t.gl.drawArrays(t.gl.TRIANGLES,0,this.vertexPosBuf.numItems),t.mvPopMatrix())}}},714:(t,e,n)=>{"use strict";n.r(e),n.d(e,{default:()=>s});var i=n(968),r=n(655),o=n(242);const s={src:r.Z.artResourceUrl("elementals.gif"),sheetSize:[64,128],tileSize:[16,18],frames:{up:[[0,0],[16,0],[32,0],[48,0]],right:[[0,18],[16,18],[32,18],[16,18]],down:[[0,36],[16,36],[32,36],[16,36]],left:[[48,0],[48,18],[48,36],[48,18]]},drawOffset:new i.OW(0,1,.2),hotspotOffset:new i.OW(.5,.5,0),tick:function(t){if(!this.actionList.length){var e=this.checkInput();e&&this.addAction(e)}},checkInput:function(){var t=Direction.None;switch(this.engine.keyboard.lastPressedKey("wsad")){case"w":t=Direction.Up;break;case"s":t=Direction.Down;break;case"a":t=Direction.Left;break;case"d":t=Direction.Right;break;default:return null}if(this.facing!==t)return this.faceDir(t)},faceDir:function(t){return this.facing==t||t===Direction.None?null:new o.aW(this,"face",[t])}}},669:(t,e,n)=>{"use strict";n.r(e),n.d(e,{default:()=>s});var i=n(968),r=n(655),o=n(242);const s={src:r.Z.artResourceUrl("elementals.gif"),sheetSize:[64,128],tileSize:[16,18],frames:{up:[[0,0],[16,0],[32,0],[48,0]],right:[[0,18],[16,18],[32,18],[16,18]],down:[[0,36],[16,36],[32,36],[16,36]],left:[[48,0],[48,18],[48,36],[48,18]]},drawOffset:new i.OW(0,1,.2),hotspotOffset:new i.OW(.5,.5,0),tick:function(t){if(!this.actionList.length){var e=this.checkInput();e&&this.addAction(e)}},checkInput:function(){var t=Direction.None;switch(this.engine.keyboard.lastPressedKey("wsad")){case"w":t=Direction.Up;break;case"s":t=Direction.Down;break;case"a":t=Direction.Left;break;case"d":t=Direction.Right;break;default:return null}if(this.facing!==t)return this.faceDir(t)},faceDir:function(t){return this.facing==t||t===Direction.None?null:new o.aW(this,"face",[t])}}},261:(t,e,n)=>{"use strict";n.r(e),n.d(e,{default:()=>s});var i=n(968),r=n(655),o=n(242);const s={src:r.Z.artResourceUrl("elementals.gif"),sheetSize:[64,128],tileSize:[16,18],frames:{up:[[0,54],[16,54],[32,54],[48,54]],right:[[0,72],[16,72],[32,72],[16,72]],down:[[0,90],[16,90],[32,90],[16,90]],left:[[48,54],[48,72],[48,90],[48,72]]},drawOffset:new i.OW(0,1,.2),hotspotOffset:new i.OW(.5,.5,0),tick:function(t){if(!this.actionList.length){var e=this.checkInput();e&&this.addAction(e)}},checkInput:function(){var t=Direction.None;switch(this.engine.keyboard.lastPressedKey("wsad")){case"w":t=Direction.Up;break;case"s":t=Direction.Down;break;case"a":t=Direction.Left;break;case"d":t=Direction.Right;break;default:return null}if(this.facing!==t)return this.faceDir(t)},faceDir:function(t){return this.facing==t||t===Direction.None?null:new o.aW(this,"face",[t])}}},222:(t,e,n)=>{"use strict";n.d(e,{Z:()=>i});const i={FLOOR:[0,0,0],LAVA:[1,14,-1.5],EMPTY:[0,20,2],N_STAIR:[0,13,-1,100,102,-1,104,102,-1,51,50,-1],N_STAIRWALL:[0,8,0,102,101,0,15],S_STAIR:[0,13,-1,100,102,-1,104,102,-1,53,50,-1],S_STAIRWALL:[0,4,0,106,100,0,15],L_STAIR:[0,15,-1,102,102,-1,106,102,-1,52,50,-1],L_STAIRWALL:[0,2,0,104,101,0,15],R_STAIR:[0,15,-1,102,102,-1,106,102,-1,50,50,-1],R_STAIRWALL:[0,6,0,100,101,0,15],N_WALL:[102,100,2,0,28,2],S_WALL:[106,100,2,0,24,2],L_WALL:[104,100,2,0,22,2],R_WALL:[100,100,2,0,26,2],NLW_CORNER:[0,31,2],NRW_CORNER:[0,30,2],SLW_CORNER:[0,32,2],SRW_CORNER:[0,29,2],NLW_COLUMN:[102,100,2,104,100,2,0,21,2],NRW_COLUMN:[100,100,2,102,100,2,0,27,2],SLW_COLUMN:[104,100,2,106,100,2,0,23,2],SRW_COLUMN:[100,100,2,106,100,2,0,25,2],NRW_LAVA_COLUMN:[100,100,2,100,101,0,102,100,2,102,101,0,0,27,2],NLW_LAVA_COLUMN:[102,100,2,104,100,2,0,21,2,104,101,0,102,101,0],SLW_LAVA_COLUMN:[104,100,2,106,100,2,0,23,2,104,101,0,106,101,0],SRW_LAVA_COLUMN:[100,100,2,100,101,0,106,100,2,106,101,0,0,25,2],NW_NPIT:[0,8,0,102,101,0],LW_LPIT:[0,2,0,104,101,0],RW_RPIT:[0,6,0,100,101,0],SW_SPIT:[0,4,0,106,101,0],C_WALKWAY:[0,16,-1],V_WALKWAY:[0,13,-1,100,102,-1,104,102,-1],H_WALKWAY:[0,15,-1,102,102,-1,106,102,-1]}},283:(t,e,n)=>{"use strict";n.r(e),n.d(e,{default:()=>i});const i={src:n(655).Z.artResourceUrl("sewer.png"),sheetSize:[256,256],tileSize:16,bgColor:[31,20,29],tiles:{0:[1,1],1:[2,2],2:[2,1],3:[2,0],4:[1,0],5:[0,0],6:[0,1],7:[0,2],8:[1,2],9:[4,1],10:[4,0],11:[3,0],12:[3,1],13:[3,2],14:[.5,7.5],15:[4,2],16:[3,3],20:[6,1],21:[7,2],22:[7,1],23:[7,0],24:[6,0],25:[5,0],26:[5,1],27:[5,2],28:[6,2],29:[9,1],30:[9,0],31:[8,0],32:[8,1],50:[5,3],100:[0,3],101:[0,5],102:[0,6]},tileGeometry:{0:{vertices:[[[0,1,0],[1,1,0],[1,0,0]],[[0,1,0],[1,0,0],[0,0,0]]],tiles:[[[0,1],[1,1],[1,0]],[[0,1],[1,0],[0,0]]],type:15},1:{vertices:[[[0,1,0],[1,1,0],[1,0,0]],[[0,1,0],[1,0,0],[0,0,0]]],tiles:[[[0,1],[1,1],[1,0]],[[0,1],[1,0],[0,0]]],type:0},50:{vertices:[[[.25,0,.25],[.25,1,.25],[.5,1,.25]],[[.25,0,.25],[.5,1,.25],[.5,0,.25]],[[.5,0,.5],[.5,1,.5],[.75,1,.5]],[[.5,0,.5],[.75,1,.5],[.75,0,.5]],[[.75,0,.75],[.75,1,.75],[1,1,.75]],[[.75,0,.75],[1,1,.75],[1,0,.75]],[[.25,0,0],[.25,1,0],[.25,1,.25]],[[.25,0,0],[.25,1,.25],[.25,0,.25]],[[.5,0,.25],[.5,1,.25],[.5,1,.5]],[[.5,0,.25],[.5,1,.5],[.5,0,.5]],[[.75,0,.5],[.75,1,.5],[.75,1,.75]],[[.75,0,.5],[.75,1,.75],[.75,0,.75]],[[1,0,.75],[1,1,.75],[1,1,1]],[[1,0,.75],[1,1,1],[1,0,1]],[[0,0,0],[1,0,0],[1,0,1]],[[0,0,0],[1,0,1],[0,0,1]],[[0,1,0],[1,1,0],[1,1,1]],[[0,1,0],[1,1,1],[0,1,1]]],tiles:[[[0,.75],[1,.75],[1,.5]],[[0,.75],[1,.5],[0,.5]],[[0,.5],[1,.5],[1,.25]],[[0,.5],[1,.25],[0,.25]],[[0,.25],[1,.25],[1,0]],[[0,.25],[1,0],[0,0]],[[0,2],[1,2],[1,1.75]],[[0,2],[1,1.75],[0,1.75]],[[0,1.75],[1,1.75],[1,1.5]],[[0,1.75],[1,1.5],[0,1.5]],[[0,1.5],[1,1.5],[1,1.25]],[[0,1.5],[1,1.25],[0,1.25]],[[0,1.25],[1,1.25],[1,1]],[[0,1.25],[1,1],[0,1]],[[0,3],[1,3],[1,2]],[[0,3],[1,2],[0,2]],[[0,3],[1,3],[1,2]],[[0,3],[1,2],[0,2]]],w:[[[0,1,0],[1,1,1],[1,0,1]],[[0,1,0],[1,0,1],[0,0,0]]],type:5},51:{vertices:[[[0,.75,.25],[1,.75,.25],[1,.5,.25]],[[0,.75,.25],[1,.5,.25],[0,.5,.25]],[[0,.5,.5],[1,.5,.5],[1,.25,.5]],[[0,.5,.5],[1,.25,.5],[0,.25,.5]],[[0,.25,.75],[1,.25,.75],[1,0,.75]],[[0,.25,.75],[1,0,.75],[0,0,.75]],[[0,.75,0],[1,.75,0],[1,.75,.25]],[[0,.75,0],[1,.75,.25],[0,.75,.25]],[[0,.5,.25],[1,.5,.25],[1,.5,.5]],[[0,.5,.25],[1,.5,.5],[0,.5,.5]],[[0,.25,.5],[1,.25,.5],[1,.25,.75]],[[0,.25,.5],[1,.25,.75],[0,.25,.75]],[[0,0,.75],[1,0,.75],[1,0,1]],[[0,0,.75],[1,0,1],[0,0,1]],[[0,1,0],[0,0,0],[0,0,1]],[[0,1,0],[0,0,1],[0,1,1]],[[1,1,0],[1,0,0],[1,0,1]],[[1,1,0],[1,0,1],[1,1,1]]],tiles:[[[0,.75],[1,.75],[1,.5]],[[0,.75],[1,.5],[0,.5]],[[0,.5],[1,.5],[1,.25]],[[0,.5],[1,.25],[0,.25]],[[0,.25],[1,.25],[1,0]],[[0,.25],[1,0],[0,0]],[[0,2],[1,2],[1,1.75]],[[0,2],[1,1.75],[0,1.75]],[[0,1.75],[1,1.75],[1,1.5]],[[0,1.75],[1,1.5],[0,1.5]],[[0,1.5],[1,1.5],[1,1.25]],[[0,1.5],[1,1.25],[0,1.25]],[[0,1.25],[1,1.25],[1,1]],[[0,1.25],[1,1],[0,1]],[[0,3],[1,3],[1,2]],[[0,3],[1,2],[0,2]],[[0,3],[1,3],[1,2]],[[0,3],[1,2],[0,2]]],w:[[[0,1,0],[1,1,0],[1,0,1]],[[0,1,0],[1,0,1],[0,0,1]]],type:10},52:{vertices:[[[.75,1,.25],[.75,0,.25],[.5,0,.25]],[[.75,1,.25],[.5,0,.25],[.5,1,.25]],[[.5,1,.5],[.5,0,.5],[.25,0,.5]],[[.5,1,.5],[.25,0,.5],[.25,1,.5]],[[.25,1,.75],[.25,0,.75],[0,0,.75]],[[.25,1,.75],[0,0,.75],[0,1,.75]],[[.75,1,0],[.75,0,0],[.75,0,.25]],[[.75,1,0],[.75,0,.25],[.75,1,.25]],[[.5,1,.25],[.5,0,.25],[.5,0,.5]],[[.5,1,.25],[.5,0,.5],[.5,1,.5]],[[.25,1,.5],[.25,0,.5],[.25,0,.75]],[[.25,1,.5],[.25,0,.75],[.25,1,.75]],[[0,1,.75],[0,0,.75],[0,0,1]],[[0,1,.75],[0,0,1],[0,1,1]],[[1,1,0],[0,1,0],[0,1,1]],[[1,1,0],[0,1,1],[1,1,1]],[[1,0,0],[0,0,0],[0,0,1]],[[1,0,0],[0,0,1],[1,0,1]]],tiles:[[[0,.75],[1,.75],[1,.5]],[[0,.75],[1,.5],[0,.5]],[[0,.5],[1,.5],[1,.25]],[[0,.5],[1,.25],[0,.25]],[[0,.25],[1,.25],[1,0]],[[0,.25],[1,0],[0,0]],[[0,2],[1,2],[1,1.75]],[[0,2],[1,1.75],[0,1.75]],[[0,1.75],[1,1.75],[1,1.5]],[[0,1.75],[1,1.5],[0,1.5]],[[0,1.5],[1,1.5],[1,1.25]],[[0,1.5],[1,1.25],[0,1.25]],[[0,1.25],[1,1.25],[1,1]],[[0,1.25],[1,1],[0,1]],[[0,3],[1,3],[1,2]],[[0,3],[1,2],[0,2]],[[0,3],[1,3],[1,2]],[[0,3],[1,2],[0,2]]],w:[[[0,1,1],[1,1,0],[1,0,0]],[[0,1,1],[1,0,0],[0,0,1]]],type:5},53:{vertices:[[[1,.25,.25],[0,.25,.25],[0,.5,.25]],[[1,.25,.25],[0,.5,.25],[1,.5,.25]],[[1,.5,.5],[0,.5,.5],[0,.75,.5]],[[1,.5,.5],[0,.75,.5],[1,.75,.5]],[[1,.75,.75],[0,.75,.75],[0,1,.75]],[[1,.75,.75],[0,1,.75],[1,1,.75]],[[1,.25,0],[0,.25,0],[0,.25,.25]],[[1,.25,0],[0,.25,.25],[1,.25,.25]],[[1,.5,.25],[0,.5,.25],[0,.5,.5]],[[1,.5,.25],[0,.5,.5],[1,.5,.5]],[[1,.75,.5],[0,.75,.5],[0,.75,.75]],[[1,.75,.5],[0,.75,.75],[1,.75,.75]],[[1,1,.75],[0,1,.75],[0,1,1]],[[1,1,.75],[0,1,1],[1,1,1]],[[1,0,0],[1,1,0],[1,1,1]],[[1,0,0],[1,1,1],[1,0,1]],[[0,0,0],[0,1,0],[0,1,1]],[[0,0,0],[0,1,1],[0,0,1]]],tiles:[[[0,.75],[1,.75],[1,.5]],[[0,.75],[1,.5],[0,.5]],[[0,.5],[1,.5],[1,.25]],[[0,.5],[1,.25],[0,.25]],[[0,.25],[1,.25],[1,0]],[[0,.25],[1,0],[0,0]],[[0,2],[1,2],[1,1.75]],[[0,2],[1,1.75],[0,1.75]],[[0,1.75],[1,1.75],[1,1.5]],[[0,1.75],[1,1.5],[0,1.5]],[[0,1.5],[1,1.5],[1,1.25]],[[0,1.5],[1,1.25],[0,1.25]],[[0,1.25],[1,1.25],[1,1]],[[0,1.25],[1,1],[0,1]],[[0,3],[1,3],[1,2]],[[0,3],[1,2],[0,2]],[[0,3],[1,3],[1,2]],[[0,3],[1,2],[0,2]]],w:[[[0,1,1],[1,1,1],[1,0,0]],[[0,1,1],[1,0,0],[0,0,0]]],type:10},100:{vertices:[[[0,0,-2],[0,1,-2],[0,1,0]],[[0,0,-2],[0,1,0],[0,0,0]]],tiles:[[[0,2],[1,2],[1,0]],[[0,2],[1,0],[0,0]]],type:11},102:{vertices:[[[0,1,-2],[1,1,-2],[1,1,0]],[[0,1,-2],[1,1,0],[0,1,0]]],tiles:[[[0,2],[1,2],[1,0]],[[0,2],[1,0],[0,0]]],type:7},104:{vertices:[[[1,1,-2],[1,0,-2],[1,0,0]],[[1,1,-2],[1,0,0],[1,1,0]]],tiles:[[[0,2],[1,2],[1,0]],[[0,2],[1,0],[0,0]]],type:14},106:{vertices:[[[1,0,-2],[0,0,-2],[0,0,0]],[[1,0,-2],[0,0,0],[1,0,0]]],tiles:[[[0,2],[1,2],[1,0]],[[0,2],[1,0],[0,0]]],type:13}}}},493:(t,e,n)=>{"use strict";n.r(e),n.d(e,{default:()=>r});var i=n(222);const r={bounds:[0,10,17,19],tileset:"sewer",cells:[i.Z.SLW_CORNER,i.Z.SLW_COLUMN,i.Z.FLOOR,i.Z.FLOOR,i.Z.LW_LPIT,i.Z.LAVA,i.Z.LAVA,i.Z.LAVA,i.Z.V_WALKWAY,i.Z.LAVA,i.Z.LAVA,i.Z.LAVA,i.Z.RW_RPIT,i.Z.FLOOR,i.Z.FLOOR,i.Z.SRW_COLUMN,i.Z.SRW_CORNER].concat([i.Z.EMPTY,i.Z.SLW_CORNER,i.Z.S_WALL,i.Z.S_WALL,i.Z.S_WALL,i.Z.SLW_LAVA_COLUMN,i.Z.LAVA,i.Z.LAVA,i.Z.S_STAIR,i.Z.LAVA,i.Z.LAVA,i.Z.SRW_LAVA_COLUMN,i.Z.S_WALL,i.Z.S_WALL,i.Z.S_WALL,i.Z.SRW_CORNER,i.Z.EMPTY],[i.Z.EMPTY,i.Z.EMPTY,i.Z.EMPTY,i.Z.EMPTY,i.Z.EMPTY,i.Z.L_WALL,i.Z.SW_SPIT,i.Z.SW_SPIT,i.Z.S_STAIRWALL,i.Z.SW_SPIT,i.Z.SW_SPIT,i.Z.R_WALL,i.Z.EMPTY,i.Z.EMPTY,i.Z.EMPTY,i.Z.EMPTY,i.Z.EMPTY],[i.Z.EMPTY,i.Z.EMPTY,i.Z.EMPTY,i.Z.EMPTY,i.Z.EMPTY,i.Z.L_WALL,i.Z.FLOOR,i.Z.FLOOR,i.Z.FLOOR,i.Z.FLOOR,i.Z.FLOOR,i.Z.R_WALL,i.Z.EMPTY,i.Z.EMPTY,i.Z.EMPTY,i.Z.EMPTY,i.Z.EMPTY],[i.Z.EMPTY,i.Z.EMPTY,i.Z.EMPTY,i.Z.EMPTY,i.Z.EMPTY,i.Z.L_WALL,i.Z.FLOOR,i.Z.FLOOR,i.Z.FLOOR,i.Z.FLOOR,i.Z.FLOOR,i.Z.R_WALL,i.Z.EMPTY,i.Z.EMPTY,i.Z.EMPTY,i.Z.EMPTY,i.Z.EMPTY],[i.Z.EMPTY,i.Z.EMPTY,i.Z.EMPTY,i.Z.EMPTY,i.Z.EMPTY,i.Z.SLW_CORNER,i.Z.SLW_COLUMN,i.Z.FLOOR,i.Z.FLOOR,i.Z.FLOOR,i.Z.SRW_COLUMN,i.Z.SRW_CORNER,i.Z.EMPTY,i.Z.EMPTY,i.Z.EMPTY,i.Z.EMPTY,i.Z.EMPTY],[i.Z.EMPTY,i.Z.EMPTY,i.Z.EMPTY,i.Z.EMPTY,i.Z.EMPTY,i.Z.EMPTY,i.Z.SLW_CORNER,i.Z.S_WALL,i.Z.S_WALL,i.Z.S_WALL,i.Z.SRW_CORNER,i.Z.EMPTY,i.Z.EMPTY,i.Z.EMPTY,i.Z.EMPTY,i.Z.EMPTY,i.Z.EMPTY],[i.Z.EMPTY,i.Z.EMPTY,i.Z.EMPTY,i.Z.EMPTY,i.Z.EMPTY,i.Z.EMPTY,i.Z.EMPTY,i.Z.EMPTY,i.Z.EMPTY,i.Z.EMPTY,i.Z.EMPTY,i.Z.EMPTY,i.Z.EMPTY,i.Z.EMPTY,i.Z.EMPTY,i.Z.EMPTY,i.Z.EMPTY],[i.Z.EMPTY,i.Z.EMPTY,i.Z.EMPTY,i.Z.EMPTY,i.Z.EMPTY,i.Z.EMPTY,i.Z.EMPTY,i.Z.EMPTY,i.Z.EMPTY,i.Z.EMPTY,i.Z.EMPTY,i.Z.EMPTY,i.Z.EMPTY,i.Z.EMPTY,i.Z.EMPTY,i.Z.EMPTY,i.Z.EMPTY]),sprites:[{id:"e1",type:"monsters/water_elemental",pos:[8,13,0],facing:2},{id:"spurt7",type:"effects/lavaspurt",pos:[7,10,-1.5],facing:2},{id:"spurt9",type:"effects/lavaspurt",pos:[10,10,-1.5],facing:2}]}},468:(t,e,n)=>{"use strict";n.r(e),n.d(e,{default:()=>r});var i=n(222);const r={bounds:[0,0,17,10],tileset:"sewer",cells:[i.Z.EMPTY,i.Z.EMPTY,i.Z.EMPTY,i.Z.EMPTY,i.Z.EMPTY,i.Z.EMPTY,i.Z.NLW_CORNER,i.Z.N_WALL,i.Z.N_WALL,i.Z.N_WALL,i.Z.NRW_CORNER,i.Z.EMPTY,i.Z.EMPTY,i.Z.EMPTY,i.Z.EMPTY,i.Z.EMPTY,i.Z.EMPTY].concat([i.Z.EMPTY,i.Z.EMPTY,i.Z.EMPTY,i.Z.EMPTY,i.Z.EMPTY,i.Z.NLW_CORNER,i.Z.NLW_COLUMN,i.Z.FLOOR,i.Z.FLOOR,i.Z.FLOOR,i.Z.NRW_COLUMN,i.Z.NRW_CORNER,i.Z.EMPTY,i.Z.EMPTY,i.Z.EMPTY,i.Z.EMPTY,i.Z.EMPTY],[i.Z.EMPTY,i.Z.EMPTY,i.Z.EMPTY,i.Z.EMPTY,i.Z.EMPTY,i.Z.L_WALL,i.Z.FLOOR,i.Z.FLOOR,i.Z.FLOOR,i.Z.FLOOR,i.Z.FLOOR,i.Z.R_WALL,i.Z.EMPTY,i.Z.EMPTY,i.Z.EMPTY,i.Z.EMPTY,i.Z.EMPTY],[i.Z.EMPTY,i.Z.EMPTY,i.Z.EMPTY,i.Z.EMPTY,i.Z.EMPTY,i.Z.L_WALL,i.Z.FLOOR,i.Z.FLOOR,i.Z.FLOOR,i.Z.FLOOR,i.Z.FLOOR,i.Z.R_WALL,i.Z.EMPTY,i.Z.EMPTY,i.Z.EMPTY,i.Z.EMPTY,i.Z.EMPTY],[i.Z.EMPTY,i.Z.EMPTY,i.Z.EMPTY,i.Z.EMPTY,i.Z.EMPTY,i.Z.L_WALL,i.Z.NW_NPIT,i.Z.NW_NPIT,i.Z.N_STAIRWALL,i.Z.NW_NPIT,i.Z.NW_NPIT,i.Z.R_WALL,i.Z.EMPTY,i.Z.EMPTY,i.Z.EMPTY,i.Z.EMPTY,i.Z.EMPTY],[i.Z.EMPTY,i.Z.NLW_CORNER,i.Z.N_WALL,i.Z.N_WALL,i.Z.N_WALL,i.Z.NLW_LAVA_COLUMN,i.Z.LAVA,i.Z.LAVA,i.Z.N_STAIR,i.Z.LAVA,i.Z.LAVA,i.Z.NRW_LAVA_COLUMN,i.Z.N_WALL,i.Z.N_WALL,i.Z.N_WALL,i.Z.NRW_CORNER,i.Z.EMPTY],[i.Z.NLW_CORNER,i.Z.NLW_COLUMN,i.Z.FLOOR,i.Z.FLOOR,i.Z.LW_LPIT,i.Z.LAVA,i.Z.LAVA,i.Z.LAVA,i.Z.V_WALKWAY,i.Z.LAVA,i.Z.LAVA,i.Z.LAVA,i.Z.RW_RPIT,i.Z.FLOOR,i.Z.FLOOR,i.Z.NRW_COLUMN,i.Z.NRW_CORNER],[i.Z.L_WALL,i.Z.FLOOR,i.Z.FLOOR,i.Z.FLOOR,i.Z.LW_LPIT,i.Z.LAVA,i.Z.LAVA,i.Z.LAVA,i.Z.V_WALKWAY,i.Z.LAVA,i.Z.LAVA,i.Z.LAVA,i.Z.RW_RPIT,i.Z.FLOOR,i.Z.FLOOR,i.Z.FLOOR,i.Z.R_WALL],[i.Z.L_WALL,i.Z.FLOOR,i.Z.FLOOR,i.Z.FLOOR,i.Z.L_STAIRWALL,i.Z.L_STAIR,i.Z.H_WALKWAY,i.Z.H_WALKWAY,i.Z.C_WALKWAY,i.Z.H_WALKWAY,i.Z.H_WALKWAY,i.Z.R_STAIR,i.Z.R_STAIRWALL,i.Z.FLOOR,i.Z.FLOOR,i.Z.FLOOR,i.Z.R_WALL],[i.Z.L_WALL,i.Z.FLOOR,i.Z.FLOOR,i.Z.FLOOR,i.Z.LW_LPIT,i.Z.LAVA,i.Z.LAVA,i.Z.LAVA,i.Z.V_WALKWAY,i.Z.LAVA,i.Z.LAVA,i.Z.LAVA,i.Z.RW_RPIT,i.Z.FLOOR,i.Z.FLOOR,i.Z.FLOOR,i.Z.R_WALL]),sprites:[{id:"e2",type:"monsters/air_elemental",pos:[8,2,0],facing:8},{id:"e3",type:"monsters/fire_elemental",pos:[2,8,0],facing:1},{id:"e4",type:"monsters/water_elemental",pos:[14,8,0],facing:4},{id:"spurt1",type:"effects/lavaspurt",pos:[10,7,-1.5],facing:2},{id:"spurt2",type:"effects/lavaspurt",pos:[9,6,-1.5],facing:2},{id:"spurt3",type:"effects/lavaspurt",pos:[10,5,-1.5],facing:2},{id:"spurt4",type:"effects/lavaspurt",pos:[7,6,-1.5],facing:2},{id:"spurt5",type:"effects/lavaspurt",pos:[6,7,-1.5],facing:2},{id:"spurt6",type:"effects/lavaspurt",pos:[6,9,-1.5],facing:2},{id:"spurt8",type:"effects/lavaspurt",pos:[9,9,-1.5],facing:2},{id:"player",type:"characters/player",pos:[8,8,-1],facing:8}]}},541:(t,e,n)=>{"use strict";n.d(e,{Z:()=>a});var i=n(537),r=n.n(i),o=n(645),s=n.n(o)()(r());s.push([t.id,"/*                                                 *** ----------------------------------------------- **\n**             Calliope - Site Generator   \t       **\n** ----------------------------------------------- **\n**  Copyright (c) 2020-2021 - Kyle Derby MacInnis  **\n**                                                 **\n**    Any unauthorized distribution or transfer    **\n**       of this work is strictly prohibited.      **\n**                                                 **\n**               All Rights Reserved.              **\n** ----------------------------------------------- **\n\\*                                                 */\n.pixos {\n    font-family: Arial, Helvetica, sans-serif;\n    font-size: 16px;\n    width: 100%;\n    text-shadow: #3f3f3f 2px 2px 0px;\n    position: relative;\n    padding: 2.5em;\n    align-items: center;\n    align-content: center; }\n  \n  .renderSurface {\n    height: 100%;\n    left: 0;\n    position: absolute;\n    top: 0;\n    width: 100%; }\n  \n  .materialSelector {\n    background: rgba(0, 0, 0, 0.6);\n    margin: auto;\n    position: relative; }\n    .materialSelector tr {\n      height: 70px; }\n    .materialSelector td {\n      background-position: 0px 0px;\n      cursor: pointer;\n      margin: 0;\n      opacity: 0.3;\n      padding: 0;\n      width: 70px; }\n      .materialSelector td:hover {\n        opacity: 0.8; }\n  \n  .nickname {\n    color: #ffffff;\n    cursor: default;\n    left: 42%;\n    position: absolute;\n    top: 40%;\n    width: 300px; }\n    .nickname input {\n      background: none;\n      border-bottom: 1px solid #888888;\n      border: none;\n      color: white;\n      font-family: Arial, Helvetica, sans-serif;\n      font-size: 24px;\n      outline: none;\n      width: 100%; }\n  \n  .joininfo {\n    color: #ffffff;\n    cursor: default;\n    font-size: 24px;\n    position: absolute;\n    text-align: center;\n    top: 42%;\n    width: 99%; }\n  \n  .chatbox {\n    background: rgba(0, 0, 0, 0.6);\n    bottom: 55px;\n    color: white;\n    cursor: default;\n    height: 195px;\n    left: 20px;\n    overflow: hidden;\n    padding-left: 10px;\n    padding-right: 10px;\n    position: absolute;\n    width: 600px; }\n  \n  .chatbox_text {\n    bottom: 8px;\n    position: absolute;\n    text-shadow: none; }\n  \n  .chatbox_entry {\n    background: rgba(0, 0, 0, 0.6);\n    border: none;\n    bottom: 18px;\n    color: white;\n    font-family: Arial, Helvetica, sans-serif;\n    font-size: 16px;\n    height: 30px;\n    left: 20px;\n    outline: none;\n    padding-bottom: 2px;\n    padding-left: 10px;\n    position: absolute;\n    width: 610px; }\n  ","",{version:3,sources:["webpack://./css/pixos.css"],names:[],mappings:"AAAA;;;;;;;;;;oDAUoD;AACpD;IACI,yCAAyC;IACzC,eAAe;IACf,WAAW;IACX,gCAAgC;IAChC,kBAAkB;IAClB,cAAc;IACd,mBAAmB;IACnB,qBAAqB,EAAE;;EAEzB;IACE,YAAY;IACZ,OAAO;IACP,kBAAkB;IAClB,MAAM;IACN,WAAW,EAAE;;EAEf;IACE,8BAA8B;IAC9B,YAAY;IACZ,kBAAkB,EAAE;IACpB;MACE,YAAY,EAAE;IAChB;MACE,4BAA4B;MAC5B,eAAe;MACf,SAAS;MACT,YAAY;MACZ,UAAU;MACV,WAAW,EAAE;MACb;QACE,YAAY,EAAE;;EAEpB;IACE,cAAc;IACd,eAAe;IACf,SAAS;IACT,kBAAkB;IAClB,QAAQ;IACR,YAAY,EAAE;IACd;MACE,gBAAgB;MAChB,gCAAgC;MAChC,YAAY;MACZ,YAAY;MACZ,yCAAyC;MACzC,eAAe;MACf,aAAa;MACb,WAAW,EAAE;;EAEjB;IACE,cAAc;IACd,eAAe;IACf,eAAe;IACf,kBAAkB;IAClB,kBAAkB;IAClB,QAAQ;IACR,UAAU,EAAE;;EAEd;IACE,8BAA8B;IAC9B,YAAY;IACZ,YAAY;IACZ,eAAe;IACf,aAAa;IACb,UAAU;IACV,gBAAgB;IAChB,kBAAkB;IAClB,mBAAmB;IACnB,kBAAkB;IAClB,YAAY,EAAE;;EAEhB;IACE,WAAW;IACX,kBAAkB;IAClB,iBAAiB,EAAE;;EAErB;IACE,8BAA8B;IAC9B,YAAY;IACZ,YAAY;IACZ,YAAY;IACZ,yCAAyC;IACzC,eAAe;IACf,YAAY;IACZ,UAAU;IACV,aAAa;IACb,mBAAmB;IACnB,kBAAkB;IAClB,kBAAkB;IAClB,YAAY,EAAE",sourcesContent:["/*                                                 *** ----------------------------------------------- **\n**             Calliope - Site Generator   \t       **\n** ----------------------------------------------- **\n**  Copyright (c) 2020-2021 - Kyle Derby MacInnis  **\n**                                                 **\n**    Any unauthorized distribution or transfer    **\n**       of this work is strictly prohibited.      **\n**                                                 **\n**               All Rights Reserved.              **\n** ----------------------------------------------- **\n\\*                                                 */\n.pixos {\n    font-family: Arial, Helvetica, sans-serif;\n    font-size: 16px;\n    width: 100%;\n    text-shadow: #3f3f3f 2px 2px 0px;\n    position: relative;\n    padding: 2.5em;\n    align-items: center;\n    align-content: center; }\n  \n  .renderSurface {\n    height: 100%;\n    left: 0;\n    position: absolute;\n    top: 0;\n    width: 100%; }\n  \n  .materialSelector {\n    background: rgba(0, 0, 0, 0.6);\n    margin: auto;\n    position: relative; }\n    .materialSelector tr {\n      height: 70px; }\n    .materialSelector td {\n      background-position: 0px 0px;\n      cursor: pointer;\n      margin: 0;\n      opacity: 0.3;\n      padding: 0;\n      width: 70px; }\n      .materialSelector td:hover {\n        opacity: 0.8; }\n  \n  .nickname {\n    color: #ffffff;\n    cursor: default;\n    left: 42%;\n    position: absolute;\n    top: 40%;\n    width: 300px; }\n    .nickname input {\n      background: none;\n      border-bottom: 1px solid #888888;\n      border: none;\n      color: white;\n      font-family: Arial, Helvetica, sans-serif;\n      font-size: 24px;\n      outline: none;\n      width: 100%; }\n  \n  .joininfo {\n    color: #ffffff;\n    cursor: default;\n    font-size: 24px;\n    position: absolute;\n    text-align: center;\n    top: 42%;\n    width: 99%; }\n  \n  .chatbox {\n    background: rgba(0, 0, 0, 0.6);\n    bottom: 55px;\n    color: white;\n    cursor: default;\n    height: 195px;\n    left: 20px;\n    overflow: hidden;\n    padding-left: 10px;\n    padding-right: 10px;\n    position: absolute;\n    width: 600px; }\n  \n  .chatbox_text {\n    bottom: 8px;\n    position: absolute;\n    text-shadow: none; }\n  \n  .chatbox_entry {\n    background: rgba(0, 0, 0, 0.6);\n    border: none;\n    bottom: 18px;\n    color: white;\n    font-family: Arial, Helvetica, sans-serif;\n    font-size: 16px;\n    height: 30px;\n    left: 20px;\n    outline: none;\n    padding-bottom: 2px;\n    padding-left: 10px;\n    position: absolute;\n    width: 610px; }\n  "],sourceRoot:""}]);const a=s},645:t=>{"use strict";t.exports=function(t){var e=[];return e.toString=function(){return this.map((function(e){var n="",i=void 0!==e[5];return e[4]&&(n+="@supports (".concat(e[4],") {")),e[2]&&(n+="@media ".concat(e[2]," {")),i&&(n+="@layer".concat(e[5].length>0?" ".concat(e[5]):""," {")),n+=t(e),i&&(n+="}"),e[2]&&(n+="}"),e[4]&&(n+="}"),n})).join("")},e.i=function(t,n,i,r,o){"string"==typeof t&&(t=[[null,t,void 0]]);var s={};if(i)for(var a=0;a<this.length;a++){var c=this[a][0];null!=c&&(s[c]=!0)}for(var u=0;u<t.length;u++){var l=[].concat(t[u]);i&&s[l[0]]||(void 0!==o&&(void 0===l[5]||(l[1]="@layer".concat(l[5].length>0?" ".concat(l[5]):""," {").concat(l[1],"}")),l[5]=o),n&&(l[2]?(l[1]="@media ".concat(l[2]," {").concat(l[1],"}"),l[2]=n):l[2]=n),r&&(l[4]?(l[1]="@supports (".concat(l[4],") {").concat(l[1],"}"),l[4]=r):l[4]="".concat(r)),e.push(l))}},e}},537:t=>{"use strict";t.exports=function(t){var e=t[1],n=t[3];if(!n)return e;if("function"==typeof btoa){var i=btoa(unescape(encodeURIComponent(JSON.stringify(n)))),r="sourceMappingURL=data:application/json;charset=utf-8;base64,".concat(i),o="/*# ".concat(r," */"),s=n.sources.map((function(t){return"/*# sourceURL=".concat(n.sourceRoot||"").concat(t," */")}));return[e].concat(s).concat([o]).join("\n")}return[e].join("\n")}},679:(t,e,n)=>{"use strict";var i=n(864),r={childContextTypes:!0,contextType:!0,contextTypes:!0,defaultProps:!0,displayName:!0,getDefaultProps:!0,getDerivedStateFromError:!0,getDerivedStateFromProps:!0,mixins:!0,propTypes:!0,type:!0},o={name:!0,length:!0,prototype:!0,caller:!0,callee:!0,arguments:!0,arity:!0},s={$$typeof:!0,compare:!0,defaultProps:!0,displayName:!0,propTypes:!0,type:!0},a={};function c(t){return i.isMemo(t)?s:a[t.$$typeof]||r}a[i.ForwardRef]={$$typeof:!0,render:!0,defaultProps:!0,displayName:!0,propTypes:!0},a[i.Memo]=s;var u=Object.defineProperty,l=Object.getOwnPropertyNames,h=Object.getOwnPropertySymbols,f=Object.getOwnPropertyDescriptor,d=Object.getPrototypeOf,p=Object.prototype;t.exports=function t(e,n,i){if("string"!=typeof n){if(p){var r=d(n);r&&r!==p&&t(e,r,i)}var s=l(n);h&&(s=s.concat(h(n)));for(var a=c(e),g=c(n),y=0;y<s.length;++y){var v=s[y];if(!(o[v]||i&&i[v]||g&&g[v]||a&&a[v])){var m=f(n,v);try{u(e,v,m)}catch(t){}}}}return e}},703:(t,e,n)=>{"use strict";var i=n(414);function r(){}function o(){}o.resetWarningCache=r,t.exports=function(){function t(t,e,n,r,o,s){if(s!==i){var a=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw a.name="Invariant Violation",a}}function e(){return t}t.isRequired=t;var n={array:t,bool:t,func:t,number:t,object:t,string:t,symbol:t,any:t,arrayOf:e,element:t,elementType:t,instanceOf:e,node:t,objectOf:e,oneOf:e,oneOfType:e,shape:e,exact:e,checkPropTypes:o,resetWarningCache:r};return n.PropTypes=n,n}},697:(t,e,n)=>{t.exports=n(703)()},414:t=>{"use strict";t.exports="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED"},921:(t,e)=>{"use strict";var n="function"==typeof Symbol&&Symbol.for,i=n?Symbol.for("react.element"):60103,r=n?Symbol.for("react.portal"):60106,o=n?Symbol.for("react.fragment"):60107,s=n?Symbol.for("react.strict_mode"):60108,a=n?Symbol.for("react.profiler"):60114,c=n?Symbol.for("react.provider"):60109,u=n?Symbol.for("react.context"):60110,l=n?Symbol.for("react.async_mode"):60111,h=n?Symbol.for("react.concurrent_mode"):60111,f=n?Symbol.for("react.forward_ref"):60112,d=n?Symbol.for("react.suspense"):60113,p=n?Symbol.for("react.suspense_list"):60120,g=n?Symbol.for("react.memo"):60115,y=n?Symbol.for("react.lazy"):60116,v=n?Symbol.for("react.block"):60121,m=n?Symbol.for("react.fundamental"):60117,A=n?Symbol.for("react.responder"):60118,b=n?Symbol.for("react.scope"):60119;function w(t){if("object"==typeof t&&null!==t){var e=t.$$typeof;switch(e){case i:switch(t=t.type){case l:case h:case o:case a:case s:case d:return t;default:switch(t=t&&t.$$typeof){case u:case f:case y:case g:case c:return t;default:return e}}case r:return e}}}function x(t){return w(t)===h}e.AsyncMode=l,e.ConcurrentMode=h,e.ContextConsumer=u,e.ContextProvider=c,e.Element=i,e.ForwardRef=f,e.Fragment=o,e.Lazy=y,e.Memo=g,e.Portal=r,e.Profiler=a,e.StrictMode=s,e.Suspense=d,e.isAsyncMode=function(t){return x(t)||w(t)===l},e.isConcurrentMode=x,e.isContextConsumer=function(t){return w(t)===u},e.isContextProvider=function(t){return w(t)===c},e.isElement=function(t){return"object"==typeof t&&null!==t&&t.$$typeof===i},e.isForwardRef=function(t){return w(t)===f},e.isFragment=function(t){return w(t)===o},e.isLazy=function(t){return w(t)===y},e.isMemo=function(t){return w(t)===g},e.isPortal=function(t){return w(t)===r},e.isProfiler=function(t){return w(t)===a},e.isStrictMode=function(t){return w(t)===s},e.isSuspense=function(t){return w(t)===d},e.isValidElementType=function(t){return"string"==typeof t||"function"==typeof t||t===o||t===h||t===a||t===s||t===d||t===p||"object"==typeof t&&null!==t&&(t.$$typeof===y||t.$$typeof===g||t.$$typeof===c||t.$$typeof===u||t.$$typeof===f||t.$$typeof===m||t.$$typeof===A||t.$$typeof===b||t.$$typeof===v)},e.typeOf=w},864:(t,e,n)=>{"use strict";t.exports=n(921)},872:(t,e,n)=>{"use strict";n.d(e,{collect:()=>q});const i={currentComponent:null,isBatchUpdating:!1,isInBrowser:"undefined"!=typeof window,listeners:new Map,manualListeners:[],nextVersionMap:new WeakMap,proxyIsMuted:!1,redirectToNext:!0,store:{}},r=Symbol("PATH"),o=Symbol("ORIGINAL"),s="RR_DEBUG",a=t=>!!t&&"object"==typeof t&&t.constructor===Object,c=t=>Array.isArray(t),u=t=>t instanceof Map,l=t=>t instanceof Set,h=t=>a(t)||c(t)||u(t)||l(t),f=t=>t===r||"constructor"===t||"toJSON"===t||"@@toStringTag"===t||t===Symbol.toStringTag,d=t=>"function"==typeof t,p=t=>a(t)?Object.assign({},t):c(t)?t.slice():u(t)?new Map(t):l(t)?new Set(t):t,g=(t,e)=>u(t)?t.get(e):l(t)?e:(c(t),t[e]),y=(t,e,n)=>{if(a(t))t[e]=n;else if(c(t))t[e]=n;else if(u(t))t.set(e,n);else{if(!l(t))throw Error("Unexpected type");t.add(n)}},v=t=>{if(a(t))return Object.keys(t).length;if(c(t))return t.length;if(u(t)||l(t))return t.size;throw Error("Unexpected type")},m=(t,e)=>{const n=[],i=t=>{const r=e(t,n.slice()),o=void 0!==r?r:t,s=(t,e)=>{n.push(t);const r=i(e);n.pop(),y(o,t,r)};if(a(o))Object.entries(o).forEach((([t,e])=>{s(t,e)}));else if(c(o)||u(o))o.forEach(((t,e)=>{s(e,t)}));else if(l(o)){const t=Array.from(o);o.clear(),t.forEach((t=>{s(t,t)}))}return o};return i(t)},A=t=>{i.proxyIsMuted=!0;const e=t();return i.proxyIsMuted=!1,e},b=(t,e)=>t.map((t=>t.toString())).join(e),w=t=>b(t,"."),x=t=>b(t,"~~~"),T=(t,e)=>{const n=t[r]||[];return void 0===e?n:n.concat(e)},L=(t,e)=>w(T(t,e)),Z=(t,e)=>{t&&Object.defineProperty(t,r,{value:e,writable:!0})},E=t=>t[r]||[],R="undefined"!=typeof window&&!!window.localStorage,P=(t,e)=>{if(R)try{const n="string"==typeof e?e:JSON.stringify(e);return localStorage.setItem(t,n)}catch(t){return}},M="on",O="off";let S=(t=>{if(!R)return;const e=localStorage.getItem("RR_DEBUG");if(!e)return e;try{return JSON.parse(e)}catch(t){return e}})()||O;S===M&&console.info("Recollect debugging is enabled. Type __RR__.debugOff() to turn it off.");const k=t=>{S===M&&t()},_=(t,e,n)=>{k((()=>{console.groupCollapsed(`GET: ${L(t,e)}`),console.info(`Component: <${i.currentComponent._name}>`),void 0!==n&&console.info("Value:",n),console.groupEnd()}))},C=(t,e,n)=>{k((()=>{console.groupCollapsed(`SET: ${L(t,e)}`),console.info("From:",g(t,e)),console.info("To:  ",n),console.groupEnd()}))},W={},Y=t=>W.UpdateNextStore(t),I=t=>{if(!i.currentComponent)return;const e=x(t),n=i.listeners.get(e)||new Set;n.add(i.currentComponent),i.listeners.set(e,n)},N=t=>{return new Proxy(t,u(e=t)||l(e)?{get(t,e){if(e===o)return t;let n=Reflect.get(t,e);if(d(n)&&(n=n.bind(t)),i.proxyIsMuted||f(e))return n;if(!i.currentComponent&&i.redirectToNext){const n=i.nextVersionMap.get(t);if(n)return Reflect.get(n,e)}return"set"===e?new Proxy(n,{apply:(n,i,[r,o])=>i.get(r)===o||Y({target:i,prop:r,value:o,updater:(n,i)=>(C(t,e,i),Reflect.apply(n[e],n,[r,i]))})}):"add"===e?new Proxy(n,{apply:(n,i,[r])=>!!i.has(r)||Y({target:i,notifyTarget:!0,value:r,updater:(n,i)=>(C(t,e,i),Reflect.apply(n[e],n,[i]))})}):"clear"===e||"delete"===e?new Proxy(n,{apply:(n,i,[r])=>!(!i.size||"delete"===e&&!i.has(r))&&Y({target:i,notifyTarget:!0,updater:n=>(C(t,e),Reflect.apply(n[e],n,[r]))})}):i.currentComponent&&u(t)&&"get"===e?new Proxy(n,{apply:(e,n,i)=>(I(T(t,i[0])),Reflect.apply(e,n,i))}):n}}:{get(t,e){if(e===o)return t;const n=Reflect.get(t,e);if(i.proxyIsMuted||f(e))return n;if(((t,e)=>c(t)&&["copyWithin","fill","pop","push","reverse","shift","sort","splice","unshift"].includes(e))(t,e))return new Proxy(n,{apply:(n,i,r)=>Y({target:i,notifyTarget:!0,value:r,updater:(n,i)=>{C(t,e,i);const r=Reflect.apply(n[e],n,i),o=E(t);return m(n,((t,e)=>{h(t)&&Z(t,[...o,...e])})),r}})});if(d(t[e]))return n;if(i.currentComponent)c(t)&&"length"===e||(_(t,e,n),I(T(t,e)));else if(i.redirectToNext){const n=i.nextVersionMap.get(t);if(n)return Reflect.get(n,e)}return n},has(t,e){const n=Reflect.has(t,e);if(i.proxyIsMuted||f(e))return n;if(i.currentComponent)c(t)||(_(t,e),I(T(t,e)));else{const n=i.nextVersionMap.get(t);if(n)return Reflect.has(n,e)}return n},ownKeys(t){const e=Reflect.ownKeys(t);if(i.proxyIsMuted)return e;if(i.currentComponent)_(t),I(E(t));else{const e=i.nextVersionMap.get(t);if(e)return Reflect.ownKeys(e)}return e},set:(t,e,n)=>i.proxyIsMuted?Reflect.set(t,e,n):t[e]===n||Y({target:t,prop:e,value:n,updater:(n,i)=>(C(t,e,i),Reflect.set(n,e,i))}),deleteProperty:(t,e)=>i.proxyIsMuted?Reflect.deleteProperty(t,e):Y({target:t,prop:e,notifyTarget:!0,updater:n=>(((t,e)=>{k((()=>{console.groupCollapsed(`DELETE: ${L(t,e)}`),console.info("Property: ",L(t,e)),console.groupEnd()}))})(t,e),Reflect.deleteProperty(n,e))})});var e};var B=n(111);const z=n.n(B)().unstable_batchedUpdates||(t=>{t()}),D={components:new Map,changedPaths:new Set};var U;i.store=N({}),U=({target:t,prop:e,value:n,notifyTarget:r=!1,updater:s})=>A((()=>{let a;const c=E(t),u=T(t,e);let l=!1;const f=v(t);let d=n;return h(d)&&(d=m(n,((t,e)=>{if(!h(t))return t;const n=p(t);return Z(n,[...u,...e]),N(n)}))),c.length?c.reduce(((e,n,r)=>{const u=g(e,n);let h=p(u);return Z(h,E(u)),h=N(h),y(e,n,h),r===c.length-1&&(a=s(h,d),l=v(h)!==f,i.nextVersionMap.set(t[o]||t,h)),h}),i.store):(a=s(i.store,d),l=v(i.store)!==f),(t=>{const e=x(t),n=w(t);D.changedPaths.add(n),i.listeners.forEach(((t,i)=>{""!==e&&e!==i||t.forEach((t=>{const e=D.components.get(t)||new Set;e.add(n),D.components.set(t,e)}))})),i.isBatchUpdating||(z((()=>{D.components.forEach(((t,e)=>{((t,e)=>{k((()=>{console.groupCollapsed(`UPDATE:  <${t._name}>`),console.info("Changed properties:",e),console.groupEnd()}))})(e,Array.from(t)),e.update()}))})),i.manualListeners.forEach((t=>t({changedProps:Array.from(D.changedPaths),renderedComponents:Array.from(D.components.keys()),store:i.store}))),D.components.clear(),D.changedPaths.clear())})(r||l?c:u),a})),W.UpdateNextStore=U;var F=n(156),j=n.n(F),V=n(679),K=n.n(V);const $=[],G=()=>{i.isInBrowser&&(k((()=>{console.groupEnd()})),$.pop(),i.currentComponent=$[$.length-1]||null)},H=()=>A((()=>{const t=Object.assign({},i.store);return i.nextVersionMap.set(t,i.store),N(t)})),q=t=>{const e=t.displayName||t.name||"NamelessComponent";class n extends j().PureComponent{constructor(){super(...arguments),this.state={store:H()},this._isMounted=!1,this._isMounting=!0,this._isRendering=!1,this._name=e}componentDidMount(){this._isMounted=!0,this._isMounting=!1,G(),this._isRendering=!1}componentDidUpdate(){G(),this._isRendering=!1}componentWillUnmount(){var t;t=this,i.listeners.forEach(((e,n)=>{const r=Array.from(e).filter((e=>e!==t));r.length?i.listeners.set(n,new Set(r)):i.listeners.delete(n)})),this._isMounted=!1}update(){(this._isMounted||this._isMounting)&&this.setState({store:H()})}render(){var e;this._isRendering||(e=this,i.isInBrowser&&(k((()=>{console.groupCollapsed(`RENDER: <${e._name}>`)})),i.currentComponent=e,$.push(i.currentComponent)),this._isRendering=!0);const n=Object.assign(Object.assign({},this.props),{store:this.state.store});return j().createElement(t,Object.assign({},n))}}return n.displayName=`Collected(${e})`,K()(n,t)};let X;X=n(697);const{store:J}=i;"undefined"!=typeof window&&("Proxy"in window?window.__RR__={debugOn:()=>{S=M,P(s,M)},debugOff:()=>{S=O,P(s,O)},internals:i}:console.warn("This browser doesn't support the Proxy object, which react-recollect needs. See https://caniuse.com/#search=proxy to find out which browsers do support it"))},565:(t,e,n)=>{t.exports=n(872)},379:t=>{"use strict";var e=[];function n(t){for(var n=-1,i=0;i<e.length;i++)if(e[i].identifier===t){n=i;break}return n}function i(t,i){for(var o={},s=[],a=0;a<t.length;a++){var c=t[a],u=i.base?c[0]+i.base:c[0],l=o[u]||0,h="".concat(u," ").concat(l);o[u]=l+1;var f=n(h),d={css:c[1],media:c[2],sourceMap:c[3],supports:c[4],layer:c[5]};if(-1!==f)e[f].references++,e[f].updater(d);else{var p=r(d,i);i.byIndex=a,e.splice(a,0,{identifier:h,updater:p,references:1})}s.push(h)}return s}function r(t,e){var n=e.domAPI(e);return n.update(t),function(e){if(e){if(e.css===t.css&&e.media===t.media&&e.sourceMap===t.sourceMap&&e.supports===t.supports&&e.layer===t.layer)return;n.update(t=e)}else n.remove()}}t.exports=function(t,r){var o=i(t=t||[],r=r||{});return function(t){t=t||[];for(var s=0;s<o.length;s++){var a=n(o[s]);e[a].references--}for(var c=i(t,r),u=0;u<o.length;u++){var l=n(o[u]);0===e[l].references&&(e[l].updater(),e.splice(l,1))}o=c}}},569:t=>{"use strict";var e={};t.exports=function(t,n){var i=function(t){if(void 0===e[t]){var n=document.querySelector(t);if(window.HTMLIFrameElement&&n instanceof window.HTMLIFrameElement)try{n=n.contentDocument.head}catch(t){n=null}e[t]=n}return e[t]}(t);if(!i)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");i.appendChild(n)}},216:t=>{"use strict";t.exports=function(t){var e=document.createElement("style");return t.setAttributes(e,t.attributes),t.insert(e,t.options),e}},636:(t,e,n)=>{"use strict";t.exports=function(t){var e=n.nc;e&&t.setAttribute("nonce",e)}},795:t=>{"use strict";t.exports=function(t){var e=t.insertStyleElement(t);return{update:function(n){!function(t,e,n){var i="";n.supports&&(i+="@supports (".concat(n.supports,") {")),n.media&&(i+="@media ".concat(n.media," {"));var r=void 0!==n.layer;r&&(i+="@layer".concat(n.layer.length>0?" ".concat(n.layer):""," {")),i+=n.css,r&&(i+="}"),n.media&&(i+="}"),n.supports&&(i+="}");var o=n.sourceMap;o&&"undefined"!=typeof btoa&&(i+="\n/*# sourceMappingURL=data:application/json;base64,".concat(btoa(unescape(encodeURIComponent(JSON.stringify(o))))," */")),e.styleTagTransform(i,t,e.options)}(e,t,n)},remove:function(){!function(t){if(null===t.parentNode)return!1;t.parentNode.removeChild(t)}(e)}}}},589:t=>{"use strict";t.exports=function(t,e){if(e.styleSheet)e.styleSheet.cssText=t;else{for(;e.firstChild;)e.removeChild(e.firstChild);e.appendChild(document.createTextNode(t))}}},156:e=>{"use strict";e.exports=t},111:t=>{"use strict";t.exports=e}},i={};function r(t){var e=i[t];if(void 0!==e)return e.exports;var o=i[t]={id:t,exports:{}};return n[t](o,o.exports,r),o.exports}r.n=t=>{var e=t&&t.__esModule?()=>t.default:()=>t;return r.d(e,{a:e}),e},r.d=(t,e)=>{for(var n in e)r.o(e,n)&&!r.o(t,n)&&Object.defineProperty(t,n,{enumerable:!0,get:e[n]})},r.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),r.r=t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})};var o={};return(()=>{"use strict";r.r(o),r.d(o,{default:()=>rt});var t=r(156),e=r.n(t),n=r(565),i=r(697),s=r.n(i),a=r(990),c=r(968),u=r(908);function l(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}var h=function(){function t(e,n){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.engine=n,this.src=e,this.glTexture=n.gl.createTexture(),this.image=new Image,this.image.onload=this.onImageLoaded.bind(this),this.image.src=e,this.loaded=!1,this.onLoadActions=new u.Z}var e,n;return e=t,(n=[{key:"runWhenLoaded",value:function(t){this.loaded?t():this.onLoadActions.add(t)}},{key:"onImageLoaded",value:function(){var t=this.engine.gl;console.log("loaded image '"+this.src+"'"),t.bindTexture(t.TEXTURE_2D,this.glTexture),t.texImage2D(t.TEXTURE_2D,0,t.RGBA,t.RGBA,t.UNSIGNED_BYTE,this.image),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MAG_FILTER,t.NEAREST),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,t.NEAREST),t.bindTexture(t.TEXTURE_2D,null),this.loaded=!0,this.onLoadActions.run()}},{key:"attach",value:function(){var t=this.engine.gl;t.activeTexture(t.TEXTURE0),t.bindTexture(t.TEXTURE_2D,this.glTexture),t.uniform1i(this.engine.shaderProgram.samplerUniform,0)}}])&&l(e.prototype,n),t}();function f(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}var d=new FontFace("minecraftia","url(/minecraftia.ttf)"),p=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.ctx=e,this.dirty=!0,this.scrollY=0,this.fontSize=24,this.font="minecraftia",this.align="left",this.background="#999",this.border={lineWidth:4,style:"white",corner:"round"},this.scrollBox={width:5,background:"#568",color:"#78a"},this.fontStyle="white",this.lines=[]}var e,n;return e=t,n=[{key:"init",value:function(t,e,n,i,r){var o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:{};this.text=t,this.x=e,this.y=n,this.width=i,this.height=r,this.setOptions(o),this.cleanit()}},{key:"cleanit",value:function(t){this.dirty&&(this.setFont(),this.getTextPos(),this.dirty=!1,t||this.fitText())}},{key:"setOptions",value:function(t){var e=this;Object.keys(this).forEach((function(n){void 0!==t[n]&&(e[n]=t[n],e.dirty=!0)}))}},{key:"setFont",value:function(){this.fontStr=this.fontSize+"px "+this.font,this.textHeight=this.fontSize+Math.ceil(.05*this.fontSize)}},{key:"getTextPos",value:function(){"left"===this.align?this.textPos=0:"right"===this.align?this.textPos=Math.floor(this.width-this.scrollBox.width-this.fontSize/4):this.textPos=Math.floor((this.width- -this.scrollBox.width)/2)}},{key:"fitText",value:function(){var t=this.ctx;this.cleanit(!0),t.font=this.fontStr,t.textAlign=this.align,t.textBaseline="top";var e=this.text.split(" ");this.lines.length=0;for(var n="",i="";e.length>0;){var r=e.shift();t.measureText(n+i+r).width<this.width-this.scrollBox.width-this.scrollBox.width?(n+=i+r,i=" "):(""===i?n+=r:e.unshift(r),this.lines.push(n),i="",n="")}""!==n&&this.lines.push(n),this.maxScroll=(this.lines.length+.5)*this.textHeight-this.height}},{key:"drawBorder",value:function(){var t=this.ctx,e=this.border.lineWidth/2;t.lineJoin=this.border.corner,t.lineWidth=this.border.lineWidth,t.strokeStyle=this.border.style,t.strokeRect(this.x-e,this.y-e,this.width+2*e,this.height+2*e)}},{key:"drawScrollBox",value:function(){var t=this.ctx,e=this.height/(this.lines.length*this.textHeight);t.fillStyle=this.scrollBox.background,t.fillRect(this.x+this.width-this.scrollBox.width,this.y,this.scrollBox.width,this.height),t.fillStyle=this.scrollBox.color;var n=this.height*e;n>this.height&&(n=this.height),t.fillRect(this.x+this.width-this.scrollBox.width,this.y-this.scrollY*e,this.scrollBox.width,n)}},{key:"scroll",value:function(t){this.cleanit(),this.scrollY=-t,this.scrollY>0?this.scrollY=0:this.scrollY<-this.maxScroll&&(this.scrollY=-this.maxScroll)}},{key:"scrollLines",value:function(t){this.cleanit(),this.scrollY=-this.textHeight*t,this.scrollY>0?this.scrollY=0:this.scrollY<-this.maxScroll&&(this.scrollY=-this.maxScroll)}},{key:"render",value:function(){var t=this.ctx;this.cleanit(),t.font=this.fontStr,t.textAlign=this.align,this.drawBorder(),t.save(),t.fillStyle=this.background,t.fillRect(this.x,this.y,this.width,this.height),this.drawScrollBox(),t.beginPath(),t.rect(this.x,this.y,this.width-this.scrollBox.width,this.height),t.clip(),t.setTransform(1,0,0,1,this.x,Math.floor(this.y+this.scrollY)),t.fillStyle=this.fontStyle;for(var e=0;e<this.lines.length;e++)t.fillText(this.lines[e],this.textPos,Math.floor(e*this.textHeight));t.restore()}}],n&&f(e.prototype,n),t}();function g(t,e,n,i,r,o,s){try{var a=t[o](s),c=a.value}catch(t){return void n(t)}a.done?e(c):Promise.resolve(c).then(i,r)}function y(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}var v=function(){function t(e,n,i,r){var o,s,u=this;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),s=function(t,e){var n=e.vs,i=e.fs,r=u,o=u.loadShader(t,t.VERTEX_SHADER,n),s=u.loadShader(t,t.FRAGMENT_SHADER,i),a=t.createProgram();if(t.attachShader(a,o),t.attachShader(a,s),t.linkProgram(a),!t.getProgramParameter(a,t.LINK_STATUS))throw new Error("WebGL unable to initialize the shader program: ".concat(t.getshaderProgramLog(a)));return t.useProgram(a),a.vertexPositionAttribute=t.getAttribLocation(a,"aVertexPosition"),t.enableVertexAttribArray(a.vertexPositionAttribute),a.textureCoordAttribute=t.getAttribLocation(a,"aTextureCoord"),t.enableVertexAttribArray(a.textureCoordAttribute),a.pMatrixUniform=t.getUniformLocation(a,"uPMatrix"),a.mvMatrixUniform=t.getUniformLocation(a,"uMVMatrix"),a.samplerUniform=t.getUniformLocation(a,"uSampler"),a.setMatrixUniforms=function(){t.uniformMatrix4fv(this.pMatrixUniform,!1,r.uProjMat),t.uniformMatrix4fv(this.mvMatrixUniform,!1,r.uViewMat)},u.shaderProgram=a,a},(o="initShaderProgram")in this?Object.defineProperty(this,o,{value:s,enumerable:!0,configurable:!0,writable:!0}):this[o]=s,this.shaders={fs:"\n  precision mediump float;\n  varying vec2 vTextureCoord;\n  uniform sampler2D uSampler;\n  \n  void main(void) {\n    gl_FragColor = texture2D(uSampler, vec2(vTextureCoord.s, vTextureCoord.t));\n    if(gl_FragColor.a < 0.1)\n        discard;\n  }\n",vs:"\n  attribute vec3 aVertexPosition;\n  attribute vec2 aTextureCoord;\n  \n  uniform mat4 uMVMatrix;\n  uniform mat4 uPMatrix;\n  \n  varying vec2 vTextureCoord;\n  \n  void main(void) {\n    gl_Position = uPMatrix * uMVMatrix * vec4(aVertexPosition, 1.0);\n    vTextureCoord = aTextureCoord;\n  }\n"},this.uViewMat=(0,a.Ue)(),this.uProjMat=(0,a.Ue)(),this.canvas=e,this.hud=n,this.width=i,this.height=r,this.modelViewMatrixStack=[],this.globalStore={},this.textures=[],this.cameraAngle=45,this.cameraPosition=new c.OW(0,0,0),this.cameraOffset=new c.OW(0,0,0),this.setCamera=this.setCamera.bind(this),this.render=this.render.bind(this)}var e,n,i,r;return e=t,n=[{key:"init",value:(i=regeneratorRuntime.mark((function t(e,n){var i,r;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(i=this.hud.getContext("2d"),r=this.canvas.getContext("webgl")){t.next=4;break}throw new Error("WebGL : unable to initialize");case 4:if(i){t.next=6;break}throw new Error("Canvas : unable to initialize HUD");case 6:return this.gl=r,this.ctx=i,this.time=(new Date).getTime(),this.scene=e,this.keyboard=n,i.canvas.width=this.canvas.width,i.canvas.height=this.canvas.height,r.viewportWidth=this.canvas.width,r.viewportHeight=this.canvas.height,r.clearColor(0,1,0,1),r.clearDepth(1),r.enable(r.DEPTH_TEST),r.blendFunc(r.SRC_ALPHA,r.ONE_MINUS_SRC_ALPHA),r.enable(r.BLEND),this.initializedWebGl=!0,this.initShaderProgram(r,this.shaders),this.initProjection(r),t.next=25,e.init(this);case 25:case"end":return t.stop()}}),t,this)})),r=function(){var t=this,e=arguments;return new Promise((function(n,r){var o=i.apply(t,e);function s(t){g(o,n,r,s,a,"next",t)}function a(t){g(o,n,r,s,a,"throw",t)}s(void 0)}))},function(t,e){return r.apply(this,arguments)})},{key:"loadShader",value:function(t,e,n){var i=t.createShader(e);if(t.shaderSource(i,n),t.compileShader(i),!t.getShaderParameter(i,t.COMPILE_STATUS)){var r=t.getShaderInfoLog(i);throw t.deleteShader(i),new Error("An error occurred compiling the shaders: ".concat(r))}return i}},{key:"initProjection",value:function(t){var e=this.degToRad(45),n=t.canvas.clientWidth/t.canvas.clientHeight;this.uProjMat=(0,a.G3)(e,n,.1,100),this.uViewMat=(0,a.Ue)(),this.uProjMat[5]*=-1}},{key:"setCamera",value:function(){(0,a.Iu)(this.uViewMat,this.uViewMat,[0,0,-15]),(0,a.U1)(this.uViewMat,this.uViewMat,this.degToRad(this.cameraAngle),[1,0,0]),(0,c.tk)(this.cameraPosition,this.cameraOffset),(0,a.Iu)(this.uViewMat,this.uViewMat,this.cameraOffset.toArray())}},{key:"clearScreen",value:function(){var t=this.gl;t.viewport(0,0,t.viewportWidth,t.viewportHeight),t.clear(t.COLOR_BUFFER_BIT|t.DEPTH_BUFFER_BIT),(0,a.G3)(this.degToRad(45),t.viewportWidth/t.viewportHeight,.1,100,this.uProjMat),this.uViewMat=(0,a.Ue)()}},{key:"clearHud",value:function(){var t=this.ctx;t.clearRect(0,0,t.canvas.width,t.canvas.height)}},{key:"writeText",value:function(t,e,n){var i=this.ctx;i.save(),i.font="20px minecraftia",i.textAlign="center",i.textBaseline="middle",i.fillStyle="white",i.fillText(t,null!=e?e:i.canvas.width/2,null!=n?n:i.canvas.height/2),i.restore()}},{key:"setGreeting",value:function(t){this.globalStore.greeting=t}},{key:"scrollText",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},i=new p(this.ctx);return i.init(t,10,2*this.canvas.height/3,this.canvas.width-20,this.canvas.height/3-20,n),e&&i.scroll((Math.sin((new Date).getTime()/3e3)+1)*i.maxScroll*.5),i.render(),i}},{key:"drawButton",value:function(t,e,n,i,r){var o=this.ctx,s=i/2;o.save(),o.fillStyle=r.background,o.beginPath(),o.rect(t,e,n,i),o.rect(t,e,n,i),o.fill(),o.clip();var a=o.createLinearGradient(t,e,t,e+s);a.addColorStop(0,"rgb(221,181,155)"),a.addColorStop(1,"rgb(22,13,8)"),o.fillStyle=a,o.globalAlpha=.5,o.fillRect(t,e,n,i),o.fillStyle=r.top;for(var c=0;c<i;c+=s){o.fillStyle=0===c?r.top:r.bottom;for(var u=0;u<50;u++){var l=t+Math.random()*n,h=e+c+Math.random()*s,f=10*Math.random(),d=10*Math.random(),p=360*Math.random(),g=Math.random();o.save(),o.translate(l,h),o.rotate(p*Math.PI/180),o.translate(-l,-h),o.globalAlpha=g,o.fillRect(l,h,f,d),o.restore()}}o.restore()}},{key:"render",value:function(){var t;this.requestId=requestAnimationFrame(this.render),this.clearScreen(),this.clearHud(),this.scene.render(this,(new Date).getTime()),this.writeText(null!==(t=this.globalStore.greeting)&&void 0!==t?t:"")}},{key:"createBuffer",value:function(t,e,n){var i=this.gl,r=i.createBuffer();return r.itemSize=n,r.numItems=t.length/n,i.bindBuffer(i.ARRAY_BUFFER,r),i.bufferData(i.ARRAY_BUFFER,new Float32Array(t),e),i.bindBuffer(i.ARRAY_BUFFER,null),r}},{key:"updateBuffer",value:function(t,e){var n=this.gl;n.bindBuffer(n.ARRAY_BUFFER,t),n.bufferSubData(n.ARRAY_BUFFER,0,new Float32Array(e)),n.bindBuffer(n.ARRAY_BUFFER,null)}},{key:"bindBuffer",value:function(t,e){var n=this.gl;n.bindBuffer(n.ARRAY_BUFFER,t),n.vertexAttribPointer(e,t.itemSize,n.FLOAT,!1,0,0)}},{key:"loadTexture",value:function(t){return this.textures[t]||(this.textures[t]=new h(t,this)),this.textures[t]}},{key:"mvPushMatrix",value:function(){var t=(0,a.Ue)();(0,a.t8)(this.uViewMat,t),this.modelViewMatrixStack.push(t)}},{key:"mvPopMatrix",value:function(){if(0==this.modelViewMatrixStack.length)throw"Invalid popMatrix!";this.uViewMat=this.modelViewMatrixStack.pop()}},{key:"close",value:function(){cancelAnimationFrame(this.requestId)}},{key:"degToRad",value:function(t){return t*Math.PI/180}}],n&&y(e.prototype,n),t}(),m=r(979);function A(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}var b=function(){function t(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),t._instance||(this.activeKeys=[],this.activeCodes=[],this.shift=!1,t._instance=this),t._instance}var e,n;return e=t,n=[{key:"onKeyDown",value:function(e){e.preventDefault();var n=String.fromCharCode(e.keyCode).toLowerCase();t._instance.activeKeys.indexOf(n)<0&&t._instance.activeKeys.push(n),t._instance.activeCodes.indexOf(e.key)<0&&t._instance.activeCodes.push(e.key),t._instance.shift=e.shiftKey}},{key:"onKeyUp",value:function(e){var n=String.fromCharCode(e.keyCode).toLowerCase(),i=t._instance.activeKeys.indexOf(n);t._instance.activeKeys.splice(i,1),t._instance.activeCodes.splice(i,1)}},{key:"lastPressed",value:function(e){for(var n=e.toLowerCase(),i=null,r=-1,o=0;o<e.length;o++){var s=n[o],a=t._instance.activeKeys.indexOf(s);a>r&&(i=s,r=a)}return i}},{key:"lastPressedCode",value:function(){for(var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",n=t._instance.activeCodes[t._instance.activeCodes.length-1],i=e.toLowerCase(),r=0;r<i.length;r++){var o=t._instance.activeKeys.indexOf(n);o<0&&(n=t._instance.activeCodes.pop())}return n}},{key:"lastPressedKey",value:function(){return t._instance.activeKeys[t._instance.activeCodes.length-1]}}],n&&A(e.prototype,n),t}();function w(t,e,n,i,r,o,s){try{var a=t[o](s),c=a.value}catch(t){return void n(t)}a.done?e(c):Promise.resolve(c).then(i,r)}function x(t){return function(){var e=this,n=arguments;return new Promise((function(i,r){var o=t.apply(e,n);function s(t){w(o,i,r,s,a,"next",t)}function a(t){w(o,i,r,s,a,"throw",t)}s(void 0)}))}}var T=function(n){var i=n.width,r=n.height,o=n.SceneProvider,s=n.class,a=(0,t.useRef)(),c=(0,t.useRef)(),u=new b,l=o.onMouseEvent,h=o.onKeyEvent;return(0,t.useEffect)(x(regeneratorRuntime.mark((function t(){var e,n,s;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e=a.current,n=c.current,s=new v(e,n,i,r),t.next=5,d.load();case 5:return document.fonts.add(d),t.next=8,s.init(o,u);case 8:return s.render(),t.abrupt("return",(function(){s.close()}));case 10:case"end":return t.stop()}}),t)}))),[o]),e().createElement("div",{style:{position:"relative"}},e().createElement("canvas",{style:{position:"absolute",zIndex:1,top:0,left:0},ref:a,width:i,height:r,className:s}),e().createElement("canvas",{style:{zIndex:2,top:0,left:0,background:"none"},tabIndex:0,ref:c,width:i,height:r,className:s,onKeyDownCapture:function(t){return h(t.nativeEvent)},onKeyUpCapture:function(t){return h(t.nativeEvent)},onContextMenu:function(t){return l(t.nativeEvent.clientX,t.nativeEvent.clientY,m.T.UP,!0,t)},onMouseUp:function(t){return l(t.nativeEvent.clientX,t.nativeEvent.clientY,m.T.UP,3==t.nativeEvent.button,t)},onMouseDown:function(t){return l(t.nativeEvent.clientX,t.nativeEvent.clientY,m.T.DOWN,3==t.nativeEvent.button,t)},onMouseMove:function(t){return l(t.nativeEvent.clientX,t.nativeEvent.clientY,m.T.MOVE,3==t.nativeEvent.button,t)}}))};T.propTypes={width:s().number.isRequired,height:s().number.isRequired,SceneProvider:s().object.isRequired,class:s().string.isRequired};const L=T;r(655);var Z=r(242);function E(t){return function(t){if(Array.isArray(t))return R(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(t){if("string"==typeof t)return R(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?R(t,e):void 0}}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function R(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,i=new Array(e);n<e;n++)i[n]=t[n];return i}function P(t,e,n,i,r,o,s){try{var a=t[o](s),c=a.value}catch(t){return void n(t)}a.done?e(c):Promise.resolve(c).then(i,r)}function M(t){return function(){var e=this,n=arguments;return new Promise((function(i,r){var o=t.apply(e,n);function s(t){P(o,i,r,s,a,"next",t)}function a(t){P(o,i,r,s,a,"throw",t)}s(void 0)}))}}function O(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}var S=function(){function t(e,n){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.id=e,this.world=n,this.data={},this.spriteDict={},this.spriteList=[],this.engine=n.engine,this.onLoadActions=new u.Z,this.spriteLoader=new Z.jf(n.engine),this.dialogueLoader=new Z.OP(n.engine),this.tsLoader=new Z.e5(n.engine),this.loadTilesetGeometry=this.loadTilesetGeometry.bind(this),this.onTilesetOrSpriteLoaded=this.onTilesetOrSpriteLoaded.bind(this),this.loadSprite=this.loadSprite.bind(this)}var e,n,i,o,s;return e=t,n=[{key:"load",value:(s=M(regeneratorRuntime.mark((function t(){var e,n=this;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,e=r(394)("./"+this.id+".zone.jsx").default,this.bounds=e.bounds,this.size=[e.bounds[2]-e.bounds[0],e.bounds[3]-e.bounds[1]],this.cells=e.cells,t.next=7,this.tsLoader.load(e.tileset);case 7:return this.tileset=t.sent,this.tileset.runWhenDefinitionLoaded(this.loadTilesetGeometry.bind(this)),this.tileset.runWhenLoaded(this.onTilesetOrSpriteLoaded.bind(this)),t.next=12,Promise.all.apply(Promise,E(e.sprites.map(this.loadSprite)).concat(E(e.dialogue.map(this.loadDialogue))));case 12:this.spriteList.forEach((function(t){return t.runWhenLoaded(n.onTilesetOrSpriteLoaded.bind(n))})),t.next=19;break;case 15:t.prev=15,t.t0=t.catch(0),console.error("Error parsing zone "+this.id),console.error(t.t0);case 19:case"end":return t.stop()}}),t,this,[[0,15]])}))),function(){return s.apply(this,arguments)})},{key:"runWhenLoaded",value:function(t){this.loaded?t():this.onLoadActions.add(t)}},{key:"loadTilesetGeometry",value:function(){this.vertexPosBuf=[],this.vertexTexBuf=[],this.walkability=[];for(var t=0,e=0;t<this.size[1];t++){for(var n=[],i=[],r=0;r<this.size[0];r++,e++){var o=this.cells[e];this.walkability[e]=m.N.All;for(var s=Math.floor(o.length/3),a=0;a<s;a++){var c=[this.bounds[0]+r,this.bounds[1]+t,o[3*a+2]];this.walkability[e]&=this.tileset.getWalkability(o[3*a]),n=n.concat(this.tileset.getTileVertices(o[3*a],c)),i=i.concat(this.tileset.getTileTexCoords(o[3*a],o[3*a+1]))}o.length==3*s+1&&(this.walkability[e]=o[3*s])}this.vertexPosBuf[t]=this.engine.createBuffer(n,this.engine.gl.STATIC_DRAW,3),this.vertexTexBuf[t]=this.engine.createBuffer(i,this.engine.gl.STATIC_DRAW,2)}}},{key:"onTilesetOrSpriteLoaded",value:function(){!this.loaded&&this.tileset.loaded&&this.spriteList.every((function(t){return t.loaded}))&&this.dialogueList.every((function(t){return t.loaded}))&&this.triggerList.every((function(t){return t.loaded}))&&(console.log("Initialized zone '"+this.id+"'"),this.loaded=!0,this.onLoadActions.run())}},{key:"tick",value:function(t){this.loaded&&(this.spriteList.forEach(function(){var e=M(regeneratorRuntime.mark((function e(n){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",n.tickOuter(t));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),this.dialogueList.forEach(function(){var e=M(regeneratorRuntime.mark((function e(n){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",n.tickOuter(t));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()))}},{key:"draw",value:function(){if(this.loaded){this.spriteList.sort((function(t,e){return t.pos.y-e.pos.y})),this.engine.mvPushMatrix(),this.engine.setCamera();for(var t=0,e=0;e<this.size[1];e++)for(this.drawRow(e);t<this.spriteList.length&&this.spriteList[t].pos.y-this.bounds[1]<=e;)this.spriteList[t++].draw(this.engine);for(;t<this.spriteList.length;)this.spriteList[t++].draw(this.engine);this.engine.mvPopMatrix()}}},{key:"loadSprite",value:(o=M(regeneratorRuntime.mark((function t(e){var n;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.zone=this,t.next=3,this.spriteLoader.load(e.type);case 3:n=t.sent,this.spriteDict[e.id]=n,this.spriteList.push(n);case 6:case"end":return t.stop()}}),t,this)}))),function(t){return o.apply(this,arguments)})},{key:"addSprite",value:function(t){t.zone=this,this.spriteDict[t.id]=t,this.spriteList.push(t)}},{key:"removeSprite",value:function(t){this.spriteList=this.spriteList.filter((function(e){return e.id!==t})),delete this.spriteDict[t]}},{key:"loadDialogue",value:(i=M(regeneratorRuntime.mark((function t(e){var n;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.zone=this,t.next=3,this.dialogueLoader.load(e.type);case 3:n=t.sent,this.dialogueDict[e.id]=n,this.dialogueList.push(n);case 6:case"end":return t.stop()}}),t,this)}))),function(t){return i.apply(this,arguments)})},{key:"addDialogue",value:function(t){t.zone=this,this.dialogueDict[t.id]=t,this.dialogueList.push(t)}},{key:"removeDialogue",value:function(t){this.dialogueList=this.dialogueList.filter((function(e){return e.id!==t})),delete this.dialogueDict[t]}},{key:"getHeight",value:function(t,e){if(!this.isInZone(t,e))return console.error("Requesting height for ["+t+", "+e+"] outside zone bounds"),0;for(var n=Math.floor(t),i=Math.floor(e),r=[t-n,e-i],o=function(t,e){var n=[t[1][0]-t[0][0],t[1][1]-t[0][1]],i=[t[2][0]-t[0][0],t[2][1]-t[0][1]],r=1/(n[0]*i[1]-n[1]*i[0]),o=[r*i[1],-r*i[0],-r*n[1],r*n[0]];return[n=(e[0]-t[0][0])*o[0]+(e[1]-t[0][1])*o[1],i=(e[0]-t[0][0])*o[2]+(e[1]-t[0][1])*o[3]]},s=this.cells[(i-this.bounds[1])*this.size[0]+n-this.bounds[0]],a=Math.floor(s.length/3),c=0;c<a;c++){var u=this.tileset.getTileWalkPoly(s[3*c]);if(u)for(var l=0;l<u.length;l++){var h=o(u[l],r),f=h[0]+h[1];if(f<=1)return s[3*c+2]+(1-f)*u[l][0][2]+h[0]*u[l][1][2]+h[1]*u[l][2][2]}}return s[2]}},{key:"drawRow",value:function(t){this.engine.bindBuffer(this.vertexPosBuf[t],this.engine.shaderProgram.vertexPositionAttribute),this.engine.bindBuffer(this.vertexTexBuf[t],this.engine.shaderProgram.textureCoordAttribute),this.tileset.texture.attach(),this.engine.shaderProgram.setMatrixUniforms(),this.engine.gl.drawArrays(this.engine.gl.TRIANGLES,0,this.vertexPosBuf[t].numItems)}},{key:"isInZone",value:function(t,e){return t>=this.bounds[0]&&e>=this.bounds[1]&&t<this.bounds[2]&&e<this.bounds[3]}},{key:"isWalkable",value:function(t,e,n){return this.isInZone(t,e)?0!=(this.walkability[(e-this.bounds[1])*this.size[0]+t-this.bounds[0]]&n):null}}],n&&O(e.prototype,n),t}();function k(t,e,n,i,r,o,s){try{var a=t[o](s),c=a.value}catch(t){return void n(t)}a.done?e(c):Promise.resolve(c).then(i,r)}function _(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}var C=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.engine=e,this.zoneDict={},this.zoneList=[],this.afterTickActions=new u.Z,this.sortZones=this.sortZones.bind(this),this.zoneContaining=this.zoneContaining.bind(this)}var e,n,i,r;return e=t,n=[{key:"runAfterTick",value:function(t){this.afterTickActions.add(t)}},{key:"sortZones",value:function(){this.zoneList.sort((function(t,e){return t.bounds[1]-e.bounds[1]}))}},{key:"loadZone",value:(i=regeneratorRuntime.mark((function t(e){var n;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!this.zoneDict[e]){t.next=2;break}return t.abrupt("return",this.zoneDict[e]);case 2:return n=new S(e,this),t.next=5,n.load();case 5:return this.zoneDict[e]=n,this.zoneList.push(n),n.runWhenLoaded(this.sortZones),t.abrupt("return",n);case 9:case"end":return t.stop()}}),t,this)})),r=function(){var t=this,e=arguments;return new Promise((function(n,r){var o=i.apply(t,e);function s(t){k(o,n,r,s,a,"next",t)}function a(t){k(o,n,r,s,a,"throw",t)}s(void 0)}))},function(t){return r.apply(this,arguments)})},{key:"removeZone",value:function(t){this.zoneList=this.zoneList.filter((function(e){return e.id!==t})),delete this.zoneDict[t]}},{key:"tick",value:function(t){for(var e in this.zoneDict)this.zoneDict[e].tick(t);this.afterTickActions.run(t)}},{key:"draw",value:function(){for(var t in this.zoneDict)this.zoneDict[t].draw(this.engine)}},{key:"zoneContaining",value:function(t,e){for(var n in this.zoneDict){var i=this.zoneDict[n];if(i.loaded&&i.isInZone(t,e))return i}return null}}],n&&_(e.prototype,n),t}();function W(t,e,n,i,r,o,s){try{var a=t[o](s),c=a.value}catch(t){return void n(t)}a.done?e(c):Promise.resolve(c).then(i,r)}function Y(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var I=function t(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),Y(this,"init",function(){var e,n=(e=regeneratorRuntime.mark((function e(n){var i;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t._instance.engine=n,i=t._instance.world=new C(n),e.next=4,i.loadZone("dungeon-top");case 4:return e.next=6,i.loadZone("dungeon-bottom");case 6:i.zoneList.forEach((function(t){return t.runWhenLoaded((function(){return console.log("loading...done")}))}));case 7:case"end":return e.stop()}}),e)})),function(){var t=this,n=arguments;return new Promise((function(i,r){var o=e.apply(t,n);function s(t){W(o,i,r,s,a,"next",t)}function a(t){W(o,i,r,s,a,"throw",t)}s(void 0)}))});return function(t){return n.apply(this,arguments)}}()),Y(this,"render",(function(e,n){t._instance.world.tick(n),t._instance.world.draw(e)})),Y(this,"onKeyEvent",(function(e){"keydown"===e.type?t._instance.engine.keyboard.onKeyDown(e):t._instance.engine.keyboard.onKeyUp(e)})),Y(this,"onMouseEvent",(function(t,e,n,i,r){})),t._instance||(t._instance=this),t._instance},N=r(379),B=r.n(N),z=r(795),D=r.n(z),U=r(569),F=r.n(U),j=r(636),V=r.n(j),K=r(216),$=r.n(K),G=r(589),H=r.n(G),q=r(541),X={};function J(t){return J="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},J(t)}function Q(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function tt(t,e){return tt=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},tt(t,e)}function et(t,e){if(e&&("object"===J(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function nt(t){return nt=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},nt(t)}X.styleTagTransform=H(),X.setAttributes=V(),X.insert=F().bind(null,"head"),X.domAPI=D(),X.insertStyleElement=$(),B()(q.Z,X),q.Z&&q.Z.locals&&q.Z.locals;var it=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&tt(t,e)}(a,t);var n,i,r,o,s=(r=a,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,e=nt(r);if(o){var n=nt(this).constructor;t=Reflect.construct(e,arguments,n)}else t=e.apply(this,arguments);return et(this,t)});function a(t){var e;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,a),(e=s.call(this,t)).state={networkString:t.networkString,scene:new I,updated:Date.now()},e}return n=a,(i=[{key:"componentWillReceiveProps",value:function(t){console.log(t),JSON.stringify(this.props.networkString)!=JSON.stringify(t.networkString)&&this.setState({networkString:t.networkString,updated:Date.now()})}},{key:"render",value:function(){var t=this.state,n=t.networkString,i=t.updated,r=t.scene;return e().createElement(e().Fragment,null,e().createElement(L,{class:"pixos",key:i,width:640,height:480,SceneProvider:r,networkString:n}))}}])&&Q(n.prototype,i),a}(t.Component);const rt=(0,n.collect)(it)})(),o})()}));
//# sourceMappingURL=bundle.js.map