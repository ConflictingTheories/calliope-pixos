/*! For license information please see bundle.js.LICENSE.txt */
(()=>{var t={5061:(t,e,n)=>{"use strict";n.r(e),n.d(e,{default:()=>r});const r={init:function(t,e,n){console.log("loading - animate"),this.length=t,this.untilFrame=e,this.finish=n},tick:function(t){if(this.loaded){this.facing&&this.facing!=this.sprite.facing&&this.sprite.setFacing(this.facing);var e=this.startTime+this.length,n=(t-this.startTime)/this.length;t>=e&&(n=1,this.finish&&this.finish(!0));var r=Math.floor(n*this.untilFrame);return r!=this.sprite.animFrame&&this.sprite.setFrame(r),t>=e}}}},1183:(t,e,n)=>{"use strict";n.r(e),n.d(e,{default:()=>l});var r=n(8348),o=n(4180);function i(t,e,n){return i=s()?Reflect.construct:function(t,e,n){var r=[null];r.push.apply(r,e);var o=new(Function.bind.apply(t,r));return n&&a(o,n.prototype),o},i.apply(null,arguments)}function s(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}function a(t,e){return a=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},a(t,e)}function c(t){return function(t){if(Array.isArray(t))return u(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(t){if("string"==typeof t)return u(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?u(t,e):void 0}}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function u(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function f(t,e,n,r,o,i,s){try{var a=t[i](s),c=a.value}catch(t){return void n(t)}a.done?e(c):Promise.resolve(c).then(r,o)}const l={init:(h=regeneratorRuntime.mark((function t(e,n,s,a,u){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return console.log("loading - change zone"),t.next=3,this.sprite.zone.world.loadZone(e);case 3:return this.fromZone=t.sent,t.next=6,this.sprite.zone.world.loadZone(s);case 6:this.toZone=t.sent,this.from=i(r.OW,c(n)),this.to=i(r.OW,c(a)),this.facing=o.N.fromOffset([Math.round(a.x-n.x),Math.round(a.y-n.y)]),this.length=u;case 11:case"end":return t.stop()}}),t,this)})),p=function(){var t=this,e=arguments;return new Promise((function(n,r){var o=h.apply(t,e);function i(t){f(o,n,r,i,s,"next",t)}function s(t){f(o,n,r,i,s,"throw",t)}i(void 0)}))},function(t,e,n,r,o){return p.apply(this,arguments)}),tick:function(t){if(this.toZone.loaded&&this.fromZone.loaded){this.facing&&this.facing!=this.sprite.facing&&(this.sprite.facing=this.facing,this.sprite.setFrame(0));var e=this.startTime+this.length,n=(t-this.startTime)/this.length;t>=e?((0,r.t8)(this.to,this.sprite.pos),n=1):(0,r.t7)(this.from,this.to,n,this.sprite.pos);var o=Math.floor(4*n);o!=this.sprite.animFrame&&this.sprite.setFrame(o),this.sprite.zone.isInZone(this.sprite.pos.x,this.sprite.pos.y)||(this.fromZone.removeSprite(this.sprite.id),this.sprite.zone.world.runAfterTick(function(){this.toZone.addSprite(this.sprite),console.log("sprite '"+this.sprite.id+"' changed zone from '"+this.fromZone.id+"' to '"+this.toZone.id+"'")}.bind(this)));var i=this.sprite.pos.x+this.sprite.hotspotOffset.x,s=this.sprite.pos.y+this.sprite.hotspotOffset.y;return this.switchRenderZone||this.fromZone.isInZone(i,s)||(this.switchRenderZone=!0),this.sprite.pos.z=(this.switchRenderZone?this.toZone:this.fromZone).getHeight(i,s),t>=e}}};var h,p},5317:(t,e,n)=>{"use strict";n.r(e),n.d(e,{default:()=>r});const r={init:function(t){var e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};console.log("loading - chat"),this.engine=this.sprite.engine,this.text="",this.prompt=t,this.scrolling=e,this.line=0,this.options=n,this.completed=!1,this.lastKey=(new Date).getTime()},tick:function(t){var e;if(this.loaded)return this.options&&this.options.autoclose&&(this.endTime=this.endTime?this.endTime:null!==(e=this.options.endTime)&&void 0!==e?e:(new Date).getTime()+1e4,t>this.endTime&&(this.completed=!0)),this.checkInput(t),this.textbox=this.engine.scrollText(this.prompt+this.text,this.scrolling,this.options),this.completed},checkInput:function(t){if(t>this.lastKey+100){var e=!1;switch(this.engine.keyboard.lastPressedCode()){case"Escape":this.completed=!0,e=!0;break;case"Backspace":var n=this.text.split("");n.pop(),this.text=n.join(""),this.lastKey=t,e=!0;break;case"Enter":this.engine.setGreeting(this.text),this.sprite.speech.clearHud(),this.speechbox=this.sprite.speech.scrollText(this.text),this.sprite.speech.loadImage(),this.completed=!0,e=!0}if(!e){var r=this.engine.keyboard.lastPressedKey();r&&(this.lastKey=t,this.text+=""+r)}}}}},8304:(t,e,n)=>{"use strict";n.r(e),n.d(e,{default:()=>a});var r,o=n(4180),i=n(9337);function s(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}const a=(s(r={init:function(t,e){console.log("loading - dance",arguments),this.zone=e,this.moveLength=t,this.startTime=(new Date).getTime(),this.lastKey=(new Date).getTime(),this.completed=!1,this.audio=new i.mT("/pixos/audio/seed.mp3"),this.zone.audio&&this.zone.audio.pauseAudio(),this.audio.playAudio(),this.audioContext=new AudioContext,this.analyser=this.audioContext.createAnalyser(),this.audioSource=this.audioContext.createMediaElementSource(this.audio.audio),this.audioSource.connect(this.analyser),this.analyser.connect(this.audioContext.destination)},tick:function(t){if(this.loaded){var e=new Uint8Array(this.analyser.frequencyBinCount);if(this.analyser.getByteFrequencyData(e),this.checkInput(t),t>this.startTime+this.moveLength){for(var n,r,i=null,s=0;s<16;s++)n=4*s,r=2,i=-e[s]/2;console.log(n,r,i);var a=this.sprite.facing==o.N.Right?o.N.Left:o.N.Right;this.sprite.addAction(this.sprite.faceDir(a)),this.startTime=t}return this.completed}}},"tick",(function(t){if(this.loaded){var e=new Uint8Array(this.analyser.frequencyBinCount);if(this.analyser.getByteFrequencyData(e),this.checkInput(t),t>this.startTime+this.moveLength){for(var n,r,i=this.sprite.facing==o.N.Right?o.N.Left:o.N.Right,s=null,a=0;a<16;a++)n=4*a,r=2,s=-e[a]/2;i=s>80?this.sprite.facing==o.N.Right?o.N.Down:o.N.Left:this.sprite.facing==o.N.Up?o.N.Left:o.N.Down,console.log(n,r,s),console.log(i),this.sprite.addAction(this.sprite.faceDir(i)),this.startTime=t}return this.completed}})),s(r,"checkInput",(function(t){if(t>this.lastKey+this.moveLength)return"q"===this.sprite.engine.keyboard.lastPressed("q")&&(console.log("stopping dance"),this.audio.pauseAudio(),this.completed=!0),this.lastKey=(new Date).getTime(),null})),r)},2282:(t,e,n)=>{"use strict";n.r(e),n.d(e,{default:()=>r});const r={init:function(t){var e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};console.log("loading - dialogue"),this.engine=this.sprite.engine,this.text=t,this.displayText="string"==typeof t?t:this.text.shift(),this.scrolling=e,this.options=n,this.completed=!1,this.lastText=!1,this.lastKey=(new Date).getTime(),this.loaded=!0},tick:function(t){var e;if(this.loaded)return this.options&&this.options.autoclose&&(this.endTime=this.endTime?this.endTime:null!==(e=this.options.endTime)&&void 0!==e?e:(new Date).getTime()+1e4,t>this.endTime&&(this.completed=!0)),this.checkInput(t),this.sprite.speak(this.displayText),this.completed&&this.options.onClose&&(this.sprite.speech.clearHud(),this.options.onClose()),this.completed},checkInput:function(t){if(t>this.lastKey+100)switch(this.engine.keyboard.lastPressedCode()){case"Escape":console.log("closing dialogue"),this.sprite.speak(!1),this.completed=!0;break;case"Enter":"string"==typeof this.text||0===this.text.length?this.completed=!0:(this.completed=!1,this.displayText=this.text.shift(),this.sprite.speak(this.displayText))}}}},2813:(t,e,n)=>{"use strict";n.r(e),n.d(e,{default:()=>r});const r={init:function(t){console.log("loading - face"),this.facing=t},tick:function(t){return this.facing&&this.facing!=this.sprite.facing&&this.sprite.setFacing(this.facing),!0}}},1162:(t,e,n)=>{"use strict";n.r(e),n.d(e,{default:()=>r});const r={init:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};console.log("loading - greeting"),this.engine=this.sprite.engine,this.greeting=t,this.options=e,this.completed=!1},tick:function(t){if(this.loaded)return this.engine.setGreeting(this.text),!0}}},5544:(t,e,n)=>{"use strict";n.r(e),n.d(e,{default:()=>f});var r=n(8348),o=n(4180);function i(t,e,n){return i=s()?Reflect.construct:function(t,e,n){var r=[null];r.push.apply(r,e);var o=new(Function.bind.apply(t,r));return n&&a(o,n.prototype),o},i.apply(null,arguments)}function s(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}function a(t,e){return a=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},a(t,e)}function c(t){return function(t){if(Array.isArray(t))return u(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(t){if("string"==typeof t)return u(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?u(t,e):void 0}}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function u(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}const f={init:function(t,e,n){var s=this;console.log("loading - interact",arguments),this.world=n,this.from=i(r.OW,c(t)),this.facing=e,this.offset=o.N.toOffset(e),this.lastKey=(new Date).getTime(),this.completed=!1,this.to=[t[0]+this.offset[0],t[1]+this.offset[1]],this.zone=n.zoneContaining.apply(n,c(this.to)),this.spriteList=this.zone.spriteList.filter((function(t){return t.pos.x===s.to[0]&&t.pos.y===s.to[1]})),this.finish=this.finish.bind(this),this.interact()},interact:function(){var t=this;0===this.spriteList.length&&(this.completed=!0),this.spriteList.forEach((function(e){var n=e.faceDir(o.N.reverse(t.facing));return n&&e.addAction(n),e.interact?t.zone.spriteDict[e.id].interact(t.sprite,t.finish):null}))},finish:function(t){t&&(this.completed=!0)},tick:function(t){if(this.loaded)return this.checkInput(t),this.completed},checkInput:function(t){if(t>this.lastKey+this.length)return"q"===this.sprite.engine.keyboard.lastPressed("q")&&(console.log("stopping interaction"),this.completed=!0),this.lastKey=(new Date).getTime(),null}}},2897:(t,e,n)=>{"use strict";n.r(e),n.d(e,{default:()=>f});var r=n(8348),o=n(4180);function i(t,e,n){return i=s()?Reflect.construct:function(t,e,n){var r=[null];r.push.apply(r,e);var o=new(Function.bind.apply(t,r));return n&&a(o,n.prototype),o},i.apply(null,arguments)}function s(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}function a(t,e){return a=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},a(t,e)}function c(t){return function(t){if(Array.isArray(t))return u(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(t){if("string"==typeof t)return u(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?u(t,e):void 0}}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function u(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}const f={init:function(t,e,n,s){var a=this;console.log("loading - move"),this.zone=s,this.from=i(r.OW,c(t)),this.to=i(r.OW,c(e)),this.facing=o.N.fromOffset([Math.round(e.x-t.x),Math.round(e.y-t.y)]),this.length=n,console.log(this.zone),this.spriteList=this.zone.spriteList.filter((function(t){return t.pos.x===a.to.x&&t.pos.y===a.to.y}))},tick:function(t){if(this.loaded){this.facing&&this.facing!=this.sprite.facing&&this.sprite.setFacing(this.facing);var e=this.startTime+this.length,n=(t-this.startTime)/this.length;t>=e?((0,r.t8)(this.to,this.sprite.pos),n=1,this.onStep()):(0,r.t7)(this.from,this.to,n,this.sprite.pos);var o=Math.floor(4*n);o!=this.sprite.animFrame&&this.sprite.setFrame(o);var i=this.sprite.pos.x+this.sprite.hotspotOffset.x,s=this.sprite.pos.y+this.sprite.hotspotOffset.y;return this.sprite.pos.z=this.sprite.zone.getHeight(i,s),t>=e}},onStep:function(){var t=this;console.log("on steppping",this.spriteList),0===this.spriteList.length&&(this.completed=!0),this.spriteList.forEach((function(e){return console.log(e),e.onStep?t.zone.spriteDict[e.id].onStep(t.sprite):null}))}}},2704:(t,e,n)=>{"use strict";n.r(e),n.d(e,{default:()=>p});var r=n(8348),o=n(9337),i=n(4180);function s(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var r,o,i=[],s=!0,a=!1;try{for(n=n.call(t);!(s=(r=n.next()).done)&&(i.push(r.value),!e||i.length!==e);s=!0);}catch(t){a=!0,o=t}finally{try{s||null==n.return||n.return()}finally{if(a)throw o}}return i}}(t,e)||l(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function a(t,e,n){return a=c()?Reflect.construct:function(t,e,n){var r=[null];r.push.apply(r,e);var o=new(Function.bind.apply(t,r));return n&&u(o,n.prototype),o},a.apply(null,arguments)}function c(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}function u(t,e){return u=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},u(t,e)}function f(t){return function(t){if(Array.isArray(t))return h(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||l(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function l(t,e){if(t){if("string"==typeof t)return h(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?h(t,e):void 0}}function h(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}const p={init:function(t,e,n,i){console.log("loading - patrol",arguments),this.zone=i,this.from=a(r.OW,f(t)),this.to=a(r.OW,f(e)),this.lastKey=(new Date).getTime(),this.completed=!1,this.direction=1,this.audio=new o.mT("/pixos/audio/seed.mp3");var c=this.sprite.zone.world.pathFind(t,e),u=s(c,2);this.hasMoves=u[0],this.moveList=u[1],this.hasMoves||(this.completed=!0),this.moveIndex=1,this.moveLength=n,this.zone.audio&&this.zone.audio.pauseAudio(),this.audio.playAudio()},tick:function(t){if(this.loaded){if(this.checkInput(t),t>this.startTime+this.moveLength){var e=this.moveList[this.moveIndex];if(this.moveList.length>2){var n=0==this.moveIndex?this.moveList[this.moveIndex+1]:this.moveIndex+1>=this.moveList.length?this.moveList[this.moveList.length-1]:this.moveList[this.moveIndex-1],r=i.N.fromOffset([Math.round(e[0]-n[0]),Math.round(e[1]-n[1])]);if(this.sprite.zone.isInZone(e[0],e[1]))this.currentAction=new o.aW(this.sprite.engine,"move",[n,e,this.moveLength,this.zone],this.sprite);else{var s=this.sprite.zone.world.zoneContaining(e[0],e[1]);s&&s.loaded&&s.isWalkable(e[0],e[1],i.N.reverse(r))?this.currentAction=new o.aW(this.sprite.engine,"changezone",[this.sprite.zone.id,this.sprite.pos.toArray(),s.id,e,this.moveLength],this.sprite):this.currentAction=this.sprite.faceDir(r)}this.currentAction&&(this.currentAction.facing=r,this.sprite.addAction(this.currentAction))}this.moveIndex+this.direction>=this.moveList.length&&(this.direction*=-1,this.completed=!0,this.zone.audio&&this.zone.audio.playAudio(),this.audio.pauseAudio()),this.moveIndex+=this.direction,this.startTime=t}return this.completed}},checkInput:function(t){if(t>this.lastKey+this.moveLength)return"q"===this.sprite.engine.keyboard.lastPressed("q")&&(console.log("stopping patrol"),this.audio.pauseAudio(),this.completed=!0),this.lastKey=(new Date).getTime(),null}}},5744:(t,e,n)=>{"use strict";function r(t,e,n,r,o,i,s){try{var a=t[i](s),c=a.value}catch(t){return void n(t)}a.done?e(c):Promise.resolve(c).then(r,o)}n.r(e),n.d(e,{default:()=>o});const o={init:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;console.log("loading - script",arguments),this.zone=e,this.world=e.world,this.lastKey=(new Date).getTime(),this.completed=!1,this.onCompleted=function(){return console.log("script finished")},n&&(this.onCompleted=n),this.triggerId=t,this.triggerScript()},triggerScript:function(){var t=this;this.triggerId||(this.completed=!0),Promise.all(this.zone.scripts.filter((function(e){return e.id===t.triggerId})).map(function(){var e,n=(e=regeneratorRuntime.mark((function e(n){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n.trigger.call(t.zone);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})),function(){var t=this,n=arguments;return new Promise((function(o,i){var s=e.apply(t,n);function a(t){r(s,o,i,a,c,"next",t)}function c(t){r(s,o,i,a,c,"throw",t)}a(void 0)}))});return function(t){return n.apply(this,arguments)}}())).then((function(){t.completed=!0}))},tick:function(t){if(this.loaded)return this.completed&&this.onCompleted(),this.completed}}},6180:(t,e,n)=>{"use strict";n.d(e,{Z:()=>y});var r=n(8348),o=n(4180),i=n(9337);function s(t){return s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},s(t)}function a(t,e,n){return a=h()?Reflect.construct:function(t,e,n){var r=[null];r.push.apply(r,e);var o=new(Function.bind.apply(t,r));return n&&u(o,n.prototype),o},a.apply(null,arguments)}function c(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function u(t,e){return u=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},u(t,e)}function f(t,e){if(e&&("object"===s(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return l(t)}function l(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function h(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}function p(t){return p=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},p(t)}var y=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");Object.defineProperty(t,"prototype",{value:Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),writable:!1}),e&&u(t,e)}(b,t);var e,n,s,y,d=(e=b,n=h(),function(){var t,r=p(e);if(n){var o=p(this).constructor;t=Reflect.construct(r,arguments,o)}else t=r.apply(this,arguments);return f(this,t)});function b(t){var e;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,b),(e=d.call(this,t)).handleWalk=e.handleWalk.bind(l(e)),e}return s=b,(y=[{key:"init",value:function(){console.log("- avatar hook",this.id,this.pos)}},{key:"tick",value:function(t){if(!this.actionList.length){var e=this.checkInput();e&&this.addAction(e)}this.bindCamera&&(0,r.t8)(this.pos,this.engine.cameraPosition)}},{key:"checkInput",value:function(){switch(this.engine.keyboard.lastPressedCode()){case"b":this.bindCamera=!0;break;case"c":this.bindCamera=!1;break;case"z":this.zone.world.removeZone("room"),this.zone.world.loadZone("dungeon-top"),this.zone.world.loadZone("dungeon-bottom");break;case"y":this.zone.world.removeZone("dungeon-top"),this.zone.world.removeZone("dungeon-bottom"),this.zone.world.loadZone("room");break;case"k":case"Enter":return new i.aW(this.engine,"interact",[this.pos.toArray(),this.facing,this.zone.world],this);case"h":return new i.aW(this.engine,"dialogue",["Welcome! You pressed help! Press Escape to close",!1,{autoclose:!0}],this);case"m":case" ":return new i.aW(this.engine,"chat",[">:",!0,{autoclose:!1}],this);case"q":case"Escape":this.speech.clearHud()}return this.handleWalk(this.engine.keyboard.lastPressedKey())}},{key:"handleWalk",value:function(t){var e,n=o.N.None;switch(t){case"w":n=o.N.Up;break;case"s":n=o.N.Down;break;case"a":n=o.N.Left;break;case"d":n=o.N.Right;break;case"u":return new i.aW(this.engine,"dance",[300,this.zone],this);case"p":return new i.aW(this.engine,"patrol",[this.pos.toArray(),new r.OW(8,13,this.pos.z).toArray(),600,this.zone],this);case"r":return new i.aW(this.engine,"patrol",[this.pos.toArray(),new r.OW(8,13,this.pos.z).toArray(),200,this.zone],this);default:return null}if(e=this.engine.keyboard.shift?200:600,this.facing!==n)return this.faceDir(n);var s=this.pos,c=o.N.toOffset(n),u=a(r.OW,[Math.round(s.x+c[0]),Math.round(s.y+c[1]),0]);if(!this.zone.isInZone(u.x,u.y)){var f=this.zone.world.zoneContaining(u.x,u.y);return f&&f.loaded&&f.isWalkable(u.x,u.y,o.N.reverse(n))?new i.aW(this.engine,"changezone",[this.zone.id,this.pos.toArray(),f.id,u.toArray(),e],this):this.faceDir(n)}return this.zone.isWalkable(u.x,u.y,o.N.reverse(n))?new i.aW(this.engine,"move",[this.pos.toArray(),u.toArray(),e,this.zone],this):this.faceDir(n)}}])&&c(s.prototype,y),Object.defineProperty(s,"prototype",{writable:!1}),b}(n(5870).Z)},7408:(t,e,n)=>{"use strict";function r(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}n.d(e,{Z:()=>o});var o=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.actions=[]}var e,n;return e=t,n=[{key:"add",value:function(t){this.actions.push(t)}},{key:"run",value:function(){var t=arguments;this.actions=this.actions.filter((function(e){return e(t)}))}}],n&&r(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),t}()},5870:(t,e,n)=>{"use strict";n.d(e,{Z:()=>h});var r=n(8348),o=n(4180),i=n(7408),s=n(9337),a=n(9175);function c(t,e,n){return c=u()?Reflect.construct:function(t,e,n){var r=[null];r.push.apply(r,e);var o=new(Function.bind.apply(t,r));return n&&f(o,n.prototype),o},c.apply(null,arguments)}function u(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}function f(t,e){return f=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},f(t,e)}function l(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var h=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.engine=e,this.templateLoaded=!1,this.drawOffset=new r.OW(0,0,0),this.hotspotOffset=new r.OW(0,0,0),this.animFrame=0,this.pos=new r.OW(0,0,0),this.facing=o.N.Right,this.actionDict={},this.actionList=[],this.speech={},this.portrait=null,this.onLoadActions=new i.Z,this.getTexCoords=this.getTexCoords.bind(this),this.inventory=[],this.onTilesetOrTextureLoaded=this.onTilesetOrTextureLoaded.bind(this),this.blocking=!0,this.override=!1}var e,n;return e=t,n=[{key:"update",value:function(t){Object.assign(this,t)}},{key:"runWhenLoaded",value:function(t){this.loaded?t():this.onLoadActions.add(t)}},{key:"onLoad",value:function(t){this.loaded||(this.src&&this.sheetSize&&this.tileSize&&this.frames?(console.log("zoning ----\x3e>"),this.zone=t.zone,t.id&&(this.id=t.id),t.pos&&(0,r.t8)(t.pos,this.pos),t.facing&&0!==t.facing&&(this.facing=t.facing),t.zones&&null!==t.zones&&(this.zones=t.zones),console.log("facing",o.N.spriteSequence(this.facing)),this.texture=this.engine.loadTexture(this.src),console.log("texture ----\x3e>"),this.texture.runWhenLoaded(this.onTilesetOrTextureLoaded.bind(this)),this.vertexTexBuf=this.engine.createBuffer(this.getTexCoords(),this.engine.gl.DYNAMIC_DRAW,2),this.enableSpeech&&(this.speech=this.engine.loadSpeech(this.id,this.engine.mipmap),console.log("speech ----\x3e>"),this.speech.runWhenLoaded(this.onTilesetOrTextureLoaded.bind(this)),this.speechTexBuf=this.engine.createBuffer(this.getSpeechBubbleTexture(),this.engine.gl.DYNAMIC_DRAW,2)),this.portraitSrc&&(this.portrait=this.engine.loadTexture(this.portraitSrc),console.log("portrait ----\x3e>"),this.portrait.runWhenLoaded(this.onTilesetOrTextureLoaded.bind(this))),this.zone.tileset.runWhenDefinitionLoaded(this.onTilesetDefinitionLoaded.bind(this))):console.error("Invalid sprite definition"))}},{key:"onTilesetDefinitionLoaded",value:function(){var t=this.zone.tileset.tileSize,e=[this.tileSize[0]/t,this.tileSize[1]/t],n=[[0,0,0],[e[0],0,0],[e[0],0,e[1]],[0,0,e[1]]],r=[[n[2],n[3],n[0]],[n[2],n[0],n[1]]].flat(3);this.vertexPosBuf=this.engine.createBuffer(r,this.engine.gl.STATIC_DRAW,3),this.enableSpeech&&(this.speechVerBuf=this.engine.createBuffer(this.getSpeechBubbleVertices(),this.engine.gl.STATIC_DRAW,3)),this.zone.tileset.runWhenLoaded(this.onTilesetOrTextureLoaded.bind(this))}},{key:"onTilesetOrTextureLoaded",value:function(){!this||this.loaded||!this.zone.tileset.loaded||!this.texture.loaded||this.enableSpeech&&this.speech&&!this.speech.loaded||this.portrait&&!this.portrait.loaded||(this.init(),this.enableSpeech&&(this.speech.clearHud(),this.speech.writeText(this.id),this.speech.loadImage()),this.loaded=!0,this.onLoadActions.run(),console.log("Initialized sprite '"+this.id+"' in zone '"+this.zone.id+"'"))}},{key:"getTexCoords",value:function(){var t;"chest"==this.id&&console.log("texture frames",this.facing,o.N.spriteSequence(this.facing));var e=null!==(t=this.frames[o.N.spriteSequence(this.facing)])&&void 0!==t?t:this.frames.up,n=this.frames[o.N.spriteSequence(this.facing)].length,r=e[this.animFrame%n],i=this.sheetSize,s=this.tileSize,a=[(r[0]+s[0])/i[0],r[1]/i[1]],c=[r[0]/i[0],(r[1]+s[1])/i[1]],u=[a,[c[0],a[1]],c,[a[0],c[1]]];return[[u[0],u[1],u[2]],[u[0],u[2],u[3]]].flat(3)}},{key:"getSpeechBubbleTexture",value:function(){return[[1,1],[0,1],[0,0],[1,1],[0,0],[1,0]].flat(3)}},{key:"getSpeechBubbleVertices",value:function(){return[c(r.OW,[2,0,4]).toArray(),c(r.OW,[0,0,4]).toArray(),c(r.OW,[0,0,2]).toArray(),c(r.OW,[2,0,4]).toArray(),c(r.OW,[0,0,2]).toArray(),c(r.OW,[2,0,2]).toArray()].flat(3)}},{key:"draw",value:function(){this.loaded&&(this.engine.mvPushMatrix(),(0,a.Iu)(this.engine.uViewMat,this.engine.uViewMat,this.drawOffset.toArray()),(0,a.Iu)(this.engine.uViewMat,this.engine.uViewMat,this.pos.toArray()),(0,a.U1)(this.engine.uViewMat,this.engine.uViewMat,this.engine.degToRad(this.engine.cameraAngle),[1,0,0]),this.engine.bindBuffer(this.vertexPosBuf,this.engine.shaderProgram.vertexPositionAttribute),this.engine.bindBuffer(this.vertexTexBuf,this.engine.shaderProgram.textureCoordAttribute),this.texture.attach(),this.engine.shaderProgram.setMatrixUniforms(),this.engine.gl.depthFunc(this.engine.gl.ALWAYS),this.engine.gl.drawArrays(this.engine.gl.TRIANGLES,0,this.vertexPosBuf.numItems),this.engine.gl.depthFunc(this.engine.gl.LESS),this.engine.mvPopMatrix(),this.enableSpeech&&(this.engine.mvPushMatrix(),(0,a.Iu)(this.engine.uViewMat,this.engine.uViewMat,this.drawOffset.toArray()),(0,a.Iu)(this.engine.uViewMat,this.engine.uViewMat,this.pos.toArray()),(0,a.U1)(this.engine.uViewMat,this.engine.uViewMat,this.engine.degToRad(this.engine.cameraAngle),[1,0,0]),this.engine.bindBuffer(this.speechVerBuf,this.engine.shaderProgram.vertexPositionAttribute),this.engine.bindBuffer(this.speechTexBuf,this.engine.shaderProgram.textureCoordAttribute),this.speech.attach(),this.engine.shaderProgram.setMatrixUniforms(),this.engine.gl.depthFunc(this.engine.gl.ALWAYS),this.engine.gl.drawArrays(this.engine.gl.TRIANGLES,0,this.vertexPosBuf.numItems),this.engine.gl.depthFunc(this.engine.gl.LESS),this.engine.mvPopMatrix()))}},{key:"setFrame",value:function(t){this.animFrame=t,this.engine.updateBuffer(this.vertexTexBuf,this.getTexCoords())}},{key:"setFacing",value:function(t){console.log("setting face to "+o.N.spriteSequence(t)),t&&(this.facing=t),this.setFrame(this.animFrame)}},{key:"addAction",value:function(t){console.log("adding action to sprite",t.id),this.actionDict[t.id]&&this.removeAction(t.id),this.actionDict[t.id]=t,this.actionList.push(t)}},{key:"removeAction",value:function(t){console.log("removing action"),this.actionList=this.actionList.filter((function(e){return e.id!==t})),delete this.actionDict[t]}},{key:"removeAllActions",value:function(){this.actionList=[],this.actionDict={}}},{key:"tickOuter",value:function(t){var e=this;if(this.loaded){this.actionList.sort((function(t,e){var n=t.startTime-e.startTime;return n?t.id>e.id?1:-1:n}));var n=[];this.actionList.forEach((function(e){!e.loaded||e.startTime>t||e.tick(t)&&(n.push(e),e.onComplete())})),n.forEach((function(t){return e.removeAction(t.id)})),this.tick&&this.tick(t)}}},{key:"init",value:function(){console.log("- sprite hook",this.id,this.pos)}},{key:"speak",value:function(t){var e,n,r=arguments.length>1&&void 0!==arguments[1]&&arguments[1];t?(this.textbox=this.engine.scrollText(this.id+":> "+t,!0,{portrait:null!==(e=this.portrait)&&void 0!==e&&e}),r&&this.speech&&(this.speech.scrollText(t,!1,{portrait:null!==(n=this.portrait)&&void 0!==n&&n}),this.speech.loadImage())):this.speech.clearHud()}},{key:"interact",value:function(t,e){return this.state,e&&e(!0),null}},{key:"faceDir",value:function(t){return this.facing==t||t===o.N.None?null:new s.aW(this.engine,"face",[t],this)}},{key:"setGreeting",value:function(t){return this.speech.clearHud(),this.speech.writeText(t),this.speech.loadImage(),new s.aW(this.engine,"greeting",[t,{autoclose:!0}],this)}}],n&&l(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),t}()},7772:(t,e,n)=>{"use strict";n.d(e,{Z:()=>u});var r=n(9337);function o(t){return o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},o(t)}function i(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function s(t,e){return s=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},s(t,e)}function a(t,e){if(e&&("object"===o(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function c(t){return c=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},c(t)}var u=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");Object.defineProperty(t,"prototype",{value:Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),writable:!1}),e&&s(t,e)}(l,t);var e,n,o,u,f=(o=l,u=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,e=c(o);if(u){var n=c(this).constructor;t=Reflect.construct(e,arguments,n)}else t=e.apply(this,arguments);return a(this,t)});function l(t){var e;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,l),(e=f.call(this,t)).bindCamera=!1,e.enableSpeech=!0,e.state="intro",e}return e=l,(n=[{key:"interact",value:function(t,e){var n=null;switch(this.state){case"intro":this.state="loop",n=new r.aW(this.engine,"dialogue",["Buying stuff eh?!",!1,{autoclose:!0,onClose:function(){return e(!0)}}],this),void 0!==window.ethereum&&console.log("MetaMask is installed!");break;case"loop":this.state="loop2",n=new r.aW(this.engine,"dialogue",["I heard about a strange legend once.",!1,{autoclose:!0,onClose:function(){return e(!0)}}],this);break;case"loop2":this.state="loop",n=new r.aW(this.engine,"dialogue",["Sorry, I don't remember the story at the moment",!1,{autoclose:!0,onClose:function(){return e(!0)}}],this)}return console.log(n),n&&this.addAction(n),e&&e(!1),n}}])&&i(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),l}(n(5870).Z)},6595:(t,e,n)=>{"use strict";n.d(e,{Z:()=>l}),n(6185);var r=n(5870),o=n(9337);function i(t){return i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},i(t)}function s(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function a(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function c(t,e){return c=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},c(t,e)}function u(t,e){if(e&&("object"===i(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function f(t){return f=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},f(t)}var l=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");Object.defineProperty(t,"prototype",{value:Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),writable:!1}),e&&c(t,e)}(h,t);var e,n,r,i,l=(r=h,i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,e=f(r);if(i){var n=f(this).constructor;t=Reflect.construct(e,arguments,n)}else t=e.apply(this,arguments);return u(this,t)});function h(t){var e;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,h),(e=l.call(this,t)).bindCamera=!1,e.enableSpeech=!0,e.state="closed",e.inventory=[],e}return e=h,(n=[{key:"interact",value:function(t,e){var n=this,r=null;switch(this.startTime=Date.now(),this.state){case"closed":this.state="open",r=new o.aW(this.engine,"animate",[600,3,function(){var r,o;t.inventory&&(r=t.inventory).push.apply(r,function(t){if(Array.isArray(t))return s(t)}(o=n.inventory)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(o)||function(t,e){if(t){if("string"==typeof t)return s(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?s(t,e):void 0}}(o)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),e(!0)}],this);break;case"open":this.state="open",r=new o.aW(this.engine,"dialogue",["Empty.",!1,{autoclose:!0,onClose:function(){return e(!0)}}],this)}return r&&this.addAction(r),e&&e(!1),r}}])&&a(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),h}(r.Z)},4180:(t,e,n)=>{"use strict";n.d(e,{N:()=>r});var r={None:0,Right:1,Up:2,Left:4,Down:8,All:15,fromOffset:function(t){return t[0]>0?r.Right:t[0]<0?r.Left:t[1]>0?r.Down:t[1]<0?r.Up:0},toOffset:function(t){switch(t){case r.Right:return[1,0];case r.Up:return[0,-1];case r.Left:return[-1,0];case r.Down:return[0,1]}return[0,0]},reverse:function(t){switch(t){case r.Right:return r.Left;case r.Up:return r.Down;case r.Left:return r.Right;case r.Down:return r.Up}return r.None},rotate:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];switch(t){case r.Right:return e?r.Top:r.Down;case r.Up:return e?r.Left:r.Right;case r.Left:return e?r.Down:r.Top;case r.Down:return e?r.Right:r.Left}return r.None},spriteSequence:function(t){switch(t){case r.Right:return"right";case r.Up:return"up";case r.Left:return"left";case r.Down:return"down"}return"down"}}},9337:(t,e,n)=>{"use strict";n.d(e,{aW:()=>b,mT:()=>m,jf:()=>d,e5:()=>y});var r=n(6185),o=(n(5870),n(7408));function i(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var s=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.engine=e,this.src=null,this.sheetSize=[0,0],this.tileSize=0,this.tiles={},this.loaded=!1,this.onLoadActions=new o.Z,this.onDefinitionLoadActions=new o.Z,this.onTextureLoaded=this.onTextureLoaded.bind(this)}var e,n;return e=t,(n=[{key:"runWhenLoaded",value:function(t){this.loaded?t():this.onLoadActions.add(t)}},{key:"runWhenDefinitionLoaded",value:function(t){this.definitionLoaded?t():this.onDefinitionLoadActions.add(t)}},{key:"onJsonLoaded",value:function(t){var e=this;Object.keys(t).map((function(n){e[n]=t[n]})),this.definitionLoaded=!0,this.onDefinitionLoadActions.run(),this.texture=this.engine.loadTexture(this.src),this.texture.runWhenLoaded(this.onTextureLoaded),this.bgColor&&this.engine.gl.clearColor(this.bgColor[0]/255,this.bgColor[1]/255,this.bgColor[2]/255,1)}},{key:"onTextureLoaded",value:function(){console.log("Initialized tileset '"+this.name+"'"),this.loaded=!0,this.onLoadActions.run()}},{key:"getTileVertices",value:function(t,e){return this.geometry[t].vertices.map((function(t){return t.map((function(t){return[t[0]+e[0],t[1]+e[1],t[2]+e[2]]}))})).flat(3)}},{key:"getTileTexCoords",value:function(t,e){var n=this.textures[e],r=[this.tileSize/this.sheetSize[0],this.tileSize/this.sheetSize[1]];return this.geometry[t].surfaces.map((function(t){return t.map((function(t){return[(t[0]+n[0])*r[0],(t[1]+n[1])*r[1]]}))})).flat(3)}},{key:"getWalkability",value:function(t){return this.geometry[t].type}},{key:"getTileWalkPoly",value:function(t){return this.geometry[t].walkPoly}}])&&i(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),t}();function a(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var c=function(){function t(e,n,r){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.type=e,this.sprite=n,this.callback=r,this.time=(new Date).getTime(),this.id=n.id+"-"+e+"-"+this.time}var e,n;return e=t,(n=[{key:"configure",value:function(t,e,n,r,o){this.sprite=e,this.id=n,this.type=t,this.startTime=r,this.creationArgs=o}},{key:"onLoad",value:function(t){this.init.apply(this,t),this.loaded=!0}},{key:"serialize",value:function(){return{id:this.id,time:this.startTime,zone:this.sprite.zone.id,sprite:this.sprite.id,type:this.type,args:this.creationArgs}}},{key:"onComplete",value:function(){return this.callback?this.callback():null}}])&&a(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),t}();function u(t,e,n,r,o,i,s){try{var a=t[i](s),c=a.value}catch(t){return void n(t)}a.done?e(c):Promise.resolve(c).then(r,o)}function f(t){return function(){var e=this,n=arguments;return new Promise((function(r,o){var i=t.apply(e,n);function s(t){u(i,r,o,s,a,"next",t)}function a(t){u(i,r,o,s,a,"throw",t)}s(void 0)}))}}function l(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function h(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function p(t,e,n){return e&&h(t.prototype,e),n&&h(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}var y=function(){function t(e){l(this,t),this.engine=e,this.tilesets={}}var e,o;return p(t,[{key:"loadRemote",value:(o=f(regeneratorRuntime.mark((function t(e){var n,o,i;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!(n=this.tilesets[e])){t.next=3;break}return t.abrupt("return",n);case 3:return this.tilesets[e]=n=new s(this.engine),n.name=e,t.next=7,fetch(r.Z.tilesetRequestUrl(e));case 7:if(!(o=t.sent).ok){t.next=21;break}return t.prev=9,t.next=12,o.json();case 12:return i=t.sent,t.next=15,n.onJsonLoaded(i);case 15:t.next=21;break;case 17:t.prev=17,t.t0=t.catch(9),console.error("Error parsing tileset '"+n.name+"' definition"),console.error(t.t0);case 21:return t.abrupt("return",this.tilesets[e]);case 22:case"end":return t.stop()}}),t,this,[[9,17]])}))),function(t){return o.apply(this,arguments)})},{key:"load",value:(e=f(regeneratorRuntime.mark((function t(e){var r,o,i;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!(r=this.tilesets[e])){t.next=3;break}return t.abrupt("return",r);case 3:return o=new s(this.engine),this.tilesets[e]=o,i=n(7935)("./"+e+"/tileset.jsx").default,o.onJsonLoaded(i),t.abrupt("return",o);case 8:case"end":return t.stop()}}),t,this)}))),function(t){return e.apply(this,arguments)})}]),t}(),d=function(){function t(e){l(this,t),this.engine=e,this.definitions=[],this.instances={}}var e;return p(t,[{key:"load",value:(e=f(regeneratorRuntime.mark((function t(e){var r,o,i,s,a=arguments;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=a[1],o=a[2],this.instances[e]||(this.instances[e]=[]),i=n(7467)("./"+e+".jsx").default,console.log(i,e),(s=new i(this.engine)).templateLoaded=!0,this.instances[e].forEach((function(t){t.afterLoad&&t.afterLoad(t.instance)})),o&&o(s),r&&(console.log("after load"),s.templateLoaded?r(s):this.instances[e].push({instance:s,afterLoad:r})),t.abrupt("return",s);case 11:case"end":return t.stop()}}),t,this)}))),function(t){return e.apply(this,arguments)})}]),t}(),b=function(){function t(e,n,r,o,i){l(this,t),this.engine=e,this.type=n,this.args=r,this.sprite=o,this.callback=i,this.instances={},this.definitions=[];var s=(new Date).getTime(),a=o.id+"-"+n+"-"+s;return this.load(n,(function(t){t.onLoad(r)}),(function(t){t.configure(n,o,a,s,r)}))}return p(t,[{key:"load",value:function(t){var e=arguments[1],r=arguments[2];this.instances[t]||(this.instances[t]=[]);var o=new c(this.type,this.sprite,this.callback);return Object.assign(o,n(3333)("./"+t+".jsx").default),o.templateLoaded=!0,this.instances[t].forEach((function(t){t.afterLoad&&t.afterLoad(t.instance)})),r&&r(o),e&&(o.templateLoaded?e(o):this.instances[t].push({instance:o,afterLoad:e})),o}}]),t}(),m=function(){function t(e){var n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];l(this,t),this.src=e,this.audio=new Audio(e),n&&this.audio.addEventListener("ended",(function(){this.currentTime=0,this.play()}),!1),this.audio.load()}return p(t,[{key:"playAudio",value:function(){var t=this.audio.play();void 0!==t&&t.then((function(t){})).catch((function(t){console.info(t)}))}},{key:"pauseAudio",value:function(){var t=this.audio.pause();void 0!==t&&t.then((function(t){})).catch((function(t){console.info(t)}))}}]),t}()},9175:(t,e,n)=>{"use strict";function r(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var r,o,i=[],s=!0,a=!1;try{for(n=n.call(t);!(s=(r=n.next()).done)&&(i.push(r.value),!e||i.length!==e);s=!0);}catch(t){a=!0,o=t}finally{try{s||null==n.return||n.return()}finally{if(a)throw o}}return i}}(t,e)||function(t,e){if(t){if("string"==typeof t)return o(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?o(t,e):void 0}}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function o(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}n.d(e,{Ue:()=>i,G3:()=>s,Iu:()=>a,U1:()=>c,t8:()=>u});var i=function(){var t=new Float32Array(16);return t[0]=1,t[5]=1,t[10]=1,t[15]=1,t},s=function(t,e,n,r){var o=new Float32Array(16),i=1/Math.tan(t/2);if(o[0]=i/e,o[1]=0,o[2]=0,o[3]=0,o[4]=0,o[5]=i,o[6]=0,o[7]=0,o[8]=0,o[9]=0,o[10]=-1,o[11]=-1,o[12]=0,o[13]=0,o[14]=-2*n,o[15]=0,null!=r&&r!==1/0&&r!==n){var s=1/(n-r);o[10]=(r+n)*s,o[14]=2*r*n*s}return o},a=function(t,e,n){var o=t,i=r(n,3),s=i[0],a=i[1],c=i[2],u=r(e,12),f=u[0],l=u[1],h=u[2],p=u[3],y=u[4],d=u[5],b=u[6],m=u[7],v=u[8],g=u[9],O=u[10],w=u[11];return t!==e&&(o[0]=f,o[1]=l,o[2]=h,o[3]=p,o[4]=y,o[5]=d,o[6]=b,o[7]=m,o[8]=v,o[9]=g,o[10]=O,o[11]=w),o[12]=f*s+y*a+v*c+e[12],o[13]=l*s+d*a+g*c+e[13],o[14]=h*s+b*a+O*c+e[14],o[15]=p*s+m*a+w*c+e[15],o},c=function(t,e,n,o){var i=t,s=r(o,3),a=s[0],c=s[1],u=s[2],f=Math.hypot(a,c,u);if(f<1e-6)throw new Error("Matrix4*4 rotate has wrong axis");a*=f=1/f,c*=f,u*=f;var l=Math.sin(n),h=Math.cos(n),p=1-h,y=r(e,12),d=y[0],b=y[1],m=y[2],v=y[3],g=y[4],O=y[5],w=y[6],L=y[7],R=y[8],T=y[9],A=y[10],_=y[11],x=a*a*p+h,P=c*a*p+u*l,E=u*a*p-c*l,Z=a*c*p-u*l,S=c*c*p+h,k=u*c*p+a*l,W=a*u*p+c*l,j=c*u*p-a*l,M=u*u*p+h;return i[0]=d*x+g*P+R*E,i[1]=b*x+O*P+T*E,i[2]=m*x+w*P+A*E,i[3]=v*x+L*P+_*E,i[4]=d*Z+g*S+R*k,i[5]=b*Z+O*S+T*k,i[6]=m*Z+w*S+A*k,i[7]=v*Z+L*S+_*k,i[8]=d*W+g*j+R*M,i[9]=b*W+O*j+T*M,i[10]=m*W+w*j+A*M,i[11]=v*W+L*j+_*M,e!==t&&(i[12]=e[12],i[13]=e[13],i[14]=e[14],i[15]=e[15]),i};function u(t,e){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e}},8348:(t,e,n)=>{"use strict";function r(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}n.d(e,{OW:()=>o,t8:()=>i,tk:()=>s,t7:()=>a});var o=function(){function t(e,n,r){(function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")})(this,t),this.x=e,this.y=n,this.z=r}return e=t,(n=[{key:"add",value:function(e){return new t(this.x+e.x,this.y+e.y,this.z+e.z)}},{key:"sub",value:function(e){return new t(this.x-e.x,this.y-e.y,this.z-e.z)}},{key:"mul",value:function(e){return new t(this.x*e,this.y*e,this.z*e)}},{key:"length",value:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}},{key:"distance",value:function(t){return this.sub(t).length()}},{key:"normal",value:function(){if(0===this.x&&0===this.y&&0===this.z)return new t(0,0,0);var e=this.length();return new t(this.x/e,this.y/e,this.z/e)}},{key:"dot",value:function(t){return this.x*t.x+this.y*t.y+this.z*t.z}},{key:"toArray",value:function(){return[this.x,this.y,this.z]}},{key:"toString",value:function(){return"( ".concat(this.x,", ").concat(this.y,", ").concat(this.z," )")}},{key:"negate",value:function(){return new t(-1*this.x,-1*this.y,-1*this.z)}}])&&r(e.prototype,n),o&&r(e,o),Object.defineProperty(e,"prototype",{writable:!1}),t;var e,n,o}();function i(t,e){e.x=t.x,e.y=t.y,e.z=t.z}function s(t,e){return e||(e=new o(-t.x,-t.y,-t.z)),e.x=-t.x,e.y=-t.y,e.z=-t.z,e}function a(t,e,n,r){return r||(r=t),r.x=t.x+n*(e.x-t.x),r.y=t.y+n*(e.y-t.y),r.z=t.z+n*(e.z-t.z),r}},6185:(t,e,n)=>{"use strict";n.d(e,{Z:()=>r});const r={tilesetRequestUrl:function(t){return"/pixos/tilesets/"+t+"/tileset.jsx"},zoneRequestUrl:function(t){return"/pixos/maps/"+t+"/map.jsx"},artResourceUrl:function(t){return"/pixos/art/"+t}}},948:(t,e,n)=>{"use strict";n.r(e),n.d(e,{default:()=>u});var r=n(8348),o=n(4180),i=n(1262);function s(t,e,n){return s=a()?Reflect.construct:function(t,e,n){var r=[null];r.push.apply(r,e);var o=new(Function.bind.apply(t,r));return n&&c(o,n.prototype),o},s.apply(null,arguments)}function a(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}function c(t,e){return c=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},c(t,e)}const u={bounds:[0,10,17,19],tileset:"sewer",audioSrc:"/pixos/audio/blue-fields.mp3",cells:[i.Z.SLW_CORNER,i.Z.SLW_COLUMN,i.Z.FLOOR,i.Z.FLOOR,i.Z.LW_LPIT,i.Z.WATER,i.Z.WATER,i.Z.WATER,i.Z.V_WALKWAY,i.Z.WATER,i.Z.WATER,i.Z.WATER,i.Z.RW_RPIT,i.Z.FLOOR,i.Z.FLOOR,i.Z.SRW_COLUMN,i.Z.SRW_CORNER].concat([i.Z.EMPTY,i.Z.SLW_CORNER,i.Z.S_WALL,i.Z.S_WALL,i.Z.S_WALL,i.Z.SLW_WATER_COLUMN,i.Z.WATER,i.Z.WATER,i.Z.S_STAIR,i.Z.WATER,i.Z.WATER,i.Z.SRW_WATER_COLUMN,i.Z.S_WALL,i.Z.S_WALL,i.Z.S_WALL,i.Z.SRW_CORNER,i.Z.EMPTY],[i.Z.EMPTY,i.Z.EMPTY,i.Z.EMPTY,i.Z.EMPTY,i.Z.EMPTY,i.Z.L_WALL,i.Z.SW_SPIT,i.Z.SW_SPIT,i.Z.S_STAIRWALL,i.Z.SW_SPIT,i.Z.SW_SPIT,i.Z.R_WALL,i.Z.EMPTY,i.Z.EMPTY,i.Z.EMPTY,i.Z.EMPTY,i.Z.EMPTY],[i.Z.EMPTY,i.Z.EMPTY,i.Z.EMPTY,i.Z.EMPTY,i.Z.EMPTY,i.Z.L_WALL,i.Z.FLOOR,i.Z.FLOOR,i.Z.FLOOR,i.Z.FLOOR,i.Z.FLOOR,i.Z.R_WALL,i.Z.EMPTY,i.Z.EMPTY,i.Z.EMPTY,i.Z.EMPTY,i.Z.EMPTY],[i.Z.EMPTY,i.Z.EMPTY,i.Z.EMPTY,i.Z.EMPTY,i.Z.EMPTY,i.Z.L_WALL,i.Z.FLOOR,i.Z.FLOOR,i.Z.FLOOR,i.Z.FLOOR,i.Z.FLOOR,i.Z.R_WALL,i.Z.EMPTY,i.Z.EMPTY,i.Z.EMPTY,i.Z.EMPTY,i.Z.EMPTY],[i.Z.EMPTY,i.Z.EMPTY,i.Z.EMPTY,i.Z.EMPTY,i.Z.EMPTY,i.Z.SLW_CORNER,i.Z.SLW_COLUMN,i.Z.FLOOR,i.Z.FLOOR,i.Z.FLOOR,i.Z.SRW_COLUMN,i.Z.SRW_CORNER,i.Z.EMPTY,i.Z.EMPTY,i.Z.EMPTY,i.Z.EMPTY,i.Z.EMPTY],[i.Z.EMPTY,i.Z.EMPTY,i.Z.EMPTY,i.Z.EMPTY,i.Z.EMPTY,i.Z.EMPTY,i.Z.SLW_CORNER,i.Z.S_WALL,i.Z.S_WALL,i.Z.S_WALL,i.Z.SRW_CORNER,i.Z.EMPTY,i.Z.EMPTY,i.Z.EMPTY,i.Z.EMPTY,i.Z.EMPTY,i.Z.EMPTY],[i.Z.EMPTY,i.Z.EMPTY,i.Z.EMPTY,i.Z.EMPTY,i.Z.EMPTY,i.Z.EMPTY,i.Z.EMPTY,i.Z.EMPTY,i.Z.EMPTY,i.Z.EMPTY,i.Z.EMPTY,i.Z.EMPTY,i.Z.EMPTY,i.Z.EMPTY,i.Z.EMPTY,i.Z.EMPTY,i.Z.EMPTY],[i.Z.EMPTY,i.Z.EMPTY,i.Z.EMPTY,i.Z.EMPTY,i.Z.EMPTY,i.Z.EMPTY,i.Z.EMPTY,i.Z.EMPTY,i.Z.EMPTY,i.Z.EMPTY,i.Z.EMPTY,i.Z.EMPTY,i.Z.EMPTY,i.Z.EMPTY,i.Z.EMPTY,i.Z.EMPTY,i.Z.EMPTY]),sprites:[{id:"water",type:"npc/water-knight",pos:s(r.OW,[8,13,0]),facing:o.N.Up},{id:"spurt8",type:"effects/waterspurt",pos:s(r.OW,[7,10,-1.5]),facing:o.N.Up},{id:"spurt9",type:"effects/waterspurt",pos:s(r.OW,[10,10,-1.5]),facing:o.N.Up}],scripts:[{id:"load-scene",trigger:function(){console.log("Triggered")}}],scenes:[]}},4805:(t,e,n)=>{"use strict";n.r(e),n.d(e,{default:()=>u});var r=n(8348),o=n(4180),i=n(1262);function s(t,e,n){return s=a()?Reflect.construct:function(t,e,n){var r=[null];r.push.apply(r,e);var o=new(Function.bind.apply(t,r));return n&&c(o,n.prototype),o},s.apply(null,arguments)}function a(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}function c(t,e){return c=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},c(t,e)}const u={bounds:[0,0,17,10],tileset:"sewer",cells:[i.Z.EMPTY,i.Z.EMPTY,i.Z.EMPTY,i.Z.EMPTY,i.Z.EMPTY,i.Z.EMPTY,i.Z.NLW_CORNER,i.Z.N_WALL,i.Z.N_WALL,i.Z.N_WALL,i.Z.NRW_CORNER,i.Z.EMPTY,i.Z.EMPTY,i.Z.EMPTY,i.Z.EMPTY,i.Z.EMPTY,i.Z.EMPTY].concat([i.Z.EMPTY,i.Z.EMPTY,i.Z.EMPTY,i.Z.EMPTY,i.Z.EMPTY,i.Z.NLW_CORNER,i.Z.NLW_COLUMN,i.Z.FLOOR,i.Z.FLOOR,i.Z.FLOOR,i.Z.NRW_COLUMN,i.Z.NRW_CORNER,i.Z.EMPTY,i.Z.EMPTY,i.Z.EMPTY,i.Z.EMPTY,i.Z.EMPTY],[i.Z.EMPTY,i.Z.EMPTY,i.Z.EMPTY,i.Z.EMPTY,i.Z.EMPTY,i.Z.L_WALL,i.Z.FLOOR,i.Z.FLOOR,i.Z.FLOOR,i.Z.FLOOR,i.Z.FLOOR,i.Z.R_WALL,i.Z.EMPTY,i.Z.EMPTY,i.Z.EMPTY,i.Z.EMPTY,i.Z.EMPTY],[i.Z.EMPTY,i.Z.EMPTY,i.Z.EMPTY,i.Z.EMPTY,i.Z.EMPTY,i.Z.L_WALL,i.Z.FLOOR,i.Z.FLOOR,i.Z.FLOOR,i.Z.FLOOR,i.Z.FLOOR,i.Z.R_WALL,i.Z.EMPTY,i.Z.EMPTY,i.Z.EMPTY,i.Z.EMPTY,i.Z.EMPTY],[i.Z.EMPTY,i.Z.EMPTY,i.Z.EMPTY,i.Z.EMPTY,i.Z.EMPTY,i.Z.L_WALL,i.Z.NW_NPIT,i.Z.NW_NPIT,i.Z.N_STAIRWALL,i.Z.NW_NPIT,i.Z.NW_NPIT,i.Z.R_WALL,i.Z.EMPTY,i.Z.EMPTY,i.Z.EMPTY,i.Z.EMPTY,i.Z.EMPTY],[i.Z.EMPTY,i.Z.NLW_CORNER,i.Z.N_WALL,i.Z.N_WALL,i.Z.N_WALL,i.Z.NLW_WATER_COLUMN,i.Z.WATER,i.Z.WATER,i.Z.N_STAIR,i.Z.WATER,i.Z.WATER,i.Z.NRW_WATER_COLUMN,i.Z.N_WALL,i.Z.N_WALL,i.Z.N_WALL,i.Z.NRW_CORNER,i.Z.EMPTY],[i.Z.NLW_CORNER,i.Z.NLW_COLUMN,i.Z.FLOOR,i.Z.FLOOR,i.Z.LW_LPIT,i.Z.WATER,i.Z.WATER,i.Z.WATER,i.Z.V_WALKWAY,i.Z.WATER,i.Z.WATER,i.Z.WATER,i.Z.RW_RPIT,i.Z.FLOOR,i.Z.FLOOR,i.Z.NRW_COLUMN,i.Z.NRW_CORNER],[i.Z.L_WALL,i.Z.FLOOR,i.Z.FLOOR,i.Z.FLOOR,i.Z.LW_LPIT,i.Z.WATER,i.Z.WATER,i.Z.WATER,i.Z.V_WALKWAY,i.Z.WATER,i.Z.WATER,i.Z.WATER,i.Z.RW_RPIT,i.Z.FLOOR,i.Z.FLOOR,i.Z.FLOOR,i.Z.R_WALL],[i.Z.L_WALL,i.Z.FLOOR,i.Z.FLOOR,i.Z.FLOOR,i.Z.L_STAIRWALL,i.Z.L_STAIR,i.Z.H_WALKWAY,i.Z.H_WALKWAY,i.Z.C_WALKWAY,i.Z.H_WALKWAY,i.Z.H_WALKWAY,i.Z.R_STAIR,i.Z.R_STAIRWALL,i.Z.FLOOR,i.Z.FLOOR,i.Z.FLOOR,i.Z.R_WALL],[i.Z.L_WALL,i.Z.FLOOR,i.Z.FLOOR,i.Z.FLOOR,i.Z.LW_LPIT,i.Z.WATER,i.Z.WATER,i.Z.WATER,i.Z.V_WALKWAY,i.Z.WATER,i.Z.WATER,i.Z.WATER,i.Z.RW_RPIT,i.Z.FLOOR,i.Z.FLOOR,i.Z.FLOOR,i.Z.R_WALL]),sprites:[{id:"darkness",type:"npc/darkness",pos:s(r.OW,[10,4,0]),facing:o.N.Down},{id:"air",type:"npc/air-knight",pos:s(r.OW,[8,4,0]),facing:o.N.Down},{id:"fire",type:"npc/fire-knight",pos:s(r.OW,[2,9,0]),facing:o.N.Right},{id:"earth",type:"npc/earth-knight",pos:s(r.OW,[14,7,0]),facing:o.N.Left},{id:"door",type:"furniture/door",pos:s(r.OW,[2,5,0]),facing:o.N.Down,zones:["room"]},{id:"spurt1",type:"effects/waterspurt",pos:s(r.OW,[10,7,-1.5]),facing:o.N.Up},{id:"spurt2",type:"effects/waterspurt",pos:s(r.OW,[9,6,-1.5]),facing:o.N.Up},{id:"spurt3",type:"effects/waterspurt",pos:s(r.OW,[10,5,-1.5]),facing:o.N.Up},{id:"spurt4",type:"effects/waterspurt",pos:s(r.OW,[7,6,-1.5]),facing:o.N.Up},{id:"spurt5",type:"effects/waterspurt",pos:s(r.OW,[6,7,-1.5]),facing:o.N.Up},{id:"spurt6",type:"effects/waterspurt",pos:s(r.OW,[6,9,-1.5]),facing:o.N.Up},{id:"spurt7",type:"effects/waterspurt",pos:s(r.OW,[9,9,-1.5]),facing:o.N.Up},{id:"avatar",type:"characters/default",pos:s(r.OW,[2,6,0]),facing:o.N.Down}],scenes:[],scripts:[]}},5686:(t,e,n)=>{"use strict";n.r(e),n.d(e,{default:()=>l});var r=n(8348),o=n(4180),i=n(1262);function s(t,e,n,r,o,i,s){try{var a=t[i](s),c=a.value}catch(t){return void n(t)}a.done?e(c):Promise.resolve(c).then(r,o)}function a(t){return function(){var e=this,n=arguments;return new Promise((function(r,o){var i=t.apply(e,n);function a(t){s(i,r,o,a,c,"next",t)}function c(t){s(i,r,o,a,c,"throw",t)}a(void 0)}))}}function c(t,e,n){return c=u()?Reflect.construct:function(t,e,n){var r=[null];r.push.apply(r,e);var o=new(Function.bind.apply(t,r));return n&&f(o,n.prototype),o},c.apply(null,arguments)}function u(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}function f(t,e){return f=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},f(t,e)}const l={bounds:[0,0,17,19],tileset:"sewer",cells:[i.Z.EMPTY,i.Z.EMPTY,i.Z.EMPTY,i.Z.EMPTY,i.Z.EMPTY,i.Z.EMPTY,i.Z.EMPTY,i.Z.EMPTY,i.Z.EMPTY,i.Z.EMPTY,i.Z.EMPTY,i.Z.EMPTY,i.Z.EMPTY,i.Z.EMPTY,i.Z.EMPTY,i.Z.EMPTY,i.Z.EMPTY].concat([i.Z.EMPTY,i.Z.EMPTY,i.Z.NLW_CORNER,i.Z.N_WALL,i.Z.N_WALL,i.Z.N_WALL,i.Z.N_WALL,i.Z.N_WALL,i.Z.N_WALL,i.Z.N_WALL,i.Z.N_WALL,i.Z.N_WALL,i.Z.N_WALL,i.Z.N_WALL,i.Z.NRW_CORNER,i.Z.EMPTY,i.Z.EMPTY],[i.Z.EMPTY,i.Z.NLW_CORNER,i.Z.NLW_COLUMN,i.Z.FLOOR,i.Z.FLOOR,i.Z.FLOOR,i.Z.FLOOR,i.Z.FLOOR,i.Z.FLOOR,i.Z.FLOOR,i.Z.FLOOR,i.Z.FLOOR,i.Z.FLOOR,i.Z.FLOOR,i.Z.NRW_COLUMN,i.Z.NRW_CORNER,i.Z.EMPTY],[i.Z.EMPTY,i.Z.L_WALL,i.Z.FLOOR,i.Z.FLOOR,i.Z.FLOOR,i.Z.FLOOR,i.Z.FLOOR,i.Z.FLOOR,i.Z.FLOOR,i.Z.FLOOR,i.Z.FLOOR,i.Z.FLOOR,i.Z.FLOOR,i.Z.FLOOR,i.Z.FLOOR,i.Z.R_WALL,i.Z.EMPTY],[i.Z.EMPTY,i.Z.L_WALL,i.Z.FLOOR,i.Z.FLOOR,i.Z.FLOOR,i.Z.FLOOR,i.Z.FLOOR,i.Z.FLOOR,i.Z.FLOOR,i.Z.FLOOR,i.Z.FLOOR,i.Z.FLOOR,i.Z.FLOOR,i.Z.FLOOR,i.Z.FLOOR,i.Z.R_WALL,i.Z.EMPTY],[i.Z.EMPTY,i.Z.L_WALL,i.Z.FLOOR,i.Z.FLOOR,i.Z.FLOOR,i.Z.FLOOR,i.Z.FLOOR,i.Z.FLOOR,i.Z.FLOOR,i.Z.FLOOR,i.Z.FLOOR,i.Z.FLOOR,i.Z.FLOOR,i.Z.FLOOR,i.Z.FLOOR,i.Z.R_WALL,i.Z.EMPTY],[i.Z.EMPTY,i.Z.L_WALL,i.Z.FLOOR,i.Z.FLOOR,i.Z.FLOOR,i.Z.FLOOR,i.Z.FLOOR,i.Z.FLOOR,i.Z.FLOOR,i.Z.FLOOR,i.Z.FLOOR,i.Z.FLOOR,i.Z.FLOOR,i.Z.FLOOR,i.Z.FLOOR,i.Z.R_WALL,i.Z.EMPTY],[i.Z.EMPTY,i.Z.L_WALL,i.Z.FLOOR,i.Z.FLOOR,i.Z.FLOOR,i.Z.FLOOR,i.Z.FLOOR,i.Z.FLOOR,i.Z.FLOOR,i.Z.FLOOR,i.Z.FLOOR,i.Z.FLOOR,i.Z.FLOOR,i.Z.FLOOR,i.Z.FLOOR,i.Z.R_WALL,i.Z.EMPTY],[i.Z.EMPTY,i.Z.L_WALL,i.Z.FLOOR,i.Z.FLOOR,i.Z.FLOOR,i.Z.FLOOR,i.Z.FLOOR,i.Z.FLOOR,i.Z.FLOOR,i.Z.FLOOR,i.Z.FLOOR,i.Z.FLOOR,i.Z.FLOOR,i.Z.FLOOR,i.Z.FLOOR,i.Z.R_WALL,i.Z.EMPTY],[i.Z.EMPTY,i.Z.L_WALL,i.Z.FLOOR,i.Z.FLOOR,i.Z.FLOOR,i.Z.FLOOR,i.Z.FLOOR,i.Z.FLOOR,i.Z.FLOOR,i.Z.FLOOR,i.Z.FLOOR,i.Z.FLOOR,i.Z.FLOOR,i.Z.FLOOR,i.Z.FLOOR,i.Z.R_WALL,i.Z.EMPTY],[i.Z.EMPTY,i.Z.L_WALL,i.Z.FLOOR,i.Z.FLOOR,i.Z.FLOOR,i.Z.FLOOR,i.Z.FLOOR,i.Z.FLOOR,i.Z.FLOOR,i.Z.FLOOR,i.Z.FLOOR,i.Z.FLOOR,i.Z.FLOOR,i.Z.FLOOR,i.Z.FLOOR,i.Z.R_WALL,i.Z.EMPTY],[i.Z.EMPTY,i.Z.L_WALL,i.Z.FLOOR,i.Z.FLOOR,i.Z.FLOOR,i.Z.FLOOR,i.Z.FLOOR,i.Z.FLOOR,i.Z.FLOOR,i.Z.FLOOR,i.Z.FLOOR,i.Z.FLOOR,i.Z.FLOOR,i.Z.FLOOR,i.Z.FLOOR,i.Z.R_WALL,i.Z.EMPTY],[i.Z.EMPTY,i.Z.L_WALL,i.Z.FLOOR,i.Z.FLOOR,i.Z.FLOOR,i.Z.FLOOR,i.Z.FLOOR,i.Z.FLOOR,i.Z.FLOOR,i.Z.FLOOR,i.Z.FLOOR,i.Z.FLOOR,i.Z.FLOOR,i.Z.FLOOR,i.Z.FLOOR,i.Z.R_WALL,i.Z.EMPTY],[i.Z.EMPTY,i.Z.L_WALL,i.Z.FLOOR,i.Z.FLOOR,i.Z.FLOOR,i.Z.FLOOR,i.Z.FLOOR,i.Z.FLOOR,i.Z.FLOOR,i.Z.FLOOR,i.Z.FLOOR,i.Z.FLOOR,i.Z.FLOOR,i.Z.FLOOR,i.Z.FLOOR,i.Z.R_WALL,i.Z.EMPTY],[i.Z.EMPTY,i.Z.L_WALL,i.Z.FLOOR,i.Z.FLOOR,i.Z.FLOOR,i.Z.FLOOR,i.Z.FLOOR,i.Z.FLOOR,i.Z.FLOOR,i.Z.FLOOR,i.Z.FLOOR,i.Z.FLOOR,i.Z.FLOOR,i.Z.FLOOR,i.Z.FLOOR,i.Z.R_WALL,i.Z.EMPTY],[i.Z.EMPTY,i.Z.L_WALL,i.Z.FLOOR,i.Z.FLOOR,i.Z.FLOOR,i.Z.FLOOR,i.Z.FLOOR,i.Z.FLOOR,i.Z.FLOOR,i.Z.FLOOR,i.Z.FLOOR,i.Z.FLOOR,i.Z.FLOOR,i.Z.FLOOR,i.Z.FLOOR,i.Z.R_WALL,i.Z.EMPTY],[i.Z.EMPTY,i.Z.SLW_CORNER,i.Z.SLW_COLUMN,i.Z.FLOOR,i.Z.FLOOR,i.Z.FLOOR,i.Z.FLOOR,i.Z.FLOOR,i.Z.FLOOR,i.Z.FLOOR,i.Z.FLOOR,i.Z.FLOOR,i.Z.FLOOR,i.Z.FLOOR,i.Z.SRW_COLUMN,i.Z.SRW_CORNER,i.Z.EMPTY],[i.Z.EMPTY,i.Z.EMPTY,i.Z.SLW_CORNER,i.Z.S_WALL,i.Z.S_WALL,i.Z.S_WALL,i.Z.S_WALL,i.Z.S_WALL,i.Z.S_WALL,i.Z.S_WALL,i.Z.S_WALL,i.Z.S_WALL,i.Z.S_WALL,i.Z.S_WALL,i.Z.SRW_CORNER,i.Z.EMPTY,i.Z.EMPTY],[i.Z.EMPTY,i.Z.EMPTY,i.Z.EMPTY,i.Z.EMPTY,i.Z.EMPTY,i.Z.EMPTY,i.Z.EMPTY,i.Z.EMPTY,i.Z.EMPTY,i.Z.EMPTY,i.Z.EMPTY,i.Z.EMPTY,i.Z.EMPTY,i.Z.EMPTY,i.Z.EMPTY,i.Z.EMPTY,i.Z.EMPTY]),sprites:[{id:"chest",type:"objects/chests/wood",pos:c(r.OW,[8,14,0]),facing:o.N.Down},{id:"chestmetal",type:"objects/chests/metal",pos:c(r.OW,[9,13,0]),facing:o.N.Right},{id:"chestred",type:"objects/chests/red",pos:c(r.OW,[9,14,0]),facing:o.N.Down},{id:"chestblue",type:"objects/chests/blue",pos:c(r.OW,[7,13,0]),facing:o.N.Left},{id:"door",type:"furniture/door",pos:c(r.OW,[9,1,0]),facing:o.N.Down,zones:["dungeon-top","dungeon-bottom"]},{id:"tree",type:"furniture/tree",pos:c(r.OW,[8,13,0]),facing:o.N.Up},{id:"fireplace",type:"furniture/fireplace",pos:c(r.OW,[11,1,0]),facing:o.N.Up},{id:"fireplace",type:"effects/fireplace",pos:c(r.OW,[11,1,0]),facing:o.N.Up},{id:"darkness",type:"npc/darkness",pos:c(r.OW,[6,2,0]),facing:o.N.Down},{id:"air",type:"npc/air-knight",pos:c(r.OW,[8,2,0]),facing:o.N.Down},{id:"fire",type:"npc/fire-knight",pos:c(r.OW,[2,8,0]),facing:o.N.Right},{id:"earth",type:"npc/earth-knight",pos:c(r.OW,[14,8,0]),facing:o.N.Left},{id:"avatar",type:"characters/default",pos:c(r.OW,[9,2,0]),facing:o.N.Down}],scenes:[{id:"strange-legend",actions:[{sprite:"air",action:"dialogue",args:[["Long ago, in a dungeon far far away","The sewer was backing up, and well...everyone was losing their $%#t","But one had a plan..."],!1,{autoclose:!0}],scope:void 0},{sprite:"air",action:"dialogue",args:[["But what was that plan?..."],!1,{autoclose:!0}],scope:void 0},{trigger:"custom",scope:void 0}]}],scripts:[{id:"load-scene",trigger:(y=a(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.playScene("strange-legend");case 2:case"end":return t.stop()}}),t,this)}))),function(){return y.apply(this,arguments)})},{id:"custom",trigger:(p=a(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.spriteDialogue("earth",["Lets get in there!"]);case 2:case"end":return t.stop()}}),t,this)}))),function(){return p.apply(this,arguments)})},{id:"clear-path",trigger:(h=a(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.moveSprite("darkness",[8,3,0],!0);case 2:case"end":return t.stop()}}),t,this)}))),function(){return h.apply(this,arguments)})}]};var h,p,y},642:(t,e,n)=>{"use strict";n.r(e),n.d(e,{default:()=>u});var r=n(8348),o=n(6185);function i(t){return i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},i(t)}function s(t,e){return s=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},s(t,e)}function a(t,e){if(e&&("object"===i(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function c(t){return c=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},c(t)}var u=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");Object.defineProperty(t,"prototype",{value:Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),writable:!1}),e&&s(t,e)}(f,t);var e,n,i,u=(n=f,i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,e=c(n);if(i){var r=c(this).constructor;t=Reflect.construct(e,arguments,r)}else t=e.apply(this,arguments);return a(this,t)});function f(t){var e;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,f),(e=u.call(this,t)).src=o.Z.artResourceUrl("player.gif"),e.portraitSrc=o.Z.artResourceUrl("hero_portrait.gif"),e.sheetSize=[128,256],e.tileSize=[24,32],e.state="intro",e.frames={up:[[0,0],[24,0],[48,0],[24,0]],right:[[0,32],[24,32],[48,32],[24,32]],down:[[0,64],[24,64],[48,64],[24,64]],left:[[0,96],[24,96],[48,96],[24,96]]},e.drawOffset=new r.OW(-.25,1,.125),e.hotspotOffset=new r.OW(.5,.5,0),e.bindCamera=!0,e.enableSpeech=!0,e}return e=f,Object.defineProperty(e,"prototype",{writable:!1}),e}(n(6180).Z)},7154:(t,e,n)=>{"use strict";n.r(e),n.d(e,{default:()=>u});var r=n(8348),o=n(6185);function i(t){return i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},i(t)}function s(t,e){return s=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},s(t,e)}function a(t,e){if(e&&("object"===i(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function c(t){return c=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},c(t)}var u=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");Object.defineProperty(t,"prototype",{value:Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),writable:!1}),e&&s(t,e)}(f,t);var e,n,i,u=(n=f,i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,e=c(n);if(i){var r=c(this).constructor;t=Reflect.construct(e,arguments,r)}else t=e.apply(this,arguments);return a(this,t)});function f(t){var e;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,f),(e=u.call(this,t)).src=o.Z.artResourceUrl("player.gif"),e.portraitSrc=o.Z.artResourceUrl("hero_portrait.gif"),e.sheetSize=[128,256],e.tileSize=[24,32],e.state="intro",e.frames={up:[[0,0],[24,0],[48,0],[24,0]],right:[[0,32],[24,32],[48,32],[24,32]],down:[[0,64],[24,64],[48,64],[24,64]],left:[[0,96],[24,96],[48,96],[24,96]]},e.drawOffset=new r.OW(-.25,1,.125),e.hotspotOffset=new r.OW(.5,.5,0),e.bindCamera=!0,e.enableSpeech=!0,e}return e=f,Object.defineProperty(e,"prototype",{writable:!1}),e}(n(6180).Z)},597:(t,e,n)=>{"use strict";n.r(e),n.d(e,{default:()=>O});var r=n(8348),o=n(6185),i=n(9175);function s(t){return s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},s(t)}function a(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function c(t,e){return c=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},c(t,e)}function u(t,e){if(e&&("object"===s(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function f(t){return f=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},f(t)}function l(t){return l="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},l(t)}function h(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function p(t,e){return p=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},p(t,e)}function y(t,e){if(e&&("object"===l(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function d(t){return d=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},d(t)}function b(t){return b="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},b(t)}function m(t,e){return m=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},m(t,e)}function v(t,e){if(e&&("object"===b(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function g(t){return g=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},g(t)}var O=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");Object.defineProperty(t,"prototype",{value:Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),writable:!1}),e&&m(t,e)}(i,t);var e,n,r,o=(n=i,r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,e=g(n);if(r){var o=g(this).constructor;t=Reflect.construct(e,arguments,o)}else t=e.apply(this,arguments);return v(this,t)});function i(t){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,i),o.call(this,t)}return e=i,Object.defineProperty(e,"prototype",{writable:!1}),e}(function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");Object.defineProperty(t,"prototype",{value:Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),writable:!1}),e&&p(t,e)}(c,t);var e,n,i,s,a=(i=c,s=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,e=d(i);if(s){var n=d(this).constructor;t=Reflect.construct(e,arguments,n)}else t=e.apply(this,arguments);return y(this,t)});function c(t){var e;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,c),(e=a.call(this,t)).src=o.Z.artResourceUrl("room.gif"),e.sheetSize=[256,256],e.tileSize=[48,32],e.frames={up:[[0,144],[48,144],[0,176],[48,176]]},e.drawOffset=new r.OW(0,1.85,-.02),e.hotspotOffset=new r.OW(.5,.5,0),e.frameTime=150,e}return e=c,(n=[{key:"init",value:function(){this.triggerTime=1e3}}])&&h(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),c}(function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");Object.defineProperty(t,"prototype",{value:Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),writable:!1}),e&&c(t,e)}(l,t);var e,n,r,o,s=(r=l,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,e=f(r);if(o){var n=f(this).constructor;t=Reflect.construct(e,arguments,n)}else t=e.apply(this,arguments);return u(this,t)});function l(t){var e;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,l),(e=s.call(this,t)).enableSpeech=!1,e.lastTime=0,e.accumTime=0,e.triggerTime=400,e.frameTime=250,e}return e=l,(n=[{key:"init",value:function(){this.triggerTime=1e3+Math.floor(5e3*Math.random())}},{key:"tick",value:function(t){0!=this.lastTime?(this.accumTime+=t-this.lastTime,this.accumTime<this.frameTime||0==this.animFrame&&this.accumTime<this.triggerTime||(5==this.animFrame?(this.setFrame(0),this.triggerTime=1e3+Math.floor(4e3*Math.random())):(this.setFrame(this.animFrame+1),this.accumTime=0,this.lastTime=t))):this.lastTime=t}},{key:"draw",value:function(t){this.loaded&&(t.mvPushMatrix(),(0,i.Iu)(this.engine.uViewMat,this.engine.uViewMat,this.drawOffset.toArray()),(0,i.Iu)(this.engine.uViewMat,this.engine.uViewMat,this.pos.toArray()),(0,i.U1)(this.engine.uViewMat,this.engine.uViewMat,this.engine.degToRad(this.engine.cameraAngle),[1,0,0]),t.bindBuffer(this.vertexPosBuf,t.shaderProgram.vertexPositionAttribute),t.bindBuffer(this.vertexTexBuf,t.shaderProgram.textureCoordAttribute),this.texture.attach(),t.gl.depthFunc(t.gl.ALWAYS),t.shaderProgram.setMatrixUniforms(),t.gl.drawArrays(t.gl.TRIANGLES,0,this.vertexPosBuf.numItems),t.gl.depthFunc(t.gl.LESS),t.mvPopMatrix())}}])&&a(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),l}(n(5870).Z)))},5359:(t,e,n)=>{"use strict";n.r(e),n.d(e,{default:()=>O});var r=n(8348),o=n(6185),i=n(9175);function s(t){return s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},s(t)}function a(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function c(t,e){return c=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},c(t,e)}function u(t,e){if(e&&("object"===s(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function f(t){return f=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},f(t)}function l(t){return l="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},l(t)}function h(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function p(t,e){return p=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},p(t,e)}function y(t,e){if(e&&("object"===l(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function d(t){return d=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},d(t)}function b(t){return b="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},b(t)}function m(t,e){return m=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},m(t,e)}function v(t,e){if(e&&("object"===b(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function g(t){return g=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},g(t)}var O=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");Object.defineProperty(t,"prototype",{value:Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),writable:!1}),e&&m(t,e)}(i,t);var e,n,r,o=(n=i,r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,e=g(n);if(r){var o=g(this).constructor;t=Reflect.construct(e,arguments,o)}else t=e.apply(this,arguments);return v(this,t)});function i(t){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,i),o.call(this,t)}return e=i,Object.defineProperty(e,"prototype",{writable:!1}),e}(function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");Object.defineProperty(t,"prototype",{value:Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),writable:!1}),e&&p(t,e)}(c,t);var e,n,i,s,a=(i=c,s=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,e=d(i);if(s){var n=d(this).constructor;t=Reflect.construct(e,arguments,n)}else t=e.apply(this,arguments);return y(this,t)});function c(t){var e;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,c),(e=a.call(this,t)).src=o.Z.artResourceUrl("sewer.gif"),e.sheetSize=[256,256],e.tileSize=[16,16],e.frames={up:[[0,144],[16,144],[32,144],[48,144],[64,144],[80,144]]},e.drawOffset=new r.OW(0,1,.001),e.hotspotOffset=new r.OW(.5,.5,0),e.frameTime=150,e}return e=c,(n=[{key:"init",value:function(){this.triggerTime=1e3+5e3*Math.random()}}])&&h(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),c}(function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");Object.defineProperty(t,"prototype",{value:Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),writable:!1}),e&&c(t,e)}(l,t);var e,n,r,o,s=(r=l,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,e=f(r);if(o){var n=f(this).constructor;t=Reflect.construct(e,arguments,n)}else t=e.apply(this,arguments);return u(this,t)});function l(t){var e;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,l),(e=s.call(this,t)).enableSpeech=!1,e.lastTime=0,e.accumTime=0,e.triggerTime=400,e.frameTime=250,e.blocking=!1,e}return e=l,(n=[{key:"init",value:function(){this.triggerTime=2e3}},{key:"tick",value:function(t){0!=this.lastTime?(this.accumTime+=t-this.lastTime,this.accumTime<this.frameTime||0==this.animFrame&&this.accumTime<this.triggerTime||(4==this.animFrame?(this.setFrame(0),this.triggerTime=2e3+Math.floor(4e3*Math.random())):(this.setFrame(this.animFrame+1),this.accumTime=0,this.lastTime=t))):this.lastTime=t}},{key:"draw",value:function(t){this.loaded&&(t.mvPushMatrix(),(0,i.Iu)(t.uViewMat,t.uViewMat,this.pos.toArray()),(0,i.Iu)(t.uViewMat,t.uViewMat,this.drawOffset.toArray()),(0,i.U1)(t.uViewMat,t.uViewMat,t.degToRad(90),[1,0,0]),t.bindBuffer(this.vertexPosBuf,t.shaderProgram.vertexPositionAttribute),t.bindBuffer(this.vertexTexBuf,t.shaderProgram.textureCoordAttribute),this.texture.attach(),t.shaderProgram.setMatrixUniforms(),t.gl.drawArrays(t.gl.TRIANGLES,0,this.vertexPosBuf.numItems),t.mvPopMatrix())}}])&&a(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),l}(n(5870).Z)))},7085:(t,e,n)=>{"use strict";n.r(e),n.d(e,{default:()=>m});var r=n(8348),o=n(6185),i=n(5870),s=n(9337);function a(t){return a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},a(t)}function c(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function u(t,e){return u=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},u(t,e)}function f(t,e){if(e&&("object"===a(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function l(t){return l=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},l(t)}var h=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");Object.defineProperty(t,"prototype",{value:Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),writable:!1}),e&&u(t,e)}(p,t);var e,n,i,a,h=(i=p,a=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,e=l(i);if(a){var n=l(this).constructor;t=Reflect.construct(e,arguments,n)}else t=e.apply(this,arguments);return f(this,t)});function p(t){var e;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,p),(e=h.call(this,t)).src=o.Z.artResourceUrl("room.gif"),e.sheetSize=[256,256],e.tileSize=[16,32],e.frames={up:[[48,64],[48,96]],right:[[48,64],[48,96]],left:[[48,64],[48,96]],down:[[48,64],[48,96]]},e.drawOffset=new r.OW(0,1.001,.001),e.hotspotOffset=new r.OW(.5,.5,0),e.state="closed",e}return e=p,n=[{key:"interact",value:function(t,e){console.log("opening door",t);var n=null;switch(this.startTime=Date.now(),this.state){case"closed":this.state="open",this.blocking=!1,this.override=!0,n=new s.aW(this.engine,"animate",[600,3,function(){console.log("OPENED!!!"),e(!0)}],this);break;case"open":this.state="open",n=new s.aW(this.engine,"dialogue",["Its already Open!.",!1,{autoclose:!0,onClose:function(){return e(!0)}}],this)}return n&&this.addAction(n),e&&e(!1),n}},{key:"onStep",value:function(t){console.log("walking out....",t);var e=this.zone.world;return e.removeAllZones(),this.zones&&this.zones.forEach((function(t){return e.loadZone(t)})),null}}],n&&c(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),p}(i.Z);function p(t){return p="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},p(t)}function y(t,e){return y=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},y(t,e)}function d(t,e){if(e&&("object"===p(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function b(t){return b=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},b(t)}var m=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");Object.defineProperty(t,"prototype",{value:Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),writable:!1}),e&&y(t,e)}(i,t);var e,n,r,o=(n=i,r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,e=b(n);if(r){var o=b(this).constructor;t=Reflect.construct(e,arguments,o)}else t=e.apply(this,arguments);return d(this,t)});function i(t){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,i),o.call(this,t)}return e=i,Object.defineProperty(e,"prototype",{writable:!1}),e}(h)},6463:(t,e,n)=>{"use strict";n.r(e),n.d(e,{default:()=>p});var r=n(8348),o=n(6185);function i(t){return i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},i(t)}function s(t,e){return s=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},s(t,e)}function a(t,e){if(e&&("object"===i(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function c(t){return c=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},c(t)}function u(t){return u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},u(t)}function f(t,e){return f=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},f(t,e)}function l(t,e){if(e&&("object"===u(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function h(t){return h=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},h(t)}var p=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");Object.defineProperty(t,"prototype",{value:Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),writable:!1}),e&&f(t,e)}(i,t);var e,n,r,o=(n=i,r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,e=h(n);if(r){var o=h(this).constructor;t=Reflect.construct(e,arguments,o)}else t=e.apply(this,arguments);return l(this,t)});function i(t){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,i),o.call(this,t)}return e=i,Object.defineProperty(e,"prototype",{writable:!1}),e}(function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");Object.defineProperty(t,"prototype",{value:Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),writable:!1}),e&&s(t,e)}(f,t);var e,n,i,u=(n=f,i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,e=c(n);if(i){var r=c(this).constructor;t=Reflect.construct(e,arguments,r)}else t=e.apply(this,arguments);return a(this,t)});function f(t){var e;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,f),(e=u.call(this,t)).src=o.Z.artResourceUrl("room.gif"),e.sheetSize=[256,256],e.tileSize=[48,80],e.frames={up:[[160,80]]},e.drawOffset=new r.OW(0,1.85,.001),e.hotspotOffset=new r.OW(.5,.5,0),e}return e=f,Object.defineProperty(e,"prototype",{writable:!1}),e}(n(5870).Z))},5624:(t,e,n)=>{"use strict";n.r(e),n.d(e,{default:()=>p});var r=n(8348),o=n(6185);function i(t){return i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},i(t)}function s(t,e){return s=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},s(t,e)}function a(t,e){if(e&&("object"===i(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function c(t){return c=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},c(t)}function u(t){return u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},u(t)}function f(t,e){return f=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},f(t,e)}function l(t,e){if(e&&("object"===u(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function h(t){return h=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},h(t)}var p=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");Object.defineProperty(t,"prototype",{value:Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),writable:!1}),e&&f(t,e)}(i,t);var e,n,r,o=(n=i,r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,e=h(n);if(r){var o=h(this).constructor;t=Reflect.construct(e,arguments,o)}else t=e.apply(this,arguments);return l(this,t)});function i(t){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,i),o.call(this,t)}return e=i,Object.defineProperty(e,"prototype",{writable:!1}),e}(function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");Object.defineProperty(t,"prototype",{value:Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),writable:!1}),e&&s(t,e)}(f,t);var e,n,i,u=(n=f,i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,e=c(n);if(i){var r=c(this).constructor;t=Reflect.construct(e,arguments,r)}else t=e.apply(this,arguments);return a(this,t)});function f(t){var e;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,f),(e=u.call(this,t)).src=o.Z.artResourceUrl("trees.png"),e.sheetSize=[512,512],e.tileSize=[96,144],e.frames={up:[[96,160]]},e.drawOffset=new r.OW(-2.5,2.15,-.85),e.hotspotOffset=new r.OW(.5,.5,0),e.blocking=!0,e}return e=f,Object.defineProperty(e,"prototype",{writable:!1}),e}(n(5870).Z))},5378:(t,e,n)=>{"use strict";n.r(e),n.d(e,{default:()=>m});var r=n(9337),o=n(8348),i=n(6185);function s(t){return s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},s(t)}function a(t,e){return a=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},a(t,e)}function c(t,e){if(e&&("object"===s(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function u(t){return u=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},u(t)}function f(t){return f="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},f(t)}function l(t,e,n,r,o,i,s){try{var a=t[i](s),c=a.value}catch(t){return void n(t)}a.done?e(c):Promise.resolve(c).then(r,o)}function h(t){return function(){var e=this,n=arguments;return new Promise((function(r,o){var i=t.apply(e,n);function s(t){l(i,r,o,s,a,"next",t)}function a(t){l(i,r,o,s,a,"throw",t)}s(void 0)}))}}function p(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function y(t,e){return y=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},y(t,e)}function d(t,e){if(e&&("object"===f(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function b(t){return b=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},b(t)}var m=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");Object.defineProperty(t,"prototype",{value:Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),writable:!1}),e&&y(t,e)}(a,t);var e,n,o,i,s=(o=a,i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,e=b(o);if(i){var n=b(this).constructor;t=Reflect.construct(e,arguments,n)}else t=e.apply(this,arguments);return d(this,t)});function a(t){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,a),s.call(this,t)}return e=a,(n=[{key:"interact",value:function(t,e){var n=null;switch(this.state){case"intro":this.state="loop",n=new r.aW(this.engine,"dialogue",["Buying eh?!",!1,{autoclose:!0,onClose:function(){return e(!0)}}],this,h(regeneratorRuntime.mark((function t(){var e,n,r,o;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,ethereum.request({method:"eth_requestAccounts"});case 2:e=t.sent[0],n=JSON.stringify({domain:{chainId:1,name:"Pixos",verifyingContract:"0xCcCCccccCCCCcCCCCCCcCcCccCcCCCcCcccccccC",version:"1"},message:{game:"Example",contents:"Quest Item",from:{sprite:"air-knight",wallet:"0xCD2a3d9F938E13CD947Ec05AbC7FE734Df8DD826"},to:{sprite:"avatar",wallet:e}},primaryType:"Item",types:{EIP712Domain:[{name:"name",type:"string"},{name:"version",type:"string"},{name:"chainId",type:"uint256"},{name:"verifyingContract",type:"address"}],Item:[{name:"game",type:"string"},{name:"contents",type:"string"},{name:"from",type:"Person"},{name:"to",type:"Person"}],Person:[{name:"sprite",type:"string"},{name:"wallet",type:"address"}]}}),o=[r=e,n],web3.currentProvider.sendAsync({method:"eth_signTypedData_v4",params:o,from:r},(function(t,e){if(t)return console.dir(t);if(e.error&&alert(e.error.message),e.error)return console.error("ERROR",e);console.log("TYPED SIGNED:"+JSON.stringify(e.result));var o=sigUtil.recoverTypedSignature_v4({data:JSON.parse(n),sig:e.result});ethUtil.toChecksumAddress(o)===ethUtil.toChecksumAddress(r)?alert("Successfully recovered signer as "+r):alert("Failed to verify signer when comparing "+e+" to "+r)}));case 8:case"end":return t.stop()}}),t)}))));break;case"loop":this.state="loop2",n=new r.aW(this.engine,"dialogue",["I heard about a strange legend once.",!1,{autoclose:!0,onClose:function(){return e(!0)}}],this);break;case"loop2":this.state="loop",n=new r.aW(this.engine,"dialogue",["Sorry, I don't remember the story at the moment",!1,{autoclose:!0,onClose:function(){return e(!0)}}],this)}return console.log(n),n&&this.addAction(n),e&&e(!1),n}}])&&p(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),a}(function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");Object.defineProperty(t,"prototype",{value:Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),writable:!1}),e&&a(t,e)}(f,t);var e,n,r,s=(n=f,r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,e=u(n);if(r){var o=u(this).constructor;t=Reflect.construct(e,arguments,o)}else t=e.apply(this,arguments);return c(this,t)});function f(t){var e;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,f),(e=s.call(this,t)).src=i.Z.artResourceUrl("air-knight.gif"),e.portraitSrc=i.Z.artResourceUrl("air_portrait.gif"),e.sheetSize=[128,256],e.tileSize=[24,32],e.drawOffset=new o.OW(-.25,1,.125),e.hotspotOffset=new o.OW(.5,.5,0),e.frames={up:[[0,0],[24,0],[48,0],[24,0]],right:[[0,32],[24,32],[48,32],[24,32]],down:[[0,64],[24,64],[48,64],[24,64]],left:[[0,96],[24,96],[48,96],[24,96]]},e.bindCamera=!1,e.enableSpeech=!0,e.state="intro",e}return e=f,Object.defineProperty(e,"prototype",{writable:!1}),e}(n(7772).Z))},6613:(t,e,n)=>{"use strict";n.r(e),n.d(e,{default:()=>d});var r=n(9337),o=n(8348),i=n(6185);function s(t){return s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},s(t)}function a(t,e){return a=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},a(t,e)}function c(t,e){if(e&&("object"===s(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function u(t){return u=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},u(t)}function f(t){return f="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},f(t)}function l(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function h(t,e){return h=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},h(t,e)}function p(t,e){if(e&&("object"===f(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function y(t){return y=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},y(t)}var d=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");Object.defineProperty(t,"prototype",{value:Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),writable:!1}),e&&h(t,e)}(a,t);var e,n,o,i,s=(o=a,i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,e=y(o);if(i){var n=y(this).constructor;t=Reflect.construct(e,arguments,n)}else t=e.apply(this,arguments);return p(this,t)});function a(t){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,a),s.call(this,t)}return e=a,(n=[{key:"interact",value:function(t,e){var n=null;switch(this.state){case"intro":this.state="loop",n=new r.aW(this.engine,"dialogue",["Join me....!",!1,{autoclose:!0,onClose:function(){return e(!0)}}],this);break;case"loop":this.state="loop2",n=new r.aW(this.engine,"dialogue",["I need a partner for squash.",!1,{autoclose:!0,onClose:function(){return e(!0)}}],this);break;case"loop2":this.state="loop",n=new r.aW(this.engine,"dialogue",["Seriously - you swing?",!1,{autoclose:!0,onClose:function(){return e(!0)}}],this)}return n&&this.addAction(n),e&&e(!1),n}}])&&l(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),a}(function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");Object.defineProperty(t,"prototype",{value:Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),writable:!1}),e&&a(t,e)}(f,t);var e,n,r,s=(n=f,r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,e=u(n);if(r){var o=u(this).constructor;t=Reflect.construct(e,arguments,o)}else t=e.apply(this,arguments);return c(this,t)});function f(t){var e;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,f),(e=s.call(this,t)).src=i.Z.artResourceUrl("darkness.gif"),e.portraitSrc=i.Z.artResourceUrl("dark_portrait.gif"),e.sheetSize=[128,256],e.tileSize=[24,32],e.drawOffset=new o.OW(-.25,1,.125),e.hotspotOffset=new o.OW(.5,.5,0),e.frames={up:[[0,0],[24,0],[48,0],[24,0]],right:[[0,32],[24,32],[48,32],[24,32]],down:[[0,64],[24,64],[48,64],[24,64]],left:[[0,96],[24,96],[48,96],[24,96]]},e.bindCamera=!1,e.enableSpeech=!0,e.state="intro",e}return e=f,Object.defineProperty(e,"prototype",{writable:!1}),e}(n(7772).Z))},5532:(t,e,n)=>{"use strict";n.r(e),n.d(e,{default:()=>d});var r=n(9337),o=n(8348),i=n(6185);function s(t){return s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},s(t)}function a(t,e){return a=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},a(t,e)}function c(t,e){if(e&&("object"===s(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function u(t){return u=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},u(t)}function f(t){return f="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},f(t)}function l(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function h(t,e){return h=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},h(t,e)}function p(t,e){if(e&&("object"===f(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function y(t){return y=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},y(t)}var d=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");Object.defineProperty(t,"prototype",{value:Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),writable:!1}),e&&h(t,e)}(a,t);var e,n,o,i,s=(o=a,i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,e=y(o);if(i){var n=y(this).constructor;t=Reflect.construct(e,arguments,n)}else t=e.apply(this,arguments);return p(this,t)});function a(t){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,a),s.call(this,t)}return e=a,(n=[{key:"interact",value:function(t,e){var n=null;switch(this.state){case"intro":this.state="loop",n=new r.aW(this.engine,"dialogue",["Welcome!",!1,{autoclose:!0,onClose:function(){return e(!0)}}],this);break;case"loop":this.state="loop2",n=new r.aW(this.engine,"dialogue",["I heard about a strange legend once.",!1,{autoclose:!0,onClose:function(){return e(!0)}}],this);break;case"loop2":this.state="loop",n=new r.aW(this.engine,"dialogue",["Sorry, I don't remember the story at the moment",!1,{autoclose:!0,onClose:function(){return e(!0)}}],this)}return console.log(n),n&&this.addAction(n),e&&e(!1),n}}])&&l(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),a}(function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");Object.defineProperty(t,"prototype",{value:Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),writable:!1}),e&&a(t,e)}(f,t);var e,n,r,s=(n=f,r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,e=u(n);if(r){var o=u(this).constructor;t=Reflect.construct(e,arguments,o)}else t=e.apply(this,arguments);return c(this,t)});function f(t){var e;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,f),(e=s.call(this,t)).src=i.Z.artResourceUrl("earth-knight.gif"),e.portraitSrc=i.Z.artResourceUrl("earth_portrait.gif"),e.sheetSize=[128,256],e.tileSize=[24,32],e.drawOffset=new o.OW(-.25,1,.125),e.hotspotOffset=new o.OW(.5,.5,0),e.frames={up:[[0,0],[24,0],[48,0],[24,0]],right:[[0,32],[24,32],[48,32],[24,32]],down:[[0,64],[24,64],[48,64],[24,64]],left:[[0,96],[24,96],[48,96],[24,96]]},e.bindCamera=!1,e.enableSpeech=!0,e.state="intro",e}return e=f,Object.defineProperty(e,"prototype",{writable:!1}),e}(n(7772).Z))},4267:(t,e,n)=>{"use strict";n.r(e),n.d(e,{default:()=>d});var r=n(9337),o=n(8348),i=n(6185);function s(t){return s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},s(t)}function a(t,e){return a=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},a(t,e)}function c(t,e){if(e&&("object"===s(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function u(t){return u=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},u(t)}function f(t){return f="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},f(t)}function l(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function h(t,e){return h=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},h(t,e)}function p(t,e){if(e&&("object"===f(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function y(t){return y=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},y(t)}var d=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");Object.defineProperty(t,"prototype",{value:Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),writable:!1}),e&&h(t,e)}(a,t);var e,n,o,i,s=(o=a,i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,e=y(o);if(i){var n=y(this).constructor;t=Reflect.construct(e,arguments,n)}else t=e.apply(this,arguments);return p(this,t)});function a(t){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,a),s.call(this,t)}return e=a,(n=[{key:"interact",value:function(t,e){var n=null;switch(this.state){case"intro":this.state="loop",n=new r.aW(this.engine,"dialogue",["Welcome!",!1,{autoclose:!0,onClose:function(){return e(!0)}}],this);break;case"loop":this.state="loop2",n=new r.aW(this.engine,"dialogue",["I heard about a strange legend once.",!1,{autoclose:!0,onClose:function(){return e(!0)}}],this);break;case"loop2":this.state="loop",n=new r.aW(this.engine,"dialogue",["Sorry, I don't remember the story at the moment",!1,{autoclose:!0,onClose:function(){return e(!0)}}],this)}return console.log(n),n&&this.addAction(n),e&&e(!1),n}}])&&l(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),a}(function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");Object.defineProperty(t,"prototype",{value:Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),writable:!1}),e&&a(t,e)}(f,t);var e,n,r,s=(n=f,r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,e=u(n);if(r){var o=u(this).constructor;t=Reflect.construct(e,arguments,o)}else t=e.apply(this,arguments);return c(this,t)});function f(t){var e;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,f),(e=s.call(this,t)).src=i.Z.artResourceUrl("fire-knight.gif"),e.portraitSrc=i.Z.artResourceUrl("fire_portrait.gif"),e.sheetSize=[128,256],e.tileSize=[24,32],e.drawOffset=new o.OW(-.25,1,.125),e.hotspotOffset=new o.OW(.5,.5,0),e.frames={up:[[0,0],[24,0],[48,0],[24,0]],right:[[0,32],[24,32],[48,32],[24,32]],down:[[0,64],[24,64],[48,64],[24,64]],left:[[0,96],[24,96],[48,96],[24,96]]},e.bindCamera=!1,e.enableSpeech=!0,e.state="intro",e}return e=f,Object.defineProperty(e,"prototype",{writable:!1}),e}(n(7772).Z))},3886:(t,e,n)=>{"use strict";n.r(e),n.d(e,{default:()=>d});var r=n(9337),o=n(8348),i=n(6185);function s(t){return s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},s(t)}function a(t,e){return a=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},a(t,e)}function c(t,e){if(e&&("object"===s(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function u(t){return u=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},u(t)}function f(t){return f="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},f(t)}function l(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function h(t,e){return h=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},h(t,e)}function p(t,e){if(e&&("object"===f(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function y(t){return y=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},y(t)}var d=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");Object.defineProperty(t,"prototype",{value:Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),writable:!1}),e&&h(t,e)}(a,t);var e,n,o,i,s=(o=a,i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,e=y(o);if(i){var n=y(this).constructor;t=Reflect.construct(e,arguments,n)}else t=e.apply(this,arguments);return p(this,t)});function a(t){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,a),s.call(this,t)}return e=a,(n=[{key:"interact",value:function(t,e){var n=null;switch(this.state){case"intro":this.state="loop",n=new r.aW(this.engine,"dialogue",[["I am the Water Knight!","Here is my home.","yo"],!1,{autoclose:!1,onClose:function(){return e(!0)}}],this);break;case"loop":this.state="loop2",n=new r.aW(this.engine,"dialogue",["I heard about a strange legend once.",!1,{autoclose:!0,onClose:function(){return e(!0)}}],this);break;case"loop2":this.state="loop",n=new r.aW(this.engine,"dialogue",["Sorry, I don't remember the story at the moment",!1,{autoclose:!0,onClose:function(){return e(!0)}}],this)}return n&&this.addAction(n),e&&e(!1),n}}])&&l(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),a}(function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");Object.defineProperty(t,"prototype",{value:Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),writable:!1}),e&&a(t,e)}(f,t);var e,n,r,s=(n=f,r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,e=u(n);if(r){var o=u(this).constructor;t=Reflect.construct(e,arguments,o)}else t=e.apply(this,arguments);return c(this,t)});function f(t){var e;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,f),(e=s.call(this,t)).src=i.Z.artResourceUrl("water-knight.gif"),e.portraitSrc=i.Z.artResourceUrl("water_portrait.gif"),e.sheetSize=[128,256],e.tileSize=[24,32],e.drawOffset=new o.OW(-.25,1,.125),e.hotspotOffset=new o.OW(.5,.5,0),e.frames={up:[[0,0],[24,0],[48,0],[24,0]],right:[[0,32],[24,32],[48,32],[24,32]],down:[[0,64],[24,64],[48,64],[24,64]],left:[[0,96],[24,96],[48,96],[24,96]]},e.bindCamera=!1,e.enableSpeech=!0,e.state="intro",e}return e=f,Object.defineProperty(e,"prototype",{writable:!1}),e}(n(7772).Z))},4247:(t,e,n)=>{"use strict";n.r(e),n.d(e,{default:()=>p}),n(9337);var r=n(8348),o=n(6185);function i(t){return i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},i(t)}function s(t,e){return s=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},s(t,e)}function a(t,e){if(e&&("object"===i(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function c(t){return c=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},c(t)}function u(t){return u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},u(t)}function f(t,e){return f=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},f(t,e)}function l(t,e){if(e&&("object"===u(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function h(t){return h=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},h(t)}var p=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");Object.defineProperty(t,"prototype",{value:Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),writable:!1}),e&&f(t,e)}(i,t);var e,n,r,o=(n=i,r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,e=h(n);if(r){var o=h(this).constructor;t=Reflect.construct(e,arguments,o)}else t=e.apply(this,arguments);return l(this,t)});function i(t){var e;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,i),(e=o.call(this,t)).enableSpeech=!1,e.inventory=[],e}return e=i,Object.defineProperty(e,"prototype",{writable:!1}),e}(function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");Object.defineProperty(t,"prototype",{value:Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),writable:!1}),e&&s(t,e)}(f,t);var e,n,i,u=(n=f,i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,e=c(n);if(i){var r=c(this).constructor;t=Reflect.construct(e,arguments,r)}else t=e.apply(this,arguments);return a(this,t)});function f(t){var e;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,f),(e=u.call(this,t)).src=o.Z.artResourceUrl("chests.gif"),e.sheetSize=[256,256],e.tileSize=[16,24],e.drawOffset=new r.OW(0,1,.2),e.hotspotOffset=new r.OW(.5,.5,0),e.frames={down:[[48,0],[48,24],[48,48],[48,72]],right:[[112,0],[112,24],[112,48],[112,72]],up:[[48,96],[48,120],[48,144],[48,168]],left:[[176,0],[176,24],[176,48],[176,72]]},e.bindCamera=!1,e.enableSpeech=!0,e.state="closed",e.inventory=[],e}return e=f,Object.defineProperty(e,"prototype",{writable:!1}),e}(n(6595).Z))},2188:(t,e,n)=>{"use strict";n.r(e),n.d(e,{default:()=>p}),n(9337);var r=n(8348),o=n(6185);function i(t){return i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},i(t)}function s(t,e){return s=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},s(t,e)}function a(t,e){if(e&&("object"===i(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function c(t){return c=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},c(t)}function u(t){return u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},u(t)}function f(t,e){return f=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},f(t,e)}function l(t,e){if(e&&("object"===u(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function h(t){return h=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},h(t)}var p=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");Object.defineProperty(t,"prototype",{value:Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),writable:!1}),e&&f(t,e)}(i,t);var e,n,r,o=(n=i,r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,e=h(n);if(r){var o=h(this).constructor;t=Reflect.construct(e,arguments,o)}else t=e.apply(this,arguments);return l(this,t)});function i(t){var e;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,i),(e=o.call(this,t)).enableSpeech=!1,e.inventory=[],e}return e=i,Object.defineProperty(e,"prototype",{writable:!1}),e}(function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");Object.defineProperty(t,"prototype",{value:Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),writable:!1}),e&&s(t,e)}(f,t);var e,n,i,u=(n=f,i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,e=c(n);if(i){var r=c(this).constructor;t=Reflect.construct(e,arguments,r)}else t=e.apply(this,arguments);return a(this,t)});function f(t){var e;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,f),(e=u.call(this,t)).src=o.Z.artResourceUrl("chests.gif"),e.sheetSize=[256,256],e.tileSize=[16,24],e.drawOffset=new r.OW(0,1,.2),e.hotspotOffset=new r.OW(.5,.5,0),e.frames={down:[[16,0],[16,24],[16,48],[16,72]],right:[[80,0],[80,24],[80,48],[80,72]],up:[[16,96],[16,120],[16,144],[16,168]],left:[[144,0],[144,24],[144,48],[144,72]]},e.bindCamera=!1,e.enableSpeech=!0,e.state="closed",e.inventory=[],e}return e=f,Object.defineProperty(e,"prototype",{writable:!1}),e}(n(6595).Z))},3991:(t,e,n)=>{"use strict";n.r(e),n.d(e,{default:()=>p}),n(9337);var r=n(8348),o=n(6185);function i(t){return i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},i(t)}function s(t,e){return s=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},s(t,e)}function a(t,e){if(e&&("object"===i(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function c(t){return c=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},c(t)}function u(t){return u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},u(t)}function f(t,e){return f=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},f(t,e)}function l(t,e){if(e&&("object"===u(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function h(t){return h=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},h(t)}var p=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");Object.defineProperty(t,"prototype",{value:Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),writable:!1}),e&&f(t,e)}(i,t);var e,n,r,o=(n=i,r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,e=h(n);if(r){var o=h(this).constructor;t=Reflect.construct(e,arguments,o)}else t=e.apply(this,arguments);return l(this,t)});function i(t){var e;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,i),(e=o.call(this,t)).enableSpeech=!1,e.inventory=[],e}return e=i,Object.defineProperty(e,"prototype",{writable:!1}),e}(function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");Object.defineProperty(t,"prototype",{value:Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),writable:!1}),e&&s(t,e)}(f,t);var e,n,i,u=(n=f,i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,e=c(n);if(i){var r=c(this).constructor;t=Reflect.construct(e,arguments,r)}else t=e.apply(this,arguments);return a(this,t)});function f(t){var e;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,f),(e=u.call(this,t)).src=o.Z.artResourceUrl("chests.gif"),e.sheetSize=[256,256],e.tileSize=[16,24],e.drawOffset=new r.OW(0,1,.2),e.hotspotOffset=new r.OW(.5,.5,0),e.frames={down:[[32,0],[32,24],[32,48],[32,72]],right:[[96,0],[96,24],[96,48],[96,72]],up:[[32,96],[32,120],[32,144],[32,168]],left:[[160,0],[160,24],[160,48],[160,72]]},e.bindCamera=!1,e.enableSpeech=!0,e.state="closed",e.inventory=[],e}return e=f,Object.defineProperty(e,"prototype",{writable:!1}),e}(n(6595).Z))},4475:(t,e,n)=>{"use strict";n.r(e),n.d(e,{default:()=>p}),n(9337);var r=n(8348),o=n(6185);function i(t){return i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},i(t)}function s(t,e){return s=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},s(t,e)}function a(t,e){if(e&&("object"===i(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function c(t){return c=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},c(t)}function u(t){return u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},u(t)}function f(t,e){return f=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},f(t,e)}function l(t,e){if(e&&("object"===u(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function h(t){return h=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},h(t)}var p=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");Object.defineProperty(t,"prototype",{value:Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),writable:!1}),e&&f(t,e)}(i,t);var e,n,r,o=(n=i,r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,e=h(n);if(r){var o=h(this).constructor;t=Reflect.construct(e,arguments,o)}else t=e.apply(this,arguments);return l(this,t)});function i(t){var e;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,i),(e=o.call(this,t)).enableSpeech=!1,e.inventory=[{id:"sword",type:"object"}],e}return e=i,Object.defineProperty(e,"prototype",{writable:!1}),e}(function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");Object.defineProperty(t,"prototype",{value:Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),writable:!1}),e&&s(t,e)}(f,t);var e,n,i,u=(n=f,i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,e=c(n);if(i){var r=c(this).constructor;t=Reflect.construct(e,arguments,r)}else t=e.apply(this,arguments);return a(this,t)});function f(t){var e;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,f),(e=u.call(this,t)).src=o.Z.artResourceUrl("chests.gif"),e.sheetSize=[256,256],e.tileSize=[16,24],e.drawOffset=new r.OW(0,1,.2),e.hotspotOffset=new r.OW(.5,.5,0),e.frames={down:[[0,0],[0,24],[0,48],[0,72]],right:[[64,0],[64,24],[64,48],[64,72]],up:[[0,96],[0,120],[0,144],[0,168]],left:[[128,0],[128,24],[128,48],[128,72]]},e.bindCamera=!1,e.enableSpeech=!0,e.state="closed",e.inventory=[],e}return e=f,Object.defineProperty(e,"prototype",{writable:!1}),e}(n(6595).Z))},1262:(t,e,n)=>{"use strict";n.d(e,{Z:()=>r});const r={FLOOR:["FLAT_ALL","FLOOR",0],WATER:["FLAT_NONE","WATER",-1.5],EMPTY:["FLAT_ALL","EMPTY",2],N_STAIR:["FLAT_ALL","FLOOR_V",-1,"WALL_R","WATER_WALL",-1,"WALL_L","WATER_WALL",-1,"STAIR_T","STAIR",-1],N_STAIRWALL:["FLAT_ALL","FLOOR_B",0,"WALL_T","WALL_WATER",0,15],S_STAIR:["FLAT_ALL","FLOOR_V",-1,"WALL_R","WATER_WALL",-1,"WALL_L","WATER_WALL",-1,"STAIR_B","STAIR",-1],S_STAIRWALL:["FLAT_ALL","FLOOR_T",0,"WALL_B","WALL",0,15],L_STAIR:["FLAT_ALL","FLOOR_H",-1,"WALL_T","WATER_WALL",-1,"WALL_B","WATER_WALL",-1,"STAIR_L","STAIR",-1],L_STAIRWALL:["FLAT_ALL","FLOOR_R",0,"WALL_L","WALL_WATER",0,15],R_STAIR:["FLAT_ALL","FLOOR_H",-1,"WALL_T","WATER_WALL",-1,"WALL_B","WATER_WALL",-1,"STAIR_R","STAIR",-1],R_STAIRWALL:["FLAT_ALL","FLOOR_L",0,"WALL_R","WALL_WATER",0,15],N_WALL:["WALL_T","WALL",2,"FLAT_ALL","EMPTY_B",2],S_WALL:["WALL_B","WALL",2,"FLAT_ALL","EMPTY_T",2],L_WALL:["WALL_L","WALL",2,"FLAT_ALL","EMPTY_R",2],R_WALL:["WALL_R","WALL",2,"FLAT_ALL","EMPTY_L",2],NLW_CORNER:["FLAT_ALL","EMPTY_CTL",2],NRW_CORNER:["FLAT_ALL","EMPTY_CTR",2],SLW_CORNER:["FLAT_ALL","EMPTY_CBL",2],SRW_CORNER:["FLAT_ALL","EMPTY_CBR",2],NLW_COLUMN:["WALL_T","WALL",2,"WALL_L","WALL",2,"FLAT_NONE","EMPTY_BR",2],NRW_COLUMN:["WALL_R","WALL",2,"WALL_T","WALL",2,"FLAT_NONE","EMPTY_BL",2],SLW_COLUMN:["WALL_L","WALL",2,"WALL_B","WALL",2,"FLAT_NONE","EMPTY_TR",2],SRW_COLUMN:["WALL_R","WALL",2,"WALL_B","WALL",2,"FLAT_NONE","EMPTY_TL",2],NRW_WATER_COLUMN:["WALL_R","WALL",2,"WALL_R","WALL_WATER",0,"WALL_T","WALL",2,"WALL_T","WALL_WATER",0,"FLAT_ALL","EMPTY_BL",2],NLW_WATER_COLUMN:["WALL_T","WALL",2,"WALL_L","WALL",2,"FLAT_ALL","EMPTY_BR",2,"WALL_L","WALL_WATER",0,"WALL_T","WALL_WATER",0],SLW_WATER_COLUMN:["WALL_L","WALL",2,"WALL_B","WALL",2,"FLAT_ALL","EMPTY_TR",2,"WALL_L","WALL_WATER",0,"WALL_B","WALL_WATER",0],SRW_WATER_COLUMN:["WALL_R","WALL",2,"WALL_R","WALL_WATER",0,"WALL_B","WALL",2,"WALL_B","WALL_WATER",0,"FLAT_ALL","EMPTY_TL",2],NW_NPIT:["FLAT_ALL","FLOOR_B",0,"WALL_T","WALL_WATER",0],LW_LPIT:["FLAT_ALL","FLOOR_R",0,"WALL_L","WALL_WATER",0],RW_RPIT:["FLAT_ALL","FLOOR_L",0,"WALL_R","WALL_WATER",0],SW_SPIT:["FLAT_ALL","FLOOR_T",0,"WALL_B","WALL_WATER",0],C_WALKWAY:["FLAT_ALL","FLOOR_C",-1],V_WALKWAY:["FLAT_ALL","FLOOR_V",-1,"WALL_R","WATER_WALL",-1,"WALL_L","WATER_WALL",-1],H_WALKWAY:["FLAT_ALL","FLOOR_H",-1,"WALL_T","WATER_WALL",-1,"WALL_B","WATER_WALL",-1]}},3507:(t,e,n)=>{"use strict";n.r(e),n.d(e,{default:()=>r});const r={src:n(6185).Z.artResourceUrl("sewer.gif"),sheetSize:[256,256],tileSize:16,bgColor:[31,20,29],textures:{FLOOR:[1,1],FLOOR_BR:[2,2],FLOOR_R:[2,1],FLOOR_TR:[2,0],FLOOR_T:[1,0],FLOOR_TL:[0,0],FLOOR_L:[0,1],FLOOR_BL:[0,2],FLOOR_B:[1,2],FLOOR_CBR:[4,1],FLOOR_CTR:[4,0],FLOOR_CTL:[3,0],FLOOR_CBL:[3,1],FLOOR_V:[3,2],WATER:[.5,7.5],FLOOR_H:[4,2],FLOOR_C:[3,3],EMPTY:[6,1],EMPTY_BR:[7,2],EMPTY_R:[7,1],EMPTY_TR:[7,0],EMPTY_T:[6,0],EMPTY_TL:[5,0],EMPTY_L:[5,1],EMPTY_BL:[5,2],EMPTY_B:[6,2],EMPTY_CBR:[9,1],EMPTY_CTR:[9,0],EMPTY_CTL:[8,0],EMPTY_CBL:[8,1],STAIR:[5,3],WALL:[0,3],WALL_WATER:[0,5],WATER_WALL:[0,6]},geometry:{FLAT_ALL:{vertices:[[[0,1,0],[1,1,0],[1,0,0]],[[0,1,0],[1,0,0],[0,0,0]]],surfaces:[[[0,1],[1,1],[1,0]],[[0,1],[1,0],[0,0]]],type:parseInt("1111",2)},FLAT_NONE:{vertices:[[[0,1,0],[1,1,0],[1,0,0]],[[0,1,0],[1,0,0],[0,0,0]]],surfaces:[[[0,1],[1,1],[1,0]],[[0,1],[1,0],[0,0]]],type:parseInt("0000",2)},STAIR_R:{vertices:[[[.25,0,.25],[.25,1,.25],[.5,1,.25]],[[.25,0,.25],[.5,1,.25],[.5,0,.25]],[[.5,0,.5],[.5,1,.5],[.75,1,.5]],[[.5,0,.5],[.75,1,.5],[.75,0,.5]],[[.75,0,.75],[.75,1,.75],[1,1,.75]],[[.75,0,.75],[1,1,.75],[1,0,.75]],[[.25,0,0],[.25,1,0],[.25,1,.25]],[[.25,0,0],[.25,1,.25],[.25,0,.25]],[[.5,0,.25],[.5,1,.25],[.5,1,.5]],[[.5,0,.25],[.5,1,.5],[.5,0,.5]],[[.75,0,.5],[.75,1,.5],[.75,1,.75]],[[.75,0,.5],[.75,1,.75],[.75,0,.75]],[[1,0,.75],[1,1,.75],[1,1,1]],[[1,0,.75],[1,1,1],[1,0,1]],[[0,0,0],[1,0,0],[1,0,1]],[[0,0,0],[1,0,1],[0,0,1]],[[0,1,0],[1,1,0],[1,1,1]],[[0,1,0],[1,1,1],[0,1,1]]],surfaces:[[[0,.75],[1,.75],[1,.5]],[[0,.75],[1,.5],[0,.5]],[[0,.5],[1,.5],[1,.25]],[[0,.5],[1,.25],[0,.25]],[[0,.25],[1,.25],[1,0]],[[0,.25],[1,0],[0,0]],[[0,2],[1,2],[1,1.75]],[[0,2],[1,1.75],[0,1.75]],[[0,1.75],[1,1.75],[1,1.5]],[[0,1.75],[1,1.5],[0,1.5]],[[0,1.5],[1,1.5],[1,1.25]],[[0,1.5],[1,1.25],[0,1.25]],[[0,1.25],[1,1.25],[1,1]],[[0,1.25],[1,1],[0,1]],[[0,3],[1,3],[1,2]],[[0,3],[1,2],[0,2]],[[0,3],[1,3],[1,2]],[[0,3],[1,2],[0,2]]],walkPoly:[[[0,1,0],[1,1,1],[1,0,1]],[[0,1,0],[1,0,1],[0,0,0]]],type:parseInt("0101",2)},STAIR_T:{vertices:[[[0,.75,.25],[1,.75,.25],[1,.5,.25]],[[0,.75,.25],[1,.5,.25],[0,.5,.25]],[[0,.5,.5],[1,.5,.5],[1,.25,.5]],[[0,.5,.5],[1,.25,.5],[0,.25,.5]],[[0,.25,.75],[1,.25,.75],[1,0,.75]],[[0,.25,.75],[1,0,.75],[0,0,.75]],[[0,.75,0],[1,.75,0],[1,.75,.25]],[[0,.75,0],[1,.75,.25],[0,.75,.25]],[[0,.5,.25],[1,.5,.25],[1,.5,.5]],[[0,.5,.25],[1,.5,.5],[0,.5,.5]],[[0,.25,.5],[1,.25,.5],[1,.25,.75]],[[0,.25,.5],[1,.25,.75],[0,.25,.75]],[[0,0,.75],[1,0,.75],[1,0,1]],[[0,0,.75],[1,0,1],[0,0,1]],[[0,1,0],[0,0,0],[0,0,1]],[[0,1,0],[0,0,1],[0,1,1]],[[1,1,0],[1,0,0],[1,0,1]],[[1,1,0],[1,0,1],[1,1,1]]],surfaces:[[[0,.75],[1,.75],[1,.5]],[[0,.75],[1,.5],[0,.5]],[[0,.5],[1,.5],[1,.25]],[[0,.5],[1,.25],[0,.25]],[[0,.25],[1,.25],[1,0]],[[0,.25],[1,0],[0,0]],[[0,2],[1,2],[1,1.75]],[[0,2],[1,1.75],[0,1.75]],[[0,1.75],[1,1.75],[1,1.5]],[[0,1.75],[1,1.5],[0,1.5]],[[0,1.5],[1,1.5],[1,1.25]],[[0,1.5],[1,1.25],[0,1.25]],[[0,1.25],[1,1.25],[1,1]],[[0,1.25],[1,1],[0,1]],[[0,3],[1,3],[1,2]],[[0,3],[1,2],[0,2]],[[0,3],[1,3],[1,2]],[[0,3],[1,2],[0,2]]],walkPoly:[[[0,1,0],[1,1,0],[1,0,1]],[[0,1,0],[1,0,1],[0,0,1]]],type:parseInt("1010",2)},STAIR_L:{vertices:[[[.75,1,.25],[.75,0,.25],[.5,0,.25]],[[.75,1,.25],[.5,0,.25],[.5,1,.25]],[[.5,1,.5],[.5,0,.5],[.25,0,.5]],[[.5,1,.5],[.25,0,.5],[.25,1,.5]],[[.25,1,.75],[.25,0,.75],[0,0,.75]],[[.25,1,.75],[0,0,.75],[0,1,.75]],[[.75,1,0],[.75,0,0],[.75,0,.25]],[[.75,1,0],[.75,0,.25],[.75,1,.25]],[[.5,1,.25],[.5,0,.25],[.5,0,.5]],[[.5,1,.25],[.5,0,.5],[.5,1,.5]],[[.25,1,.5],[.25,0,.5],[.25,0,.75]],[[.25,1,.5],[.25,0,.75],[.25,1,.75]],[[0,1,.75],[0,0,.75],[0,0,1]],[[0,1,.75],[0,0,1],[0,1,1]],[[1,1,0],[0,1,0],[0,1,1]],[[1,1,0],[0,1,1],[1,1,1]],[[1,0,0],[0,0,0],[0,0,1]],[[1,0,0],[0,0,1],[1,0,1]]],surfaces:[[[0,.75],[1,.75],[1,.5]],[[0,.75],[1,.5],[0,.5]],[[0,.5],[1,.5],[1,.25]],[[0,.5],[1,.25],[0,.25]],[[0,.25],[1,.25],[1,0]],[[0,.25],[1,0],[0,0]],[[0,2],[1,2],[1,1.75]],[[0,2],[1,1.75],[0,1.75]],[[0,1.75],[1,1.75],[1,1.5]],[[0,1.75],[1,1.5],[0,1.5]],[[0,1.5],[1,1.5],[1,1.25]],[[0,1.5],[1,1.25],[0,1.25]],[[0,1.25],[1,1.25],[1,1]],[[0,1.25],[1,1],[0,1]],[[0,3],[1,3],[1,2]],[[0,3],[1,2],[0,2]],[[0,3],[1,3],[1,2]],[[0,3],[1,2],[0,2]]],walkPoly:[[[0,1,1],[1,1,0],[1,0,0]],[[0,1,1],[1,0,0],[0,0,1]]],type:parseInt("0101",2)},STAIR_B:{vertices:[[[1,.25,.25],[0,.25,.25],[0,.5,.25]],[[1,.25,.25],[0,.5,.25],[1,.5,.25]],[[1,.5,.5],[0,.5,.5],[0,.75,.5]],[[1,.5,.5],[0,.75,.5],[1,.75,.5]],[[1,.75,.75],[0,.75,.75],[0,1,.75]],[[1,.75,.75],[0,1,.75],[1,1,.75]],[[1,.25,0],[0,.25,0],[0,.25,.25]],[[1,.25,0],[0,.25,.25],[1,.25,.25]],[[1,.5,.25],[0,.5,.25],[0,.5,.5]],[[1,.5,.25],[0,.5,.5],[1,.5,.5]],[[1,.75,.5],[0,.75,.5],[0,.75,.75]],[[1,.75,.5],[0,.75,.75],[1,.75,.75]],[[1,1,.75],[0,1,.75],[0,1,1]],[[1,1,.75],[0,1,1],[1,1,1]],[[1,0,0],[1,1,0],[1,1,1]],[[1,0,0],[1,1,1],[1,0,1]],[[0,0,0],[0,1,0],[0,1,1]],[[0,0,0],[0,1,1],[0,0,1]]],surfaces:[[[0,.75],[1,.75],[1,.5]],[[0,.75],[1,.5],[0,.5]],[[0,.5],[1,.5],[1,.25]],[[0,.5],[1,.25],[0,.25]],[[0,.25],[1,.25],[1,0]],[[0,.25],[1,0],[0,0]],[[0,2],[1,2],[1,1.75]],[[0,2],[1,1.75],[0,1.75]],[[0,1.75],[1,1.75],[1,1.5]],[[0,1.75],[1,1.5],[0,1.5]],[[0,1.5],[1,1.5],[1,1.25]],[[0,1.5],[1,1.25],[0,1.25]],[[0,1.25],[1,1.25],[1,1]],[[0,1.25],[1,1],[0,1]],[[0,3],[1,3],[1,2]],[[0,3],[1,2],[0,2]],[[0,3],[1,3],[1,2]],[[0,3],[1,2],[0,2]]],walkPoly:[[[0,1,1],[1,1,1],[1,0,0]],[[0,1,1],[1,0,0],[0,0,0]]],type:parseInt("1010",2)},WALL_R:{vertices:[[[0,0,-2],[0,1,-2],[0,1,0]],[[0,0,-2],[0,1,0],[0,0,0]]],surfaces:[[[0,2],[1,2],[1,0]],[[0,2],[1,0],[0,0]]],type:parseInt("1011",2)},WALL_T:{vertices:[[[0,1,-2],[1,1,-2],[1,1,0]],[[0,1,-2],[1,1,0],[0,1,0]]],surfaces:[[[0,2],[1,2],[1,0]],[[0,2],[1,0],[0,0]]],type:parseInt("0111",2)},WALL_L:{vertices:[[[1,1,-2],[1,0,-2],[1,0,0]],[[1,1,-2],[1,0,0],[1,1,0]]],surfaces:[[[0,2],[1,2],[1,0]],[[0,2],[1,0],[0,0]]],type:parseInt("1110",2)},WALL_B:{vertices:[[[1,0,-2],[0,0,-2],[0,0,0]],[[1,0,-2],[0,0,0],[1,0,0]]],surfaces:[[[0,2],[1,2],[1,0]],[[0,2],[1,0],[0,0]]],type:parseInt("1101",2)}}}},4913:(t,e,n)=>{"use strict";n.d(e,{Z:()=>a});var r=n(7537),o=n.n(r),i=n(3645),s=n.n(i)()(o());s.push([t.id,"/*                                                 *** ----------------------------------------------- **\n**             Calliope - Site Generator   \t       **\n** ----------------------------------------------- **\n**  Copyright (c) 2020-2021 - Kyle Derby MacInnis  **\n**                                                 **\n**    Any unauthorized distribution or transfer    **\n**       of this work is strictly prohibited.      **\n**                                                 **\n**               All Rights Reserved.              **\n** ----------------------------------------------- **\n\\*                                                 */\n.pixos {\n    font-family: Arial, Helvetica, sans-serif;\n    font-size: 16px;\n    width: 100%;\n    text-shadow: #3f3f3f 2px 2px 0px;\n    position: relative;\n    /* padding: 2.5em; */\n    align-items: center;\n    align-content: center; }\n  \n  .renderSurface {\n    height: 100%;\n    left: 0;\n    position: absolute;\n    top: 0;\n    width: 100%; }\n  \n  .materialSelector {\n    background: rgba(0, 0, 0, 0.6);\n    margin: auto;\n    position: relative; }\n    .materialSelector tr {\n      height: 70px; }\n    .materialSelector td {\n      background-position: 0px 0px;\n      cursor: pointer;\n      margin: 0;\n      opacity: 0.3;\n      padding: 0;\n      width: 70px; }\n      .materialSelector td:hover {\n        opacity: 0.8; }\n  \n  .nickname {\n    color: #ffffff;\n    cursor: default;\n    left: 42%;\n    position: absolute;\n    top: 40%;\n    width: 300px; }\n    .nickname input {\n      background: none;\n      border-bottom: 1px solid #888888;\n      border: none;\n      color: white;\n      font-family: Arial, Helvetica, sans-serif;\n      font-size: 24px;\n      outline: none;\n      width: 100%; }\n  \n  .joininfo {\n    color: #ffffff;\n    cursor: default;\n    font-size: 24px;\n    position: absolute;\n    text-align: center;\n    top: 42%;\n    width: 99%; }\n  \n  .chatbox {\n    background: rgba(0, 0, 0, 0.6);\n    bottom: 55px;\n    color: white;\n    cursor: default;\n    height: 195px;\n    left: 20px;\n    overflow: hidden;\n    padding-left: 10px;\n    padding-right: 10px;\n    position: absolute;\n    width: 600px; }\n  \n  .chatbox_text {\n    bottom: 8px;\n    position: absolute;\n    text-shadow: none; }\n  \n  .chatbox_entry {\n    background: rgba(0, 0, 0, 0.6);\n    border: none;\n    bottom: 18px;\n    color: white;\n    font-family: Arial, Helvetica, sans-serif;\n    font-size: 16px;\n    height: 30px;\n    left: 20px;\n    outline: none;\n    padding-bottom: 2px;\n    padding-left: 10px;\n    position: absolute;\n    width: 610px; }\n  ","",{version:3,sources:["webpack://./pixos/less/pixos.css"],names:[],mappings:"AAAA;;;;;;;;;;oDAUoD;AACpD;IACI,yCAAyC;IACzC,eAAe;IACf,WAAW;IACX,gCAAgC;IAChC,kBAAkB;IAClB,oBAAoB;IACpB,mBAAmB;IACnB,qBAAqB,EAAE;;EAEzB;IACE,YAAY;IACZ,OAAO;IACP,kBAAkB;IAClB,MAAM;IACN,WAAW,EAAE;;EAEf;IACE,8BAA8B;IAC9B,YAAY;IACZ,kBAAkB,EAAE;IACpB;MACE,YAAY,EAAE;IAChB;MACE,4BAA4B;MAC5B,eAAe;MACf,SAAS;MACT,YAAY;MACZ,UAAU;MACV,WAAW,EAAE;MACb;QACE,YAAY,EAAE;;EAEpB;IACE,cAAc;IACd,eAAe;IACf,SAAS;IACT,kBAAkB;IAClB,QAAQ;IACR,YAAY,EAAE;IACd;MACE,gBAAgB;MAChB,gCAAgC;MAChC,YAAY;MACZ,YAAY;MACZ,yCAAyC;MACzC,eAAe;MACf,aAAa;MACb,WAAW,EAAE;;EAEjB;IACE,cAAc;IACd,eAAe;IACf,eAAe;IACf,kBAAkB;IAClB,kBAAkB;IAClB,QAAQ;IACR,UAAU,EAAE;;EAEd;IACE,8BAA8B;IAC9B,YAAY;IACZ,YAAY;IACZ,eAAe;IACf,aAAa;IACb,UAAU;IACV,gBAAgB;IAChB,kBAAkB;IAClB,mBAAmB;IACnB,kBAAkB;IAClB,YAAY,EAAE;;EAEhB;IACE,WAAW;IACX,kBAAkB;IAClB,iBAAiB,EAAE;;EAErB;IACE,8BAA8B;IAC9B,YAAY;IACZ,YAAY;IACZ,YAAY;IACZ,yCAAyC;IACzC,eAAe;IACf,YAAY;IACZ,UAAU;IACV,aAAa;IACb,mBAAmB;IACnB,kBAAkB;IAClB,kBAAkB;IAClB,YAAY,EAAE",sourcesContent:["/*                                                 *** ----------------------------------------------- **\n**             Calliope - Site Generator   \t       **\n** ----------------------------------------------- **\n**  Copyright (c) 2020-2021 - Kyle Derby MacInnis  **\n**                                                 **\n**    Any unauthorized distribution or transfer    **\n**       of this work is strictly prohibited.      **\n**                                                 **\n**               All Rights Reserved.              **\n** ----------------------------------------------- **\n\\*                                                 */\n.pixos {\n    font-family: Arial, Helvetica, sans-serif;\n    font-size: 16px;\n    width: 100%;\n    text-shadow: #3f3f3f 2px 2px 0px;\n    position: relative;\n    /* padding: 2.5em; */\n    align-items: center;\n    align-content: center; }\n  \n  .renderSurface {\n    height: 100%;\n    left: 0;\n    position: absolute;\n    top: 0;\n    width: 100%; }\n  \n  .materialSelector {\n    background: rgba(0, 0, 0, 0.6);\n    margin: auto;\n    position: relative; }\n    .materialSelector tr {\n      height: 70px; }\n    .materialSelector td {\n      background-position: 0px 0px;\n      cursor: pointer;\n      margin: 0;\n      opacity: 0.3;\n      padding: 0;\n      width: 70px; }\n      .materialSelector td:hover {\n        opacity: 0.8; }\n  \n  .nickname {\n    color: #ffffff;\n    cursor: default;\n    left: 42%;\n    position: absolute;\n    top: 40%;\n    width: 300px; }\n    .nickname input {\n      background: none;\n      border-bottom: 1px solid #888888;\n      border: none;\n      color: white;\n      font-family: Arial, Helvetica, sans-serif;\n      font-size: 24px;\n      outline: none;\n      width: 100%; }\n  \n  .joininfo {\n    color: #ffffff;\n    cursor: default;\n    font-size: 24px;\n    position: absolute;\n    text-align: center;\n    top: 42%;\n    width: 99%; }\n  \n  .chatbox {\n    background: rgba(0, 0, 0, 0.6);\n    bottom: 55px;\n    color: white;\n    cursor: default;\n    height: 195px;\n    left: 20px;\n    overflow: hidden;\n    padding-left: 10px;\n    padding-right: 10px;\n    position: absolute;\n    width: 600px; }\n  \n  .chatbox_text {\n    bottom: 8px;\n    position: absolute;\n    text-shadow: none; }\n  \n  .chatbox_entry {\n    background: rgba(0, 0, 0, 0.6);\n    border: none;\n    bottom: 18px;\n    color: white;\n    font-family: Arial, Helvetica, sans-serif;\n    font-size: 16px;\n    height: 30px;\n    left: 20px;\n    outline: none;\n    padding-bottom: 2px;\n    padding-left: 10px;\n    position: absolute;\n    width: 610px; }\n  "],sourceRoot:""}]);const a=s},3645:t=>{"use strict";t.exports=function(t){var e=[];return e.toString=function(){return this.map((function(e){var n="",r=void 0!==e[5];return e[4]&&(n+="@supports (".concat(e[4],") {")),e[2]&&(n+="@media ".concat(e[2]," {")),r&&(n+="@layer".concat(e[5].length>0?" ".concat(e[5]):""," {")),n+=t(e),r&&(n+="}"),e[2]&&(n+="}"),e[4]&&(n+="}"),n})).join("")},e.i=function(t,n,r,o,i){"string"==typeof t&&(t=[[null,t,void 0]]);var s={};if(r)for(var a=0;a<this.length;a++){var c=this[a][0];null!=c&&(s[c]=!0)}for(var u=0;u<t.length;u++){var f=[].concat(t[u]);r&&s[f[0]]||(void 0!==i&&(void 0===f[5]||(f[1]="@layer".concat(f[5].length>0?" ".concat(f[5]):""," {").concat(f[1],"}")),f[5]=i),n&&(f[2]?(f[1]="@media ".concat(f[2]," {").concat(f[1],"}"),f[2]=n):f[2]=n),o&&(f[4]?(f[1]="@supports (".concat(f[4],") {").concat(f[1],"}"),f[4]=o):f[4]="".concat(o)),e.push(f))}},e}},7537:t=>{"use strict";t.exports=function(t){var e=t[1],n=t[3];if(!n)return e;if("function"==typeof btoa){var r=btoa(unescape(encodeURIComponent(JSON.stringify(n)))),o="sourceMappingURL=data:application/json;charset=utf-8;base64,".concat(r),i="/*# ".concat(o," */"),s=n.sources.map((function(t){return"/*# sourceURL=".concat(n.sourceRoot||"").concat(t," */")}));return[e].concat(s).concat([i]).join("\n")}return[e].join("\n")}},8679:(t,e,n)=>{"use strict";var r=n(9864),o={childContextTypes:!0,contextType:!0,contextTypes:!0,defaultProps:!0,displayName:!0,getDefaultProps:!0,getDerivedStateFromError:!0,getDerivedStateFromProps:!0,mixins:!0,propTypes:!0,type:!0},i={name:!0,length:!0,prototype:!0,caller:!0,callee:!0,arguments:!0,arity:!0},s={$$typeof:!0,compare:!0,defaultProps:!0,displayName:!0,propTypes:!0,type:!0},a={};function c(t){return r.isMemo(t)?s:a[t.$$typeof]||o}a[r.ForwardRef]={$$typeof:!0,render:!0,defaultProps:!0,displayName:!0,propTypes:!0},a[r.Memo]=s;var u=Object.defineProperty,f=Object.getOwnPropertyNames,l=Object.getOwnPropertySymbols,h=Object.getOwnPropertyDescriptor,p=Object.getPrototypeOf,y=Object.prototype;t.exports=function t(e,n,r){if("string"!=typeof n){if(y){var o=p(n);o&&o!==y&&t(e,o,r)}var s=f(n);l&&(s=s.concat(l(n)));for(var a=c(e),d=c(n),b=0;b<s.length;++b){var m=s[b];if(!(i[m]||r&&r[m]||d&&d[m]||a&&a[m])){var v=h(n,m);try{u(e,m,v)}catch(t){}}}}return e}},2703:(t,e,n)=>{"use strict";var r=n(414);function o(){}function i(){}i.resetWarningCache=o,t.exports=function(){function t(t,e,n,o,i,s){if(s!==r){var a=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw a.name="Invariant Violation",a}}function e(){return t}t.isRequired=t;var n={array:t,bool:t,func:t,number:t,object:t,string:t,symbol:t,any:t,arrayOf:e,element:t,elementType:t,instanceOf:e,node:t,objectOf:e,oneOf:e,oneOfType:e,shape:e,exact:e,checkPropTypes:i,resetWarningCache:o};return n.PropTypes=n,n}},5697:(t,e,n)=>{t.exports=n(2703)()},414:t=>{"use strict";t.exports="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED"},9921:(t,e)=>{"use strict";var n="function"==typeof Symbol&&Symbol.for,r=n?Symbol.for("react.element"):60103,o=n?Symbol.for("react.portal"):60106,i=n?Symbol.for("react.fragment"):60107,s=n?Symbol.for("react.strict_mode"):60108,a=n?Symbol.for("react.profiler"):60114,c=n?Symbol.for("react.provider"):60109,u=n?Symbol.for("react.context"):60110,f=n?Symbol.for("react.async_mode"):60111,l=n?Symbol.for("react.concurrent_mode"):60111,h=n?Symbol.for("react.forward_ref"):60112,p=n?Symbol.for("react.suspense"):60113,y=n?Symbol.for("react.suspense_list"):60120,d=n?Symbol.for("react.memo"):60115,b=n?Symbol.for("react.lazy"):60116,m=n?Symbol.for("react.block"):60121,v=n?Symbol.for("react.fundamental"):60117,g=n?Symbol.for("react.responder"):60118,O=n?Symbol.for("react.scope"):60119;function w(t){if("object"==typeof t&&null!==t){var e=t.$$typeof;switch(e){case r:switch(t=t.type){case f:case l:case i:case a:case s:case p:return t;default:switch(t=t&&t.$$typeof){case u:case h:case b:case d:case c:return t;default:return e}}case o:return e}}}function L(t){return w(t)===l}e.AsyncMode=f,e.ConcurrentMode=l,e.ContextConsumer=u,e.ContextProvider=c,e.Element=r,e.ForwardRef=h,e.Fragment=i,e.Lazy=b,e.Memo=d,e.Portal=o,e.Profiler=a,e.StrictMode=s,e.Suspense=p,e.isAsyncMode=function(t){return L(t)||w(t)===f},e.isConcurrentMode=L,e.isContextConsumer=function(t){return w(t)===u},e.isContextProvider=function(t){return w(t)===c},e.isElement=function(t){return"object"==typeof t&&null!==t&&t.$$typeof===r},e.isForwardRef=function(t){return w(t)===h},e.isFragment=function(t){return w(t)===i},e.isLazy=function(t){return w(t)===b},e.isMemo=function(t){return w(t)===d},e.isPortal=function(t){return w(t)===o},e.isProfiler=function(t){return w(t)===a},e.isStrictMode=function(t){return w(t)===s},e.isSuspense=function(t){return w(t)===p},e.isValidElementType=function(t){return"string"==typeof t||"function"==typeof t||t===i||t===l||t===a||t===s||t===p||t===y||"object"==typeof t&&null!==t&&(t.$$typeof===b||t.$$typeof===d||t.$$typeof===c||t.$$typeof===u||t.$$typeof===h||t.$$typeof===v||t.$$typeof===g||t.$$typeof===O||t.$$typeof===m)},e.typeOf=w},9864:(t,e,n)=>{"use strict";t.exports=n(9921)},6626:(t,e,n)=>{"use strict";n.d(e,{collect:()=>G});const r={currentComponent:null,isBatchUpdating:!1,isInBrowser:"undefined"!=typeof window,listeners:new Map,manualListeners:[],nextVersionMap:new WeakMap,proxyIsMuted:!1,redirectToNext:!0,store:{}},o=Symbol("PATH"),i=Symbol("ORIGINAL"),s="RR_DEBUG",a=t=>!!t&&"object"==typeof t&&t.constructor===Object,c=t=>Array.isArray(t),u=t=>t instanceof Map,f=t=>t instanceof Set,l=t=>a(t)||c(t)||u(t)||f(t),h=t=>t===o||"constructor"===t||"toJSON"===t||"@@toStringTag"===t||t===Symbol.toStringTag,p=t=>"function"==typeof t,y=t=>a(t)?Object.assign({},t):c(t)?t.slice():u(t)?new Map(t):f(t)?new Set(t):t,d=(t,e)=>u(t)?t.get(e):f(t)?e:(c(t),t[e]),b=(t,e,n)=>{if(a(t))t[e]=n;else if(c(t))t[e]=n;else if(u(t))t.set(e,n);else{if(!f(t))throw Error("Unexpected type");t.add(n)}},m=t=>{if(a(t))return Object.keys(t).length;if(c(t))return t.length;if(u(t)||f(t))return t.size;throw Error("Unexpected type")},v=(t,e)=>{const n=[],r=t=>{const o=e(t,n.slice()),i=void 0!==o?o:t,s=(t,e)=>{n.push(t);const o=r(e);n.pop(),b(i,t,o)};if(a(i))Object.entries(i).forEach((([t,e])=>{s(t,e)}));else if(c(i)||u(i))i.forEach(((t,e)=>{s(e,t)}));else if(f(i)){const t=Array.from(i);i.clear(),t.forEach((t=>{s(t,t)}))}return i};return r(t)},g=t=>{r.proxyIsMuted=!0;const e=t();return r.proxyIsMuted=!1,e},O=(t,e)=>t.map((t=>t.toString())).join(e),w=t=>O(t,"."),L=t=>O(t,"~~~"),R=(t,e)=>{const n=t[o]||[];return void 0===e?n:n.concat(e)},T=(t,e)=>w(R(t,e)),A=(t,e)=>{t&&Object.defineProperty(t,o,{value:e,writable:!0})},_=t=>t[o]||[],x="undefined"!=typeof window&&!!window.localStorage,P=(t,e)=>{if(x)try{const n="string"==typeof e?e:JSON.stringify(e);return localStorage.setItem(t,n)}catch(t){return}},E="on",Z="off";let S=(t=>{if(!x)return;const e=localStorage.getItem("RR_DEBUG");if(!e)return e;try{return JSON.parse(e)}catch(t){return e}})()||Z;S===E&&console.info("Recollect debugging is enabled. Type __RR__.debugOff() to turn it off.");const k=t=>{S===E&&t()},W=(t,e,n)=>{k((()=>{console.groupCollapsed(`GET: ${T(t,e)}`),console.info(`Component: <${r.currentComponent._name}>`),void 0!==n&&console.info("Value:",n),console.groupEnd()}))},j=(t,e,n)=>{k((()=>{console.groupCollapsed(`SET: ${T(t,e)}`),console.info("From:",d(t,e)),console.info("To:  ",n),console.groupEnd()}))},M={},C=t=>M.UpdateNextStore(t),F=t=>{if(!r.currentComponent)return;const e=L(t),n=r.listeners.get(e)||new Set;n.add(r.currentComponent),r.listeners.set(e,n)},I=t=>{return new Proxy(t,u(e=t)||f(e)?{get(t,e){if(e===i)return t;let n=Reflect.get(t,e);if(p(n)&&(n=n.bind(t)),r.proxyIsMuted||h(e))return n;if(!r.currentComponent&&r.redirectToNext){const n=r.nextVersionMap.get(t);if(n)return Reflect.get(n,e)}return"set"===e?new Proxy(n,{apply:(n,r,[o,i])=>r.get(o)===i||C({target:r,prop:o,value:i,updater:(n,r)=>(j(t,e,r),Reflect.apply(n[e],n,[o,r]))})}):"add"===e?new Proxy(n,{apply:(n,r,[o])=>!!r.has(o)||C({target:r,notifyTarget:!0,value:o,updater:(n,r)=>(j(t,e,r),Reflect.apply(n[e],n,[r]))})}):"clear"===e||"delete"===e?new Proxy(n,{apply:(n,r,[o])=>!(!r.size||"delete"===e&&!r.has(o))&&C({target:r,notifyTarget:!0,updater:n=>(j(t,e),Reflect.apply(n[e],n,[o]))})}):r.currentComponent&&u(t)&&"get"===e?new Proxy(n,{apply:(e,n,r)=>(F(R(t,r[0])),Reflect.apply(e,n,r))}):n}}:{get(t,e){if(e===i)return t;const n=Reflect.get(t,e);if(r.proxyIsMuted||h(e))return n;if(((t,e)=>c(t)&&["copyWithin","fill","pop","push","reverse","shift","sort","splice","unshift"].includes(e))(t,e))return new Proxy(n,{apply:(n,r,o)=>C({target:r,notifyTarget:!0,value:o,updater:(n,r)=>{j(t,e,r);const o=Reflect.apply(n[e],n,r),i=_(t);return v(n,((t,e)=>{l(t)&&A(t,[...i,...e])})),o}})});if(p(t[e]))return n;if(r.currentComponent)c(t)&&"length"===e||(W(t,e,n),F(R(t,e)));else if(r.redirectToNext){const n=r.nextVersionMap.get(t);if(n)return Reflect.get(n,e)}return n},has(t,e){const n=Reflect.has(t,e);if(r.proxyIsMuted||h(e))return n;if(r.currentComponent)c(t)||(W(t,e),F(R(t,e)));else{const n=r.nextVersionMap.get(t);if(n)return Reflect.has(n,e)}return n},ownKeys(t){const e=Reflect.ownKeys(t);if(r.proxyIsMuted)return e;if(r.currentComponent)W(t),F(_(t));else{const e=r.nextVersionMap.get(t);if(e)return Reflect.ownKeys(e)}return e},set:(t,e,n)=>r.proxyIsMuted?Reflect.set(t,e,n):t[e]===n||C({target:t,prop:e,value:n,updater:(n,r)=>(j(t,e,r),Reflect.set(n,e,r))}),deleteProperty:(t,e)=>r.proxyIsMuted?Reflect.deleteProperty(t,e):C({target:t,prop:e,notifyTarget:!0,updater:n=>(((t,e)=>{k((()=>{console.groupCollapsed(`DELETE: ${T(t,e)}`),console.info("Property: ",T(t,e)),console.groupEnd()}))})(t,e),Reflect.deleteProperty(n,e))})});var e},B=require("react-dom"),Y=n.n(B)().unstable_batchedUpdates||(t=>{t()}),N={components:new Map,changedPaths:new Set};var D;r.store=I({}),D=({target:t,prop:e,value:n,notifyTarget:o=!1,updater:s})=>g((()=>{let a;const c=_(t),u=R(t,e);let f=!1;const h=m(t);let p=n;return l(p)&&(p=v(n,((t,e)=>{if(!l(t))return t;const n=y(t);return A(n,[...u,...e]),I(n)}))),c.length?c.reduce(((e,n,o)=>{const u=d(e,n);let l=y(u);return A(l,_(u)),l=I(l),b(e,n,l),o===c.length-1&&(a=s(l,p),f=m(l)!==h,r.nextVersionMap.set(t[i]||t,l)),l}),r.store):(a=s(r.store,p),f=m(r.store)!==h),(t=>{const e=L(t),n=w(t);N.changedPaths.add(n),r.listeners.forEach(((t,r)=>{""!==e&&e!==r||t.forEach((t=>{const e=N.components.get(t)||new Set;e.add(n),N.components.set(t,e)}))})),r.isBatchUpdating||(Y((()=>{N.components.forEach(((t,e)=>{((t,e)=>{k((()=>{console.groupCollapsed(`UPDATE:  <${t._name}>`),console.info("Changed properties:",e),console.groupEnd()}))})(e,Array.from(t)),e.update()}))})),r.manualListeners.forEach((t=>t({changedProps:Array.from(N.changedPaths),renderedComponents:Array.from(N.components.keys()),store:r.store}))),N.components.clear(),N.changedPaths.clear())})(o||f?c:u),a})),M.UpdateNextStore=D;var z=n(1974),U=n.n(z),V=n(8679),K=n.n(V);const H=[],$=()=>{r.isInBrowser&&(k((()=>{console.groupEnd()})),H.pop(),r.currentComponent=H[H.length-1]||null)},q=()=>g((()=>{const t=Object.assign({},r.store);return r.nextVersionMap.set(t,r.store),I(t)})),G=t=>{const e=t.displayName||t.name||"NamelessComponent";class n extends U().PureComponent{constructor(){super(...arguments),this.state={store:q()},this._isMounted=!1,this._isMounting=!0,this._isRendering=!1,this._name=e}componentDidMount(){this._isMounted=!0,this._isMounting=!1,$(),this._isRendering=!1}componentDidUpdate(){$(),this._isRendering=!1}componentWillUnmount(){var t;t=this,r.listeners.forEach(((e,n)=>{const o=Array.from(e).filter((e=>e!==t));o.length?r.listeners.set(n,new Set(o)):r.listeners.delete(n)})),this._isMounted=!1}update(){(this._isMounted||this._isMounting)&&this.setState({store:q()})}render(){var e;this._isRendering||(e=this,r.isInBrowser&&(k((()=>{console.groupCollapsed(`RENDER: <${e._name}>`)})),r.currentComponent=e,H.push(r.currentComponent)),this._isRendering=!0);const n=Object.assign(Object.assign({},this.props),{store:this.state.store});return U().createElement(t,Object.assign({},n))}}return n.displayName=`Collected(${e})`,K()(n,t)};let X;X=n(5697);const{store:J}=r;"undefined"!=typeof window&&("Proxy"in window?window.__RR__={debugOn:()=>{S=E,P(s,E)},debugOff:()=>{S=Z,P(s,Z)},internals:r}:console.warn("This browser doesn't support the Proxy object, which react-recollect needs. See https://caniuse.com/#search=proxy to find out which browsers do support it"))},5565:(t,e,n)=>{t.exports=n(6626)},3379:t=>{"use strict";var e=[];function n(t){for(var n=-1,r=0;r<e.length;r++)if(e[r].identifier===t){n=r;break}return n}function r(t,r){for(var i={},s=[],a=0;a<t.length;a++){var c=t[a],u=r.base?c[0]+r.base:c[0],f=i[u]||0,l="".concat(u," ").concat(f);i[u]=f+1;var h=n(l),p={css:c[1],media:c[2],sourceMap:c[3],supports:c[4],layer:c[5]};if(-1!==h)e[h].references++,e[h].updater(p);else{var y=o(p,r);r.byIndex=a,e.splice(a,0,{identifier:l,updater:y,references:1})}s.push(l)}return s}function o(t,e){var n=e.domAPI(e);return n.update(t),function(e){if(e){if(e.css===t.css&&e.media===t.media&&e.sourceMap===t.sourceMap&&e.supports===t.supports&&e.layer===t.layer)return;n.update(t=e)}else n.remove()}}t.exports=function(t,o){var i=r(t=t||[],o=o||{});return function(t){t=t||[];for(var s=0;s<i.length;s++){var a=n(i[s]);e[a].references--}for(var c=r(t,o),u=0;u<i.length;u++){var f=n(i[u]);0===e[f].references&&(e[f].updater(),e.splice(f,1))}i=c}}},569:t=>{"use strict";var e={};t.exports=function(t,n){var r=function(t){if(void 0===e[t]){var n=document.querySelector(t);if(window.HTMLIFrameElement&&n instanceof window.HTMLIFrameElement)try{n=n.contentDocument.head}catch(t){n=null}e[t]=n}return e[t]}(t);if(!r)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");r.appendChild(n)}},9216:t=>{"use strict";t.exports=function(t){var e=document.createElement("style");return t.setAttributes(e,t.attributes),t.insert(e,t.options),e}},3565:(t,e,n)=>{"use strict";t.exports=function(t){var e=n.nc;e&&t.setAttribute("nonce",e)}},7795:t=>{"use strict";t.exports=function(t){var e=t.insertStyleElement(t);return{update:function(n){!function(t,e,n){var r="";n.supports&&(r+="@supports (".concat(n.supports,") {")),n.media&&(r+="@media ".concat(n.media," {"));var o=void 0!==n.layer;o&&(r+="@layer".concat(n.layer.length>0?" ".concat(n.layer):""," {")),r+=n.css,o&&(r+="}"),n.media&&(r+="}"),n.supports&&(r+="}");var i=n.sourceMap;i&&"undefined"!=typeof btoa&&(r+="\n/*# sourceMappingURL=data:application/json;base64,".concat(btoa(unescape(encodeURIComponent(JSON.stringify(i))))," */")),e.styleTagTransform(r,t,e.options)}(e,t,n)},remove:function(){!function(t){if(null===t.parentNode)return!1;t.parentNode.removeChild(t)}(e)}}}},4589:t=>{"use strict";t.exports=function(t,e){if(e.styleSheet)e.styleSheet.cssText=t;else{for(;e.firstChild;)e.removeChild(e.firstChild);e.appendChild(document.createTextNode(t))}}},3333:(t,e,n)=>{var r={"./animate.jsx":5061,"./changezone.jsx":1183,"./chat.jsx":5317,"./dance.jsx":8304,"./dialogue.jsx":2282,"./face.jsx":2813,"./greeting.jsx":1162,"./interact.jsx":5544,"./move.jsx":2897,"./patrol.jsx":2704,"./script.jsx":5744};function o(t){var e=i(t);return n(e)}function i(t){if(!n.o(r,t)){var e=new Error("Cannot find module '"+t+"'");throw e.code="MODULE_NOT_FOUND",e}return r[t]}o.keys=function(){return Object.keys(r)},o.resolve=i,t.exports=o,o.id=3333},4816:(t,e,n)=>{var r={"./dungeon-bottom/map.jsx":948,"./dungeon-top/map.jsx":4805,"./room/map.jsx":5686};function o(t){var e=i(t);return n(e)}function i(t){if(!n.o(r,t)){var e=new Error("Cannot find module '"+t+"'");throw e.code="MODULE_NOT_FOUND",e}return r[t]}o.keys=function(){return Object.keys(r)},o.resolve=i,t.exports=o,o.id=4816},7467:(t,e,n)=>{var r={"./characters/copy.jsx":642,"./characters/default.jsx":7154,"./effects/fireplace.jsx":597,"./effects/waterspurt.jsx":5359,"./furniture/door.jsx":7085,"./furniture/fireplace.jsx":6463,"./furniture/tree.jsx":5624,"./npc/air-knight.jsx":5378,"./npc/darkness.jsx":6613,"./npc/earth-knight.jsx":5532,"./npc/fire-knight.jsx":4267,"./npc/water-knight.jsx":3886,"./objects/chests/blue.jsx":4247,"./objects/chests/metal.jsx":2188,"./objects/chests/red.jsx":3991,"./objects/chests/wood.jsx":4475};function o(t){var e=i(t);return n(e)}function i(t){if(!n.o(r,t)){var e=new Error("Cannot find module '"+t+"'");throw e.code="MODULE_NOT_FOUND",e}return r[t]}o.keys=function(){return Object.keys(r)},o.resolve=i,t.exports=o,o.id=7467},7935:(t,e,n)=>{var r={"./sewer/tileset.jsx":3507};function o(t){var e=i(t);return n(e)}function i(t){if(!n.o(r,t)){var e=new Error("Cannot find module '"+t+"'");throw e.code="MODULE_NOT_FOUND",e}return r[t]}o.keys=function(){return Object.keys(r)},o.resolve=i,t.exports=o,o.id=7935},1974:t=>{"use strict";t.exports=require("react")}},e={};function n(r){var o=e[r];if(void 0!==o)return o.exports;var i=e[r]={id:r,exports:{}};return t[r](i,i.exports,n),i.exports}n.n=t=>{var e=t&&t.__esModule?()=>t.default:()=>t;return n.d(e,{a:e}),e},n.d=(t,e)=>{for(var r in e)n.o(e,r)&&!n.o(t,r)&&Object.defineProperty(t,r,{enumerable:!0,get:e[r]})},n.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),n.r=t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})};var r={};(()=>{"use strict";n.r(r),n.d(r,{default:()=>Lt});var t=n(1974),e=n.n(t),o=n(5565),i=n(5697),s=n.n(i),a=n(9175),c=n(8348),u=n(7408);function f(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var l=function(){function t(e,n){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.engine=n,this.src=e,this.glTexture=n.gl.createTexture(),this.image=new Image,this.image.onload=this.onImageLoaded.bind(this),this.image.src=e,this.loaded=!1,this.onLoadActions=new u.Z}var e,n;return e=t,(n=[{key:"runWhenLoaded",value:function(t){this.loaded?t():this.onLoadActions.add(t)}},{key:"onImageLoaded",value:function(){var t=this.engine.gl;console.log("loaded image '"+this.src+"'"),t.bindTexture(t.TEXTURE_2D,this.glTexture),t.texImage2D(t.TEXTURE_2D,0,t.RGBA,t.RGBA,t.UNSIGNED_BYTE,this.image),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MAG_FILTER,t.NEAREST),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,t.NEAREST),t.bindTexture(t.TEXTURE_2D,null),this.loaded=!0,this.onLoadActions.run()}},{key:"attach",value:function(){var t=this.engine.gl;t.activeTexture(t.TEXTURE0),t.bindTexture(t.TEXTURE_2D,this.glTexture),t.uniform1i(this.engine.shaderProgram.samplerUniform,0)}}])&&f(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),t}();function h(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var p=new FontFace("minecraftia","url(/pixos/font/minecraftia.ttf)"),y=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.ctx=e,this.dirty=!0,this.scrollY=0,this.fontSize=24,this.font="minecraftia",this.align="left",this.background="#999",this.border={lineWidth:4,style:"white",corner:"round"},this.scrollBox={width:5,background:"#568",color:"#78a"},this.fontStyle="white",this.lines=[]}var e,n;return e=t,n=[{key:"init",value:function(t,e,n,r,o){var i,s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:{};this.text=t,this.x=e,this.y=n,this.width=r,this.height=o,this.portrait=null!==(i=s.portrait)&&void 0!==i?i:null,this.setOptions(s),this.cleanit()}},{key:"cleanit",value:function(t){this.dirty&&(this.setFont(),this.getTextPos(),this.dirty=!1,t||this.fitText())}},{key:"setOptions",value:function(t){var e=this;Object.keys(this).forEach((function(n){void 0!==t[n]&&(e[n]=t[n],e.dirty=!0)}))}},{key:"setFont",value:function(){this.fontStr=this.fontSize+"px "+this.font,this.textHeight=this.fontSize+Math.ceil(.05*this.fontSize)}},{key:"getTextPos",value:function(){"left"===this.align?this.textPos=2:"right"===this.align?this.textPos=Math.floor(this.width-this.scrollBox.width-this.fontSize/4):this.textPos=Math.floor((this.width- -this.scrollBox.width)/2)}},{key:"fitText",value:function(){var t=this.ctx;this.cleanit(!0),t.font=this.fontStr,t.textAlign=this.align,t.textBaseline="top";var e=this.text.split(" ");this.lines.length=0;for(var n="",r="";e.length>0;){var o=e.shift();t.measureText(n+r+o).width<this.width-this.scrollBox.width-this.scrollBox.width-(this.portrait?84:0)?(n+=r+o,r=" "):(""===r?n+=o:e.unshift(o),this.lines.push(n),r="",n="")}""!==n&&this.lines.push(n),this.maxScroll=(this.lines.length+.5)*this.textHeight-this.height}},{key:"drawBorder",value:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],e=this.ctx,n=this.border.lineWidth/2;e.lineJoin=this.border.corner,e.lineWidth=this.border.lineWidth,e.strokeStyle=this.border.style,t?e.strokeRect(this.x-n+84,this.y-n,this.width+2*n-84,this.height+2*n):e.strokeRect(this.x-n,this.y-n,this.width+2*n,this.height+2*n)}},{key:"drawScrollBox",value:function(){var t=this.ctx,e=this.height/(this.lines.length*this.textHeight);t.fillStyle=this.scrollBox.background,t.fillRect(this.x+this.width-this.scrollBox.width,this.y,this.scrollBox.width,this.height),t.fillStyle=this.scrollBox.color;var n=this.height*e;n>this.height&&(n=this.height),t.fillRect(this.x+this.width-this.scrollBox.width,this.y-this.scrollY*e,this.scrollBox.width,n)}},{key:"drawPortrait",value:function(){this.ctx.drawImage(this.portrait.image,this.x,this.y+38,76,76)}},{key:"scroll",value:function(t){this.cleanit(),this.scrollY=-t,this.scrollY>0?this.scrollY=0:this.scrollY<-this.maxScroll&&(this.scrollY=-this.maxScroll)}},{key:"scrollLines",value:function(t){this.cleanit(),this.scrollY=-this.textHeight*t,this.scrollY>0?this.scrollY=0:this.scrollY<-this.maxScroll&&(this.scrollY=-this.maxScroll)}},{key:"render",value:function(){var t=this.ctx;this.cleanit(),t.font=this.fontStr,t.textAlign=this.align,this.portrait?(this.drawBorder(!0),this.drawPortrait(),t.save(),t.fillStyle=this.background,t.fillRect(this.x+84,this.y,this.width-84,this.height)):(this.drawBorder(),t.save(),t.fillStyle=this.background,t.fillRect(this.x,this.y,this.width,this.height)),this.drawScrollBox(),this.portrait?(t.beginPath(),t.rect(this.x+84,this.y,this.width-this.scrollBox.width-84,this.height),t.clip(),t.setTransform(1,0,0,1,this.x+84,Math.floor(this.y+this.scrollY))):(t.beginPath(),t.rect(this.x,this.y,this.width-this.scrollBox.width,this.height),t.clip(),t.setTransform(1,0,0,1,this.x,Math.floor(this.y+this.scrollY))),t.fillStyle=this.fontStyle;for(var e=0;e<this.lines.length;e++)t.fillText(this.lines[e],this.textPos,Math.floor(e*this.textHeight)+2);t.restore()}}],n&&h(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),t}();function d(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function b(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function m(t,e,n){return e&&b(t.prototype,e),n&&b(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}var v=function(){function t(e){var n=this;d(this,t),this.ctx=e,this.dirty=!0,this.showTrace=!0,this.showDebug=!0,this.fontSize=24,this.opacity=.4,this.font="minecraftia",this.start=!1,this.select=!1,this.touches={},this.map={},this.layout="BOTTOM_RIGHT",this.radius=25,this.button_offset={x:3*this.radius,y:3*this.radius},this.observerFunction=function(){return n.map},this.colours={red:"rgba(255,0,0,".concat(this.opacity,")"),green:"rgba(0,255,0,".concat(this.opacity,")"),blue:"rgba(0,0,255,".concat(this.opacity,")"),purple:"rgba(255,0,255,".concat(this.opacity,")"),yellow:"rgba(255,255,0,".concat(this.opacity,")"),cyan:"rgba(0,255,255,".concat(this.opacity,")"),black:"rgba(0,0,0,".concat(this.opacity,")"),white:"rgba(255,255,255,".concat(this.opacity,")"),joystick:{base:"rgba(0,0,0,".concat(this.opacity,")"),dust:"rgba(0,0,0,".concat(this.opacity,")"),stick:"rgba(204,204,204,1)",ball:"rgba(255,255,255,1)"}},this.buttons_layout=[{x:-this.radius,y:this.radius,r:this.radius,color:this.colours.red,name:"a"},{x:2*this.radius-this.radius,y:-(this.radius+this.radius)+this.radius,r:this.radius,color:this.colours.green,name:"b"},{x:2*this.radius-this.radius,y:this.radius+this.radius+this.radius,r:this.radius,color:this.colours.blue,name:"x"},{x:3*this.radius,y:0+this.radius,r:this.radius,color:this.colours.purple,name:"y"}],this.start&&this.buttons_layout.push({x:this.ctx.canvas.width/2,y:-15,w:50,h:15,color:this.colours.black,name:"start"}),this.select&&this.buttons_layout.push({x:this.ctx.canvas.width/2,y:-15,w:50,h:15,color:this.colours.black,name:"select"}),this.controller=new g(e,this.layout,this.buttons_layout,this.button_offset,this.map,this.touches,this.start,this.select,this.colours),CanvasRenderingContext2D.prototype.roundRect=function(t,e,n,r,o){return n<2*o&&(o=n/2),r<2*o&&(o=r/2),this.beginPath(),this.moveTo(t+o,e),this.arcTo(t+n,e,t+n,e+r,o),this.arcTo(t+n,e+r,t,e+r,o),this.arcTo(t,e+r,t,e,o),this.arcTo(t,e,t+n,e,o),this.closePath(),this}}return m(t,[{key:"init",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};console.log("initing"),this.setOptions(t),this.resize(),this.loadCanvas()}},{key:"resize",value:function(){this.width=this.ctx.canvas.width,this.height=this.ctx.canvas.height,this.controller.init()}},{key:"loadCanvas",value:function(){var t=this,e=this.ctx,n=this.controller,r=this.width,o=this.height;e.fillStyle="rgba(70,70,70,0.5)",e.textAlign="center",e.textBaseline="middle",e.font="minecraftia 14px",e.fillText("loading",r/2,o/2),n.stick.draw(),n.buttons.draw(),window.addEventListener("resize",(function(){return t.resize()})),setTimeout((function(){this.ready=!0}),250)}},{key:"setOptions",value:function(t){var e=this;Object.keys(this).forEach((function(n){void 0!==t[n]&&(e[n]=t[n],e.dirty=!0)}))}},{key:"listen",value:function(t){var e=this.ctx,n=this.touches,r=this.controller,o=this.buttons_layout;if(t.type){var i=t.type;-1!=t.type.indexOf("mouse")&&(t.identifier="desktop",t={touches:[t]});for(var s=0;s<(t.touches.length>5?5:t.touches.length);s++)n[a=t.touches[s].identifier]?(n[a].x=t.touches[s].pageX,n[a].y=t.touches[s].pageY):n[a]={x:t.touches[s].pageX-e.canvas.left,y:t.touches[s].pageY-e.canvas.top};for(var a in n)switch(i){case"touchstart":case"touchmove":for(r.stick.state(a),s=0;s<o.length;s++)r.buttons.state(a,s);break;case"mousedown":case"mousemove":case"mouseup":for(r.stick.state(a,i),s=0;s<o.length;s++)r.buttons.state(a,s,i)}if("touchend"==t.type){for("stick"==n[a=t.changedTouches[0].identifier].id&&r.stick.reset(),s=0;s<o.length;s++)n[a].id==o[s].name&&r.buttons.reset(s);if(n[a]&&delete n[a],t.changedTouches.length>t.touches.length){var c=0,u=t.changedTouches.length-t.touches.length;for(var a in n)c>=u&&delete n[a],c++}if(0==t.touches.length){for(n={},s=0;s<o.length;s++)r.buttons.reset(s);r.stick.reset()}}}else{var f=t,l=0;for(var h in f){switch(h){case"%":f[h]&&(l+=1);break;case"&":f[h]&&(l+=2);break;case"'":f[h]&&(l+=4);break;case"(":f[h]&&(l+=8);break;default:if(f[h])for(s=0;s<o.length;s++)o[s].key&&o[s].key==h&&(n[o[s].name]={id:o[s].name,x:o[s].hit.x[0]+o[s].w/2,y:o[s].hit.y[0]+o[s].h/2},r.buttons.state(o[s].name,s,"mousedown"));else if(!f[h]){for(s=0;s<o.length;s++)o[s].key&&o[s].key==h&&(r.buttons.reset(s),delete n[o[s].name]);delete f[h]}}switch(r.stick.dx=r.stick.x,r.stick.dy=r.stick.y,l){case 1:r.stick.dx=r.stick.x-r.stick.radius/2;break;case 2:r.stick.dy=r.stick.y-r.stick.radius/2;break;case 3:r.stick.dx=r.stick.x-r.stick.radius/2,r.stick.dy=r.stick.y-r.stick.radius/2;break;case 4:r.stick.dx=r.stick.x+r.stick.radius/2;break;case 6:r.stick.dx=r.stick.x+r.stick.radius/2,r.stick.dy=r.stick.y-r.stick.radius/2;break;case 8:r.stick.dy=r.stick.y+r.stick.radius/2;break;case 9:r.stick.dx=r.stick.x-r.stick.radius/2,r.stick.dy=r.stick.y+r.stick.radius/2;break;case 12:r.stick.dx=r.stick.x+r.stick.radius/2,r.stick.dy=r.stick.y+r.stick.radius/2;break;default:r.stick.dx=r.stick.x,r.stick.dy=r.stick.y}0!=l?(n.stick={id:"stick"},r.stick.state("stick","mousemove")):(r.stick.reset(),delete n.stick)}}return this.map}},{key:"render",value:function(){var t=this.ctx;t.clearRect(0,0,t.canvas.width,t.canvas.height),this.showDebug&&this.debug(),this.showTrace&&this.trace(),this.controller.stick.draw(),this.controller.buttons.draw()}},{key:"debug",value:function(){var t=this.ctx,e=(this.map,this.touches);for(var n in this.dy=30,t.fillStyle="rgba(70,70,70,0.5)",t.textAlign="left",t.textBaseline="middle",t.font="minecraftia 20px",t.fillText("debug",10,this.dy),t.font="minecraftia 14px",this.dy+=5,e){this.dy+=10;var r=n+" : "+JSON.stringify(e[n]).slice(1,-1);t.fillText(r,10,this.dy)}}},{key:"trace",value:function(){var t=this.ctx,e=this.map;for(var n in this.dy=30,t.fillStyle="rgba(70,70,70,0.5)",t.textAlign="right",t.textBaseline="middle",t.font="minecraftia 20px",t.fillText("trace",this.width-10,this.dy),t.font="minecraftia 14px",this.dy+=5,e){this.dy+=10;var r=n+" : "+e[n];t.fillText(r,this.width-10,this.dy)}}}]),t}(),g=function(){function t(e,n,r,o,i,s,a,c,u){d(this,t),this.ctx=e,this.width=e.canvas.width,this.height=e.canvas.height,this.radius=40,this.layout=n,this.touches=s,this.map=i,this.start=a,this.select=c,this.buttons_layout=r,this.button_offset=o,this.colours=u,console.log("loading Controller Manager - ",this)}return m(t,[{key:"init",value:function(){var t=this.layout,e=this.width,n=this.height,r=t;switch(this.layout={x:0,y:0},r){case"TOP_LEFT":for(var o=0,i=0;i<this.buttons_layout.length;i++)this.buttons_layout[i].r&&(o+=this.buttons_layout[i].r,this.buttons_layout[i].y-=2*this.buttons_layout[i].r);this.layout.x=o+this.button_offset.x,this.layout.y=0+this.button_offset.y;break;case"TOP_RIGHT":t.x=e-this.button_offset.x,t.y=0+this.button_offset.y;break;case"BOTTOM_LEFT":for(o=0,i=0;i<this.buttons_layout.length;i++)this.buttons_layout[i].r&&(o+=this.buttons_layout[i].r);this.layout.x=o+this.button_offset.x,this.layout.y=n-this.button_offset.y;break;default:this.layout.x=e-this.button_offset.x,this.layout.y=n-this.button_offset.y}this.stick=new O(this.ctx,this.layout,this.map,this.touches,this.colours,this.radius),this.buttons=new w(this.ctx,this.layout,this.buttons_layout,this.map,this.touches,this.start,this.select,this.colours,this.radius),this.stick.init(),this.buttons.init()}},{key:"draw",value:function(){this.stick.draw(),this.buttons.draw()}}]),t}(),O=function(){function t(e,n,r,o,i,s){d(this,t),this.ctx=e,this.map=r,this.width=e.canvas.width,this.height=e.canvas.height,this.layout=n,this.touches=o,this.radius=s,this.x=0,this.y=0,this.dx=0,this.dy=0,this.map["x-dir"]=0,this.map["y-dir"]=0,this.map["x-axis"]=0,this.map["y-axis"]=0,this.colours=i,this.init=this.init.bind(this),this.draw=this.draw.bind(this),console.log("loading Controller Joystick - ",this)}return m(t,[{key:"init",value:function(){this.map;var t=this.layout,e=this.width;this.ctx,this.x=e-t.x,this.y=t.y,this.dx=this.x,this.dy=this.y,this.map["x-dir"]=0,this.map["y-dir"]=0,this.map["x-axis"]=0,this.map["y-axis"]=0}},{key:"draw",value:function(){var t=this.ctx;t.fillStyle=this.colours.joystick.base,t.beginPath(),t.arc(this.x,this.y,this.radius,0,2*Math.PI,!1),t.fill(),t.closePath(),t.fillStyle=this.colours.joystick.dust,t.beginPath(),t.arc(this.x,this.y,this.radius-5,0,2*Math.PI,!1),t.fill(),t.closePath(),t.fillStyle=this.colours.joystick.stick,t.beginPath(),t.arc(this.x,this.y,10,0,2*Math.PI,!1),t.fill(),t.closePath(),t.fillStyle=this.colours.joystick.ball,t.beginPath(),t.arc(this.dx,this.dy,this.radius-10,0,2*Math.PI,!1),t.fill(),t.closePath()}},{key:"state",value:function(t,e){var n=this.map,r=this.touches,o=this.observerFunction,i=r[t].x,s=r[t].y,a=parseInt(i-this.x),c=parseInt(s-this.y),u=parseInt(Math.sqrt(a*a+c*c));if(u<1.5*this.radius)if(e)switch(e){case"mousedown":r[t].id="stick";break;case"mouseup":delete r[t].id,this.reset()}else r[t].id="stick";"stick"==r[t].id&&(Math.abs(parseInt(a))<this.radius/2&&(this.dx=this.x+a),Math.abs(parseInt(c))<this.radius/2&&(this.dy=this.y+c),n["x-axis"]=(this.dx-this.x)/(this.radius/2),n["y-axis"]=(this.dy-this.y)/(this.radius/2),n["x-dir"]=Math.round(n["x-axis"]),n["y-dir"]=Math.round(n["y-axis"]),u>1.5*this.radius&&(this.reset(),delete r[t].id),"function"==typeof o&&o())}},{key:"reset",value:function(){var t=this.map;this.dx=this.x,this.dy=this.y,t["x-dir"]=0,t["y-dir"]=0,t["x-axis"]=0,t["y-axis"]=0}}]),t}(),w=function(){function t(e,n,r,o,i,s,a,c,u){d(this,t),this.ctx=e,this.layout=n,this.map=o,this.radius=u,this.touches=i,this.buttons_layout=r,this.start=s,this.select=a,this.colours=c,console.log("loading Controller Buttons - ",this)}return m(t,[{key:"init",value:function(){for(var t=this.buttons_layout,e=this.layout,n=this.width,r=(this.height,0);r<t.length;r++){var o=t[r],i=e.x-o.x,s=e.y-o.y;if(o.r){var a=o.r;t[r].hit={x:[i-a,i+2*a],y:[s-a,s+2*a],active:!1}}else{if(o.x=n/2-o.w,this.start&&this.select)switch(o.name){case"select":o.x=n/2-o.w-2*o.h;break;case"start":o.x=n/2}i=o.x,s=e.y-o.y,t[r].hit={x:[i,i+o.w],y:[s,s+o.h],active:!1}}this.map[o.name]=0}}},{key:"draw",value:function(){for(var t=this.ctx,e=this.buttons_layout,n=this.layout,r=0;r<this.buttons_layout.length;r++){var o=e[r],i=(o.name,o.color),s=n.x-o.x,a=n.y-o.y;if(o.dx=s,o.dy=a,o.r){var c=o.r;o.hit&&o.hit.active&&(t.fillStyle=i,t.beginPath(),t.arc(s,a,c+5,0,2*Math.PI,!1),t.fill(),t.closePath()),t.fillStyle=i,t.beginPath(),t.arc(s,a,c,0,2*Math.PI,!1),t.fill(),t.closePath(),t.strokeStyle=i,t.lineWidth=2,t.stroke(),t.fillStyle="rgba(255,255,255,1)",t.textAlign="center",t.textBaseline="middle",t.font="minecraftia 12px",t.fillText(o.name,s,a)}else{var u=o.w,f=o.h;s=o.x,a=o.dy,c=10,t.fillStyle=i,o.hit&&o.hit.active&&t.roundRect(s-5,a-5,u+10,f+10,2*c).fill(),t.roundRect(s,a,u,f,c).fill(),t.strokeStyle=i,t.lineWidth=2,t.stroke(),t.fillStyle="rgba(0,0,0,0.5)",t.textAlign="center",t.textBaseline="middle",t.font="minecraftia 12px",t.fillText(o.name,s+u/2,a+2*f)}o.key&&hint&&(t.fillStyle="rgba(0,0,0,0.25)",t.textAlign="center",t.textBaseline="middle",t.font="minecraftia 12px","start"!=o.name&&"select"!=o.name||(s+=u/2),t.fillText(o.key,s,a-1.5*c))}}},{key:"state",value:function(t,e,n){var r=this.touches,o=this.observerFunction,i=this.width;if("stick"!=r[t].id){var s={x:r[t].x,y:r[t].y},a=this.buttons_layout[e],c=a.name,u=parseInt(s.x-a.dx),f=parseInt(s.y-a.dy),l=i;if(a.r?l=parseInt(Math.sqrt(u*u+f*f)):s.x>a.hit.x[0]&&s.x<a.hit.x[1]&&s.y>a.hit.y[0]&&s.y<a.hit.y[1]&&(l=0),l<this.radius&&"stick"!=r[t].id)if(n)switch(n){case"mousedown":r[t].id=c;break;case"mouseup":delete r[t].id,this.reset(e)}else r[t].id=c;r[t].id==c&&(this.map[c]=1,a.hit.active=!0,l>this.radius&&(a.hit.active=!1,this.map[c]=0,delete r[t].id),"function"==typeof o&&o())}}},{key:"reset",value:function(t){var e=this.buttons_layout[t],n=e.name;e.hit.active=!1,this.map[n]=0}}]),t}();function L(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var R=function(){function t(e,n,r){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.id=r,this.engine=n,this.canvas=e,this.ctx=e.getContext("2d"),this.glTexture=n.gl.createTexture(),this.loaded=!1,this.onLoadActions=new u.Z,this.loadImage()}var e,n;return e=t,n=[{key:"runWhenLoaded",value:function(t){this.loaded?t():this.onLoadActions.add(t)}},{key:"loadImage",value:function(){var t=this.engine.gl;t.pixelStorei(t.UNPACK_FLIP_Y_WEBGL,!0),t.bindTexture(t.TEXTURE_2D,this.glTexture),t.texImage2D(t.TEXTURE_2D,0,t.RGBA,t.RGBA,t.UNSIGNED_BYTE,this.canvas),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MAG_FILTER,t.LINEAR),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,t.LINEAR_MIPMAP_NEAREST),t.generateMipmap(t.TEXTURE_2D),t.bindTexture(t.TEXTURE_2D,null),t.pixelStorei(t.UNPACK_FLIP_Y_WEBGL,!1),console.log("loading canvas ",this.canvas),this.loaded=!0,this.onLoadActions.run()}},{key:"attach",value:function(){var t=this.engine.gl;t.activeTexture(t.TEXTURE0),t.bindTexture(t.TEXTURE_2D,this.glTexture),t.uniform1i(this.engine.shaderProgram.samplerUniform,0)}},{key:"clearHud",value:function(){var t=this.ctx;t.clearRect(0,0,t.canvas.width,t.canvas.height),this.loadImage()}},{key:"writeText",value:function(t,e,n){var r=this.ctx;r.save(),r.font="32px minecraftia",r.textAlign="center",r.textBaseline="middle",r.fillStyle="white",r.fillText(t,null!=e?e:r.canvas.width/2,null!=n?n:r.canvas.height/2),r.restore()}},{key:"scrollText",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=new y(this.ctx);return n.portrait?r.init(t,10,10,this.canvas.width-20-84,2*this.canvas.height/3-20,n):r.init(t,10,10,this.canvas.width-20,2*this.canvas.height/3-20,n),r.setOptions(n),e&&r.scroll((Math.sin((new Date).getTime()/3e3)+1)*r.maxScroll*.5),r.render(),r}}],n&&L(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),t}();function T(t,e,n,r,o,i,s){try{var a=t[i](s),c=a.value}catch(t){return void n(t)}a.done?e(c):Promise.resolve(c).then(r,o)}function A(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var _=function(){function t(e,n,r,o,i,s){var u,f,l=this;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),f=function(t,e){var n=e.vs,r=e.fs,o=l,i=l.loadShader(t,t.VERTEX_SHADER,n),s=l.loadShader(t,t.FRAGMENT_SHADER,r),a=t.createProgram();if(t.attachShader(a,i),t.attachShader(a,s),t.linkProgram(a),!t.getProgramParameter(a,t.LINK_STATUS))throw new Error("WebGL unable to initialize the shader program: ".concat(t.getshaderProgramLog(a)));return t.useProgram(a),a.vertexPositionAttribute=t.getAttribLocation(a,"aVertexPosition"),t.enableVertexAttribArray(a.vertexPositionAttribute),a.textureCoordAttribute=t.getAttribLocation(a,"aTextureCoord"),t.enableVertexAttribArray(a.textureCoordAttribute),a.pMatrixUniform=t.getUniformLocation(a,"uPMatrix"),a.mvMatrixUniform=t.getUniformLocation(a,"uMVMatrix"),a.samplerUniform=t.getUniformLocation(a,"uSampler"),a.setMatrixUniforms=function(){t.uniformMatrix4fv(this.pMatrixUniform,!1,o.uProjMat),t.uniformMatrix4fv(this.mvMatrixUniform,!1,o.uViewMat)},l.shaderProgram=a,a},(u="initShaderProgram")in this?Object.defineProperty(this,u,{value:f,enumerable:!0,configurable:!0,writable:!0}):this[u]=f,this.uViewMat=(0,a.Ue)(),this.uProjMat=(0,a.Ue)(),this.canvas=e,this.hud=n,this.gamepadcanvas=o,this.mipmap=r,this.width=i,this.height=s,this.modelViewMatrixStack=[],this.globalStore={},this.textures=[],this.speeches=[],this.cameraAngle=45,this.cameraPosition=new c.OW(8,8,-1),this.cameraOffset=new c.OW(0,0,0),this.setCamera=this.setCamera.bind(this),this.render=this.render.bind(this)}var e,n,r,o;return e=t,n=[{key:"init",value:(r=regeneratorRuntime.mark((function t(e,n){var r,o,i,s;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(r=this.hud.getContext("2d"),o=this.canvas.getContext("webgl"),i=this.gamepadcanvas.getContext("2d"),o){t.next=5;break}throw new Error("WebGL : unable to initialize");case 5:if(r){t.next=7;break}throw new Error("Canvas : unable to initialize HUD");case 7:if(i){t.next=9;break}throw new Error("Gamepad : unable to initialize Mobile Canvas");case 9:return this.gl=o,this.ctx=r,this.gp=i,this.time=(new Date).getTime(),this.scene=e,this.keyboard=n,(s=new v(i)).init(),this.touch=s.listen.bind(s),this.gamepad=s,r.canvas.width=this.canvas.width,r.canvas.height=this.canvas.height,o.viewportWidth=this.canvas.width,o.viewportHeight=this.canvas.height,o.clearColor(0,1,0,1),o.clearDepth(1),o.enable(o.DEPTH_TEST),o.blendFunc(o.SRC_ALPHA,o.ONE_MINUS_SRC_ALPHA),o.enable(o.BLEND),this.initializedWebGl=!0,this.initShaderProgram(o,e.shaders),this.initProjection(o),t.next=33,e.init(this);case 33:case"end":return t.stop()}}),t,this)})),o=function(){var t=this,e=arguments;return new Promise((function(n,o){var i=r.apply(t,e);function s(t){T(i,n,o,s,a,"next",t)}function a(t){T(i,n,o,s,a,"throw",t)}s(void 0)}))},function(t,e){return o.apply(this,arguments)})},{key:"loadShader",value:function(t,e,n){var r=t.createShader(e);if(t.shaderSource(r,n),t.compileShader(r),!t.getShaderParameter(r,t.COMPILE_STATUS)){var o=t.getShaderInfoLog(r);throw t.deleteShader(r),new Error("An error occurred compiling the shaders: ".concat(o))}return r}},{key:"initProjection",value:function(t){var e=this.degToRad(45),n=t.canvas.clientWidth/t.canvas.clientHeight;this.uProjMat=(0,a.G3)(e,n,.1,100),this.uViewMat=(0,a.Ue)(),this.uProjMat[5]*=-1}},{key:"setCamera",value:function(){(0,a.Iu)(this.uViewMat,this.uViewMat,[0,0,-15]),(0,a.U1)(this.uViewMat,this.uViewMat,this.degToRad(this.cameraAngle),[1,0,0]),(0,c.tk)(this.cameraPosition,this.cameraOffset),(0,a.Iu)(this.uViewMat,this.uViewMat,this.cameraOffset.toArray())}},{key:"clearScreen",value:function(){var t=this.gl;t.viewport(0,0,t.viewportWidth,t.viewportHeight),t.clear(t.COLOR_BUFFER_BIT|t.DEPTH_BUFFER_BIT),(0,a.G3)(this.degToRad(45),t.viewportWidth/t.viewportHeight,.1,100,this.uProjMat),this.uViewMat=(0,a.Ue)()}},{key:"clearHud",value:function(){var t=this.ctx;t.clearRect(0,0,t.canvas.width,t.canvas.height)}},{key:"writeText",value:function(t,e,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,o=this.ctx;o.save(),o.font="20px invasion2000",o.textAlign="center",o.textBaseline="middle",o.fillStyle="white",r?(o.fillText(t,null!=e?e:o.canvas.width/2+76,null!=n?n:o.canvas.height/2),o.drawImage(r,null!=e?e:o.canvas.width/2,null!=n?n:o.canvas.height/2,76,76)):o.fillText(t,null!=e?e:o.canvas.width/2,null!=n?n:o.canvas.height/2),o.restore()}},{key:"setGreeting",value:function(t){this.globalStore.greeting=t}},{key:"scrollText",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=new y(this.ctx);return r.init(t,10,2*this.canvas.height/3,this.canvas.width-20,this.canvas.height/3-20,n),r.setOptions(n),e&&r.scroll((Math.sin((new Date).getTime()/3e3)+1)*r.maxScroll*.5),r.render(),r}},{key:"drawButton",value:function(t,e,n,r,o){var i=this.ctx,s=r/2;i.save(),i.fillStyle=o.background,i.beginPath(),i.rect(t,e,n,r),i.rect(t,e,n,r),i.fill(),i.clip();var a=i.createLinearGradient(t,e,t,e+s);a.addColorStop(0,"rgb(221,181,155)"),a.addColorStop(1,"rgb(22,13,8)"),i.fillStyle=a,i.globalAlpha=.5,i.fillRect(t,e,n,r),i.fillStyle=o.top;for(var c=0;c<r;c+=s){i.fillStyle=0===c?o.top:o.bottom;for(var u=0;u<50;u++){var f=t+Math.random()*n,l=e+c+Math.random()*s,h=10*Math.random(),p=10*Math.random(),y=360*Math.random(),d=Math.random();i.save(),i.translate(f,l),i.rotate(y*Math.PI/180),i.translate(-f,-l),i.globalAlpha=d,i.fillRect(f,l,h,p),i.restore()}}i.restore()}},{key:"render",value:function(){this.requestId=requestAnimationFrame(this.render),this.clearScreen(),this.clearHud(),this.gamepad.render(),this.scene.render(this,(new Date).getTime())}},{key:"createBuffer",value:function(t,e,n){var r=this.gl,o=r.createBuffer();return o.itemSize=n,o.numItems=t.length/n,r.bindBuffer(r.ARRAY_BUFFER,o),r.bufferData(r.ARRAY_BUFFER,new Float32Array(t),e),r.bindBuffer(r.ARRAY_BUFFER,null),o}},{key:"updateBuffer",value:function(t,e){var n=this.gl;n.bindBuffer(n.ARRAY_BUFFER,t),n.bufferSubData(n.ARRAY_BUFFER,0,new Float32Array(e)),n.bindBuffer(n.ARRAY_BUFFER,null)}},{key:"bindBuffer",value:function(t,e){var n=this.gl;n.bindBuffer(n.ARRAY_BUFFER,t),n.vertexAttribPointer(e,t.itemSize,n.FLOAT,!1,0,0)}},{key:"loadTexture",value:function(t){return this.textures[t]||(this.textures[t]=new l(t,this)),this.textures[t]}},{key:"loadSpeech",value:function(t,e){return console.log("requesting speech",t),this.speeches[t]||(this.speeches[t]=new R(e,this,t)),this.speeches[t]}},{key:"mvPushMatrix",value:function(){var t=(0,a.Ue)();(0,a.t8)(this.uViewMat,t),this.modelViewMatrixStack.push(t)}},{key:"initCanvasTexture",value:function(){var t=this.gl.createTexture();return this.handleLoadedTexture(t,this.mipmap),t}},{key:"handleLoadedTexture",value:function(t,e){var n=this.gl;n.pixelStorei(n.UNPACK_FLIP_Y_WEBGL,!0),n.bindTexture(n.TEXTURE_2D,t),n.texImage2D(n.TEXTURE_2D,0,n.RGBA,n.RGBA,n.UNSIGNED_BYTE,e),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_MAG_FILTER,n.LINEAR),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_MIN_FILTER,n.LINEAR_MIPMAP_NEAREST),n.generateMipmap(n.TEXTURE_2D),n.bindTexture(n.TEXTURE_2D,null)}},{key:"mvPopMatrix",value:function(){if(0==this.modelViewMatrixStack.length)throw"Invalid popMatrix!";this.uViewMat=this.modelViewMatrixStack.pop()}},{key:"close",value:function(){cancelAnimationFrame(this.requestId)}},{key:"degToRad",value:function(t){return t*Math.PI/180}}],n&&A(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),t}();function x(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var P=function(){function t(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),t._instance||(this.activeKeys=[],this.activeCodes=[],this.shift=!1,t._instance=this),t._instance}var e,n;return e=t,n=[{key:"onKeyDown",value:function(e){e.preventDefault();var n=String.fromCharCode(e.keyCode).toLowerCase();t._instance.activeKeys.indexOf(n)<0&&t._instance.activeKeys.push(n),t._instance.activeCodes.indexOf(e.key)<0&&t._instance.activeCodes.push(e.key),t._instance.shift=e.shiftKey}},{key:"onKeyUp",value:function(e){var n=String.fromCharCode(e.keyCode).toLowerCase(),r=t._instance.activeKeys.indexOf(n);t._instance.activeKeys.splice(r,1),t._instance.activeCodes.splice(r,1)}},{key:"lastPressed",value:function(e){for(var n=e.toLowerCase(),r=null,o=-1,i=0;i<e.length;i++){var s=n[i],a=t._instance.activeKeys.indexOf(s);a>o&&(r=s,o=a)}return r}},{key:"lastPressedCode",value:function(){for(var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",n=t._instance.activeCodes.pop(),r=e.toLowerCase(),o=0;o<r.length;o++){var i=t._instance.activeKeys.indexOf(n);i<0&&(n=t._instance.activeCodes.pop())}return n}},{key:"lastPressedKey",value:function(){return t._instance.activeKeys[t._instance.activeKeys.length-1]}}],n&&x(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),t}();function E(t,e,n,r,o,i,s){try{var a=t[i](s),c=a.value}catch(t){return void n(t)}a.done?e(c):Promise.resolve(c).then(r,o)}function Z(t){return function(){var e=this,n=arguments;return new Promise((function(r,o){var i=t.apply(e,n);function s(t){E(i,r,o,s,a,"next",t)}function a(t){E(i,r,o,s,a,"throw",t)}s(void 0)}))}}function S(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}var k=function(n){var r,o,i=n.width,s=n.height,a=n.SceneProvider,c=n.class,u=(0,t.useRef)(),f=(0,t.useRef)(),l=(0,t.useRef)(),h=(0,t.useRef)(),y=new P,d=a.onKeyEvent,b=a.onTouchEvent,m=(r=(0,t.useState)({dynamicWidth:window.innerWidth,dynamicHeight:window.innerHeight}),o=2,function(t){if(Array.isArray(t))return t}(r)||function(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var r,o,i=[],s=!0,a=!1;try{for(n=n.call(t);!(s=(r=n.next()).done)&&(i.push(r.value),!e||i.length!==e);s=!0);}catch(t){a=!0,o=t}finally{try{s||null==n.return||n.return()}finally{if(a)throw o}}return i}}(r,o)||function(t,e){if(t){if("string"==typeof t)return S(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?S(t,e):void 0}}(r,o)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),v=m[0],g=m[1],O=function(){g({dynamicWidth:window.innerWidth,dynamicHeight:window.innerHeight})};function w(){return L.apply(this,arguments)}function L(){return(L=Z(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,p.load();case 2:document.fonts.add(p);case 3:case"end":return t.stop()}}),t)})))).apply(this,arguments)}return(0,t.useEffect)(Z(regeneratorRuntime.mark((function t(){var e,n,r,o,c;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return window.addEventListener("resize",O),e=u.current,n=f.current,r=h.current,o=l.current,c=new _(e,n,r,o,i,s),t.next=8,w();case 8:return t.next=10,c.init(a,y);case 10:return c.render(),t.abrupt("return",(function(){window.removeEventListener("resize",O),c.close()}));case 12:case"end":return t.stop()}}),t)}))),[a]),e().createElement("div",{style:{position:"relative",padding:"none",background:"slategrey",width:"100%",maxWidth:i,maxHeight:s+200},onKeyDownCapture:function(t){return d(t.nativeEvent)},onKeyUpCapture:function(t){return d(t.nativeEvent)},tabIndex:0},e().createElement("canvas",{style:{position:"absolute",zIndex:1,top:0,left:0},ref:u,maxWidth:800,maxHeight:600,width:v.dynamicWidth>800?800:v.dynamicWidth,height:3*v.dynamicWidth/4>600?600:3*v.dynamicWidth/4,className:c}),e().createElement("canvas",{style:{position:"absolute",zIndex:2,top:0,left:0,background:"none"},ref:f,maxWidth:800,maxHeight:600,width:v.dynamicWidth>800?800:v.dynamicWidth,height:3*v.dynamicWidth/4>600?600:3*v.dynamicWidth/4,className:c}),e().createElement("canvas",{style:{position:"relative",zIndex:5,top:0,left:0,background:"none"},ref:l,maxWidth:800,maxHeight:600,width:v.dynamicWidth>800?800:v.dynamicWidth,height:3*v.dynamicWidth/4>600?800:3*v.dynamicWidth/4+200,className:c,onMouseUp:function(t){return b(t.nativeEvent)},onMouseDown:function(t){return b(t.nativeEvent)},onMouseMove:function(t){return b(t.nativeEvent)},onTouchMove:function(t){return b(t.nativeEvent)},onTouchCancel:function(t){return b(t.nativeEvent)},onTouchStart:function(t){b(t.nativeEvent)},onTouchEnd:function(t){return b(t.nativeEvent)}}),e().createElement("canvas",{style:{display:"none"},ref:h,width:256,height:256}))};k.propTypes={width:s().number.isRequired,height:s().number.isRequired,SceneProvider:s().object.isRequired,class:s().string.isRequired};const W=k;var j=n(4180),M=n(6185),C=n(9337);function F(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function I(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?F(Object(n),!0).forEach((function(e){B(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):F(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function B(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Y(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function N(t,e,n,r,o,i,s){try{var a=t[i](s),c=a.value}catch(t){return void n(t)}a.done?e(c):Promise.resolve(c).then(r,o)}function D(t){return function(){var e=this,n=arguments;return new Promise((function(r,o){var i=t.apply(e,n);function s(t){N(i,r,o,s,a,"next",t)}function a(t){N(i,r,o,s,a,"throw",t)}s(void 0)}))}}function z(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var U=function(){function t(e,n){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.id=e,this.world=n,this.data={},this.spriteDict={},this.spriteList=[],this.engine=n.engine,this.onLoadActions=new u.Z,this.spriteLoader=new C.jf(n.engine),this.tsLoader=new C.e5(n.engine),this.onTilesetDefinitionLoaded=this.onTilesetDefinitionLoaded.bind(this),this.onTilesetOrSpriteLoaded=this.onTilesetOrSpriteLoaded.bind(this),this.loadSprite=this.loadSprite.bind(this,this),this.checkInput=this.checkInput.bind(this)}var e,r,o,i,s,a,c,f,l;return e=t,r=[{key:"loadRemote",value:(l=D(regeneratorRuntime.mark((function t(){var e,n,r=this;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,fetch(M.Z.zoneRequestUrl(this.id));case 2:if(!(e=t.sent).ok){t.next=25;break}return t.prev=4,t.next=7,e.json();case 7:return n=t.sent,this.bounds=n.bounds,this.size=[n.bounds[2]-n.bounds[0],n.bounds[3]-n.bounds[1]],this.cells=n.cells,t.next=13,this.tsLoader.load(n.tileset);case 13:return this.tileset=t.sent,this.tileset.runWhenDefinitionLoaded(this.onTilesetDefinitionLoaded.bind(this)),this.tileset.runWhenLoaded(this.onTilesetOrSpriteLoaded.bind(this)),t.next=18,Promise.all(n.sprites.map(this.loadSprite.bind(this)));case 18:this.spriteList.forEach((function(t){return t.runWhenLoaded(r.onTilesetOrSpriteLoaded.bind(r))})),t.next=25;break;case 21:t.prev=21,t.t0=t.catch(4),console.error("Error parsing zone "+this.id),console.error(t.t0);case 25:case"end":return t.stop()}}),t,this,[[4,21]])}))),function(){return l.apply(this,arguments)})},{key:"load",value:(f=D(regeneratorRuntime.mark((function t(){var e,r;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,e=n(4816)("./"+this.id+"/map.jsx").default,Object.assign(this,e),this.audioSrc&&(this.audio=new C.mT(this.audioSrc,!0)),this.size=[this.bounds[2]-this.bounds[0],this.bounds[3]-this.bounds[1]],t.next=7,this.tsLoader.load(this.tileset);case 7:return this.tileset=t.sent,this.tileset.runWhenDefinitionLoaded(this.onTilesetDefinitionLoaded.bind(this)),this.tileset.runWhenLoaded(this.onTilesetOrSpriteLoaded.bind(this)),r=this,t.next=13,Promise.all(r.sprites.map(r.loadSprite));case 13:console.log(r.spriteDict),r.spriteList.forEach((function(t){return t.runWhenLoaded(r.onTilesetOrSpriteLoaded)})),t.next=21;break;case 17:t.prev=17,t.t0=t.catch(0),console.error("Error parsing zone "+this.id),console.error(t.t0);case 21:case"end":return t.stop()}}),t,this,[[0,17]])}))),function(){return f.apply(this,arguments)})},{key:"runWhenLoaded",value:function(t){this.loaded?t():this.onLoadActions.add(t)}},{key:"onTilesetDefinitionLoaded",value:function(){this.vertexPosBuf=[],this.vertexTexBuf=[],this.walkability=[];for(var t=0,e=0;t<this.size[1];t++){for(var n=[],r=[],o=0;o<this.size[0];o++,e++){var i=this.cells[e];this.walkability[e]=j.N.All;for(var s=Math.floor(i.length/3),a=0;a<s;a++){var c=[this.bounds[0]+o,this.bounds[1]+t,i[3*a+2]];this.walkability[e]&=this.tileset.getWalkability(i[3*a]),n=n.concat(this.tileset.getTileVertices(i[3*a],c)),r=r.concat(this.tileset.getTileTexCoords(i[3*a],i[3*a+1]))}i.length==3*s+1&&(this.walkability[e]=i[3*s])}this.vertexPosBuf[t]=this.engine.createBuffer(n,this.engine.gl.STATIC_DRAW,3),this.vertexTexBuf[t]=this.engine.createBuffer(r,this.engine.gl.STATIC_DRAW,2)}}},{key:"onTilesetOrSpriteLoaded",value:function(){var t=this;if(!this.loaded&&this.tileset.loaded&&this.spriteList.every((function(t){return t.loaded}))){console.log("Initialized zone '"+this+"'");var e=this;this.scripts.forEach((function(n){"load-scene"===n.id&&t.runWhenLoaded(n.trigger.bind(e))})),this.loaded=!0,this.onLoadActions.run()}}},{key:"loadSprite",value:(c=D(regeneratorRuntime.mark((function t(e,n){var r;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n.zone=e,t.next=3,this.spriteLoader.load(n.type,(function(t){return t.onLoad(n)}));case 3:r=t.sent,console.log(["this",this.spriteDict,this.spriteList,n,r]),this.spriteDict[n.id]=r,this.spriteList.push(r);case 7:case"end":return t.stop()}}),t,this)}))),function(t,e){return c.apply(this,arguments)})},{key:"addSprite",value:function(t){t.zone=this,this.spriteDict[t.id]=t,this.spriteList.push(t)}},{key:"removeSprite",value:function(t){this.spriteList=this.spriteList.filter((function(e){if(e.id!==t)return!0;e.removeAllActions()})),delete this.spriteDict[t]}},{key:"removeAllSprites",value:function(){this.spriteList=[],this.spriteDict={}}},{key:"getSpriteById",value:function(t){return this.spriteDict[t]}},{key:"getHeight",value:function(t,e){if(!this.isInZone(t,e))return console.error("Requesting height for ["+t+", "+e+"] outside zone bounds"),0;for(var n=Math.floor(t),r=Math.floor(e),o=[t-n,e-r],i=function(t,e){var n=[t[1][0]-t[0][0],t[1][1]-t[0][1]],r=[t[2][0]-t[0][0],t[2][1]-t[0][1]],o=1/(n[0]*r[1]-n[1]*r[0]),i=[o*r[1],-o*r[0],-o*n[1],o*n[0]];return[n=(e[0]-t[0][0])*i[0]+(e[1]-t[0][1])*i[1],r=(e[0]-t[0][0])*i[2]+(e[1]-t[0][1])*i[3]]},s=this.cells[(r-this.bounds[1])*this.size[0]+n-this.bounds[0]],a=Math.floor(s.length/3),c=0;c<a;c++){var u=this.tileset.getTileWalkPoly(s[3*c]);if(u)for(var f=0;f<u.length;f++){var l=i(u[f],o),h=l[0]+l[1];if(h<=1)return s[3*c+2]+(1-h)*u[f][0][2]+l[0]*u[f][1][2]+l[1]*u[f][2][2]}}return s[2]}},{key:"drawRow",value:function(t){this.engine.bindBuffer(this.vertexPosBuf[t],this.engine.shaderProgram.vertexPositionAttribute),this.engine.bindBuffer(this.vertexTexBuf[t],this.engine.shaderProgram.textureCoordAttribute),this.tileset.texture.attach(),this.engine.shaderProgram.setMatrixUniforms(),this.engine.gl.drawArrays(this.engine.gl.TRIANGLES,0,this.vertexPosBuf[t].numItems)}},{key:"draw",value:function(){if(this.loaded){this.spriteList.sort((function(t,e){return t.pos.y-e.pos.y})),this.engine.mvPushMatrix(),this.engine.setCamera();for(var t=0,e=0;e<this.size[1];e++)for(this.drawRow(e);t<this.spriteList.length&&this.spriteList[t].pos.y-this.bounds[1]<=e;)this.spriteList[t++].draw(this.engine);for(;t<this.spriteList.length;)this.spriteList[t++].draw(this.engine);this.engine.mvPopMatrix()}}},{key:"tick",value:function(t){this.loaded&&(this.checkInput(t),this.spriteList.forEach(function(){var e=D(regeneratorRuntime.mark((function e(n){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",n.tickOuter(t));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()))}},{key:"checkInput",value:function(t){"o"===this.engine.keyboard.lastPressedKey("o")&&this.audio&&this.audio.playAudio()}},{key:"isInZone",value:function(t,e){return t>=this.bounds[0]&&e>=this.bounds[1]&&t<this.bounds[2]&&e<this.bounds[3]}},{key:"isWalkable",value:function(t,e,n){if(!this.isInZone(t,e))return null;for(var r in this.spriteDict){if(!this.spriteDict[r].walkable&&this.spriteDict[r].pos.x===t&&this.spriteDict[r].pos.y===e&&!this.spriteDict[r].blocking&&this.spriteDict[r].override)return!0;if(!this.spriteDict[r].walkable&&this.spriteDict[r].pos.x===t&&this.spriteDict[r].pos.y===e&&this.spriteDict[r].blocking)return!1}return 0!=(this.walkability[(e-this.bounds[1])*this.size[0]+t-this.bounds[0]]&n)}},{key:"moveSprite",value:(a=D(regeneratorRuntime.mark((function t(e,n){var r,o=this,i=arguments;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=i.length>2&&void 0!==i[2]&&i[2],t.abrupt("return",new Promise((function(t,i){var s=o.getSpriteById(e);s.addAction(new C.aW(o.engine,"patrol",[s.pos.toArray(),n,r?200:600,o],s,t))})));case 2:case"end":return t.stop()}}),t)}))),function(t,e){return a.apply(this,arguments)})},{key:"spriteDialogue",value:(s=D(regeneratorRuntime.mark((function t(e,n){var r,o=this,i=arguments;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=i.length>2&&void 0!==i[2]?i[2]:{autoclose:!0},t.abrupt("return",new Promise((function(t,i){var s=o.getSpriteById(e);s.addAction(new C.aW(o.engine,"dialogue",[n,!1,r],s,t))})));case 2:case"end":return t.stop()}}),t)}))),function(t,e){return s.apply(this,arguments)})},{key:"runActions",value:(i=D(regeneratorRuntime.mark((function t(e){var n;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=this,t.next=3,e.reduce(function(){var t=D(regeneratorRuntime.mark((function t(e,r){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.then(D(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",new Promise((function(t,e){console.log("working on action ---- ",r),r||t();try{if(r.scope||(r.scope=n),r.sprite){var o=r.scope.getSpriteById(r.sprite);if(o&&r.action){console.log("playing scene action in zone",n);var i=r.args,s=i.pop();o.addAction(new C.aW(n.engine,r.action,[].concat(function(t){if(Array.isArray(t))return Y(t)}(c=i)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(c)||function(t,e){if(t){if("string"==typeof t)return Y(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Y(t,e):void 0}}(c)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}(),[I({},s)]),o,(function(){return t(n)})))}}if(r.trigger){console.log("trigger",r);var a=r.scope.getSpriteById("avatar");console.log("triggered by ",a),a&&r.trigger&&a.addAction(new C.aW(n.engine,"script",[r.trigger,r.scope,function(){return t(n)}],a))}}catch(t){e(t)}var c})));case 1:case"end":return t.stop()}}),t)})))).catch((function(t){console.warn("err",t.message)}));case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}(),Promise.resolve());case 3:return t.abrupt("return",t.sent);case 4:case"end":return t.stop()}}),t,this)}))),function(t){return i.apply(this,arguments)})},{key:"triggerScript",value:function(t){var e=this;this.scripts.forEach((function(n){n.id===t&&e.runWhenLoaded(n.trigger.bind(e))}))}},{key:"playScene",value:(o=D(regeneratorRuntime.mark((function t(e){var n;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:(n=this).scenes.forEach(function(){var t=D(regeneratorRuntime.mark((function t(r){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(t.prev=0,r.currentStep||(r.currentStep=0),!(r.currentStep>n.scenes.length)){t.next=4;break}return t.abrupt("return");case 4:if(r.id!==e){t.next=8;break}return console.log("found scene ---\x3e ",r),t.next=8,n.runActions(r.actions);case 8:t.next=13;break;case 10:t.prev=10,t.t0=t.catch(0),console.error(t.t0);case 13:case"end":return t.stop()}}),t,null,[[0,10]])})));return function(e){return t.apply(this,arguments)}}());case 2:case"end":return t.stop()}}),t,this)}))),function(t){return o.apply(this,arguments)})}],r&&z(e.prototype,r),Object.defineProperty(e,"prototype",{writable:!1}),t}();function V(t){return function(t){if(Array.isArray(t))return K(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(t){if("string"==typeof t)return K(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?K(t,e):void 0}}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function K(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function H(t,e,n,r,o,i,s){try{var a=t[i](s),c=a.value}catch(t){return void n(t)}a.done?e(c):Promise.resolve(c).then(r,o)}function $(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var q=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.engine=e,this.zoneDict={},this.zoneList=[],this.afterTickActions=new u.Z,this.sortZones=this.sortZones.bind(this),this.canWalk=this.canWalk.bind(this),this.pathFind=this.pathFind.bind(this)}var e,n,r,o;return e=t,n=[{key:"runAfterTick",value:function(t){this.afterTickActions.add(t)}},{key:"sortZones",value:function(){this.zoneList.sort((function(t,e){return t.bounds[1]-e.bounds[1]}))}},{key:"loadZone",value:(r=regeneratorRuntime.mark((function t(e){var n,r,o=arguments;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n=o.length>1&&void 0!==o[1]&&o[1],!this.zoneDict[e]){t.next=3;break}return t.abrupt("return",this.zoneDict[e]);case 3:if(r=new U(e,this),!n){t.next=9;break}return t.next=7,r.loadRemote();case 7:t.next=11;break;case 9:return t.next=11,r.load();case 11:return this.zoneDict[e]=r,this.zoneList.push(r),r.runWhenLoaded(this.sortZones),t.abrupt("return",r);case 15:case"end":return t.stop()}}),t,this)})),o=function(){var t=this,e=arguments;return new Promise((function(n,o){var i=r.apply(t,e);function s(t){H(i,n,o,s,a,"next",t)}function a(t){H(i,n,o,s,a,"throw",t)}s(void 0)}))},function(t){return o.apply(this,arguments)})},{key:"removeZone",value:function(t){this.zoneList=this.zoneList.filter((function(e){if(e.id!==t)return!0;e.removeAllSprites()})),delete this.zoneDict[t]}},{key:"removeAllZones",value:function(){this.zoneList=[],this.zoneDict={}}},{key:"tick",value:function(t){for(var e in this.zoneDict){var n;null===(n=this.zoneDict[e])||void 0===n||n.tick(t)}this.afterTickActions.run(t)}},{key:"draw",value:function(){for(var t in this.zoneDict)this.zoneDict[t].draw(this.engine)}},{key:"zoneContaining",value:function(t,e){for(var n in this.zoneDict){var r=this.zoneDict[n];if(r.loaded&&r.isInZone(t,e))return r}return null}},{key:"pathFind",value:function(t,e){var n=[],r=!1,o=this,i=t[0],s=t[1];function a(t,i){var s=JSON.stringify([t[0],t[1]]);return!r&&(t[0]==e[0]&&t[1]==e[1]?(r=!0,o.canWalk(t,s,n)?[r,[].concat(V(i),[e])]:[r,V(i)]):!!o.canWalk(t,s,n)&&(n.push(s),o.getNeighbours.apply(o,V(t)).map((function(e){return a(e,[].concat(V(i),[[t[0],t[1],600]]))})).filter((function(t){return t})).flat()))}return o.getNeighbours(i,s).map((function(e){return a(e,[[t[0],t[1],600]])})).filter((function(t){return t[0]})).flat()}},{key:"getNeighbours",value:function(t,e){var n=[t,e+1,j.N.Up],r=[t,e-1,j.N.Down];return[n,[t-1,e,j.N.Left],[t+1,e,j.N.Right],r]}},{key:"canWalk",value:function(t,e,n){var r=this.zoneContaining.apply(this,V(t));return!(n.indexOf(e)>=0||!r||!r.isWalkable.apply(r,V(t))||!r.isWalkable(t[0],t[1],j.N.reverse(t[2])))}}],n&&$(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),t}();function G(t,e,n,r,o,i,s){try{var a=t[i](s),c=a.value}catch(t){return void n(t)}a.done?e(c):Promise.resolve(c).then(r,o)}function X(t){return function(){var e=this,n=arguments;return new Promise((function(r,o){var i=t.apply(e,n);function s(t){G(i,r,o,s,a,"next",t)}function a(t){G(i,r,o,s,a,"throw",t)}s(void 0)}))}}function J(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Q(t,e,n){return e&&J(t.prototype,e),n&&J(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function tt(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var et=Q((function t(){var e=this;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),tt(this,"init",function(){var e=X(regeneratorRuntime.mark((function e(n){var r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t._instance.engine=n,r=t._instance.world=new q(n),e.next=4,r.loadZone("room");case 4:r.zoneList.forEach((function(t){return t.runWhenLoaded((function(){return console.log("loading...done")}))}));case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),tt(this,"loadSceneManifest",function(){var t=X(regeneratorRuntime.mark((function t(e){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()),tt(this,"loadAvatar",function(){var t=X(regeneratorRuntime.mark((function t(e,n){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}()),tt(this,"exportAvatar",X(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:case"end":return t.stop()}}),t)})))),tt(this,"render",(function(n,r){t._instance.world.tick(r),e.draw(n)})),tt(this,"draw",(function(e){t._instance.world.draw(e)})),tt(this,"onKeyEvent",(function(e){"keydown"===e.type?t._instance.engine.keyboard.onKeyDown(e):t._instance.engine.keyboard.onKeyUp(e)})),tt(this,"onTouchEvent",(function(e){e.type,t._instance.engine.touch(e)})),this.shaders={fs:"\n  precision mediump float;\n  varying vec2 vTextureCoord;\n  uniform sampler2D uSampler;\n  \n  void main(void) {\n    gl_FragColor = texture2D(uSampler, vec2(vTextureCoord.s, vTextureCoord.t));\n    if(gl_FragColor.a < 0.1)\n        discard;\n  }\n",vs:"\n  attribute vec3 aVertexPosition;\n  attribute vec2 aTextureCoord;\n  \n  uniform mat4 uMVMatrix;\n  uniform mat4 uPMatrix;\n  \n  varying vec2 vTextureCoord;\n  \n  void main(void) {\n    gl_Position = uPMatrix * uMVMatrix * vec4(aVertexPosition, 1.0);\n    vTextureCoord = aTextureCoord;\n  }\n"},t._instance||(t._instance=this),t._instance})),nt=n(3379),rt=n.n(nt),ot=n(7795),it=n.n(ot),st=n(569),at=n.n(st),ct=n(3565),ut=n.n(ct),ft=n(9216),lt=n.n(ft),ht=n(4589),pt=n.n(ht),yt=n(4913),dt={};function bt(t){return bt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},bt(t)}function mt(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function vt(t,e){return vt=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},vt(t,e)}function gt(t,e){if(e&&("object"===bt(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function Ot(t){return Ot=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},Ot(t)}dt.styleTagTransform=pt(),dt.setAttributes=ut(),dt.insert=at().bind(null,"head"),dt.domAPI=it(),dt.insertStyleElement=lt(),rt()(yt.Z,dt),yt.Z&&yt.Z.locals&&yt.Z.locals;var wt=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");Object.defineProperty(t,"prototype",{value:Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),writable:!1}),e&&vt(t,e)}(a,t);var n,r,o,i,s=(o=a,i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,e=Ot(o);if(i){var n=Ot(this).constructor;t=Reflect.construct(e,arguments,n)}else t=e.apply(this,arguments);return gt(this,t)});function a(t){var e;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,a),(e=s.call(this,t)).state={scene:new et,updated:Date.now()},e}return n=a,(r=[{key:"componentWillReceiveProps",value:function(t){console.log(t),JSON.stringify(this.props.networkString)!=JSON.stringify(t.networkString)&&this.setState({networkString:t.networkString,updated:Date.now()})}},{key:"render",value:function(){var t=this.state,n=t.updated,r=t.scene;return e().createElement(e().Fragment,null,e().createElement(W,{class:"pixos",key:n,width:640,height:480,SceneProvider:r}))}}])&&mt(n.prototype,r),Object.defineProperty(n,"prototype",{writable:!1}),a}(t.Component);const Lt=(0,o.collect)(wt)})(),module.exports["calliope-pixos"]=r})();
//# sourceMappingURL=bundle.js.map